bringing up nodes...
bringing up nodes...

..................F...E..E.EEE..E.....EEE...EE.E...E.EEEE..E..EFEEE..... [  2%]
...E.EE...E.EE.EF..E...E.......E.E..E.EE.....EE.E..E...E...EE...EEE...E. [  5%]
E....EEEE....EEEE..E..F.E.EEEE.E.E..EEE.EEEEEEEE.EEEEEEFEEEEE.EEEEEEE.EE [  8%]
EEEEEFEEEEEEEEEEEEEEEEEEEEFEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEFEEEEE [ 10%]
EEEEEEEEEEEEEEEEEEFEEEEEEEEEEEEFEEEEEE.EEEEE.EEEEEEEEEE.EEEEEEEEEEEEEEEE [ 13%]
EEEFEE.EEEEEEE.EEEE.EEEEE.EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE. [ 16%]
EEEEE.EEE..EEEEEE.E.EEEEE.EEEEE.EE.EEEEEE.EEE.EEEEEEEEE.EEEEEEFEEEEEE.EE [ 18%]
EEEEEEEEEEEEEEEEEEEEEEEE.EEEEEEEEEEEEEEEE.EEEFEEEEEEE.EEEEEEEsssEsEEEEEE [ 21%]
EEEEEE.EEEEFsEEEE.EEEEEEEE.E.EEE..EEE.E...EEE...EEE.EEE...EE.EE....EE... [ 24%]
EEEE..E.EE.E..EE.EEE.E...E.EEE.EEEE...EEE.EEE...E.EE.E...E.EEEEEEEE...E. [ 26%]
EEEE.EFEE.E..EEEEEE..F.EF..EEE.EEF.EEE.EE...FEEEE.E.E.E...F.E.E..E.EEE.. [ 29%]
.EE..E.E.E.E...E..EEE.....E.E...E.EEE.E.E...FE.....E.EE...E...EE..E.E.EE [ 32%]
.FE.E......EEF.EEEEEF..E....E.EF..EE.E..E..FE.EE...E.E.F....EE.E.E.E...F [ 34%]
.E...E..EFE.E....EE.F.....E.EE..E.E.E...F.E.EE..E...EF...E.E.E....E..... [ 37%]
..E.EE.E...E.E..EE.......s..E.E......E..E....EE..E.......E.EE.E.......E. [ 40%]
...EEE...E.....E...........E.........F..E...........E.........E......E.. [ 42%]
..............E..........................E...F.................F......E. [ 45%]
................E.............E..........E................E.....F....... [ 48%]
...................................E................F........F.......... [ 50%]
........F..F...........E...F.............................FF....EF..s..F. [ 53%]
.....F..FF..F....F..F....EF..........F.......F.......E..FE.E...E........ [ 56%]
................E.F......E........FF..E...........E.F.......E.F......E.. [ 58%]
.E.........E.....E.....F......E................F........................ [ 61%]
..........E.................E..........................E........E...E... [ 64%]
....E..........E.........F........F.......F..............F..........F... [ 67%]
.....F.......F..........F......F.........F..........F.................F. [ 69%]
....................F................................................... [ 72%]
........................................................................ [ 75%]
........................................................................ [ 77%]
...................................................E...................E [ 80%]
..............F....E.......FF...F.......FFEF.....F.FF..F...F.F....F....F [ 83%]
.F......FF..F......F......................F.E..........F..E.E...FF...... [ 85%]
.E....F.....E.E.E.E.E...E.E..E...EE.E.E.EE....EEE.E...EFE.s.EE.EEE...EEE [ 88%]
EE..F.EEE.FEE.......EEE..EE....E.E...E...E....E.........E............... [ 91%]
........E...E...................E.....................E................. [ 93%]
..........E.E......................................F...s....F........... [ 96%]
.............F.....................F.F...........................F...... [ 99%]
.....................                                                    [100%]
==================================== ERRORS ====================================
_____ ERROR at setup of test_add_multiple_dependencies_to_dependency_group _____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaaa6f80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_set_malformed_repositories_setting ___________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872e8af80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_lock_always_updates_path_dependencies[True] ______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97e32f80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_remove_does_not_keep_empty_groups[True] ________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846e3af80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_skip_when_adding_existing_package_with_no_constraint[True] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b062e60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________________ ERROR at setup of test_check_valid ______________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e28524b2e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_add_to_group_uses_existing_legacy_group ________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab1288b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_lock_always_updates_path_dependencies[False] ______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a508b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_display_undefined_setting[repositories.foo-There is no foo repository defined] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_skip_when_adding_existing_package_with_no_constraint[False] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3c790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_remove_does_not_keep_empty_groups[False] ________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef48b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_check_valid_legacy[args0-0] ______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284ee9b40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_install_failure ____________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e223e70a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options0-valid_groups0-False] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7eaa2dd0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_does_not_exist[missing_directory_dependency-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a51510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_display_undefined_setting[foo-There is no foo setting.] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff95a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_source_show_pypi ____________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968702d40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_source_add_simple ___________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7232ff2d40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_group_directory_constraint_mix_pep735[required_fixtures0] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab1295a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_canonicalized_named_removes_dependency_correctly[True] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef5510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_skip_when_adding_canonicalized_existing_package_with_no_constraint[True] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3d510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_check_valid_legacy[args1-1] ______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eea8c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_command_new_with_readme[rst] ______________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e6a6e60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[PyTest-expected5-installer.only-binary] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c6daae60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with bam-groups6] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f2cedd0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_install_corrupt[False] _________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a8dc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_source_show_pypi_and_other _______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968780790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_source_add_simple_without_existing_sources _______
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233080700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options1-valid_groups1-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb8dc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_build_creates_packages_in_dist_directory_if_no_output_is_specified[sdist] _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba87c66e60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[pytest,black-expected6-installer.no-binary] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d4790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_add_supplemental ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233081360>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_show_no_sources _________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968781360>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_install_corrupt[True] _________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a9ab0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[pytest,black-expected6-installer.only-binary] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d5510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options2-valid_groups2-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb9ab0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_list_displays_set_get_local_setting __________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffa3b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without foo,bar-groups7] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05cdc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_build_creates_packages_in_dist_directory_if_no_output_is_specified[wheel] _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878b8790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_does_not_exist[missing_directory_dependency-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a52290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_command_new_with_readme[adoc] _____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e740790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_check_invalid_dep_name_same_as_project_name ______
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eeb6d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_skip_when_adding_canonicalized_existing_package_with_no_constraint[False] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3e290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_add_directory_with_poetry[required_fixtures0] _____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12a3b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_canonicalized_named_removes_dependency_correctly[False] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef6290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_list_must_not_display_sources_from_pyproject_toml ___
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872e89e10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_does_not_exist[missing_file_dependency-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97e31f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_command_new_with_readme[creole] ____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e741630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_check_invalid _____________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284c469e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without main-groups8] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05dab0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_should_fail_circular_dependency __________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b061ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_remove_package_does_not_exist _____________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846e39ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_add_file_constraint_wheel[required_fixtures0] _____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaaa5ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_set_http_basic _____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff9d80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_build_creates_packages_in_dist_directory_if_no_output_is_specified[all] _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878b9510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_does_not_exist[missing_file_dependency-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a51f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_check_private _____________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eea560>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_remove_package_no_dependencies _____________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef60e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_unset_http_basic ____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffad40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_add_latest_should_strip_out_invalid_pep508_path ____
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3dfc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_add_file_constraint_sdist[required_fixtures0] _____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12a170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_source_add_explicit __________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233082050>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_deleted_from_pyproject[deleted_directory_dependency-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a52ef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_source_show_no_sources_implicit_pypi __________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968782200>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_check_non_package_mode _________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eebe20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_install_success ____________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220aa7a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_add_latest_should_not_create_duplicate_keys[True] ___
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3ef80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_command_should_not_write_changes_upon_installer_errors _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef6ef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_run_script_sys_argv0[not installed] __________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x77c5c4fe1750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry_with_scripts(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("scripts")
    
>       return project_factory(
            name="scripts",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            source=source,
        )

/workspace/tests/console/commands/test_run.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'scripts', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "scripts"\nversion = "0.1.0"\ndescription = ""\nauthors = ["Your Name <you@example.com>"]\nread... "scripts.return_code:main"\n\n[build-system]\nrequires = ["poetry-core"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/scripts'), locker_config = None
use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_deleted_from_pyproject[deleted_directory_dependency-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a51510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_constraint_with_extras_option[msgpack] _______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12b010>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_set_http_basic_unsuccessful_multiple_values ______
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffbac0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_check_lock_missing[-All set!\n-0] ___________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284ee9480>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_add_latest_should_not_create_duplicate_keys[False] ___
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3d630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_install_reinstall ___________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e224e4550>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_add_error_no_url ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7232ff1e10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_deleted_from_pyproject[deleted_file_dependency-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a53be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_run_script_sys_argv0[installed] ____________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x77c5c4bc32e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry_with_scripts(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("scripts")
    
>       return project_factory(
            name="scripts",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            source=source,
        )

/workspace/tests/console/commands/test_run.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'scripts', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "scripts"\nversion = "0.1.0"\ndescription = ""\nauthors = ["Your Name <you@example.com>"]\nread... "scripts.return_code:main"\n\n[build-system]\nrequires = ["poetry-core"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/scripts'), locker_config = None
use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_constraint_with_extras_option[MsgPack] _______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab1295a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options3-valid_groups3-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7eaa29e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_dry_run_keep_files_intact[up_to_date_lock] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef5630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only time --format json-expected15] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef7181480>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[-expected7-installer.no-binary] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d6290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_check_lock_missing[--lock-Error: poetry.lock was not found.\n-1] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e60940>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_set_pypi_token _____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_source_show_error ___________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968701510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_work_when_adding_existing_package_with_latest_constraint[True] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3fbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_show_outdated_formatting[--format json] ________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60737d7e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_lock_path_dependency_deleted_from_pyproject[deleted_file_dependency-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b688b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_add_url_constraint_wheel ________________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12b0a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_dry_run_keep_files_intact[up_to_date_lock_non_package] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef7be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_install_passes_options_to_installer[cpython-False] ___
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220aa320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_source_add_error_pypi _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233081bd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_check_lock_outdated[] _________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e61630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_unset_pypi_token ____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbc430>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only time --with test-pendulum 2.0.0 Pendulum package\n] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6cce680>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True--groups0] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943a3b0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[-expected7-installer.only-binary] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c6da9f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_add_url_constraint_wheel_with_extras[foo] _______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab320940>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_work_when_adding_existing_package_with_latest_constraint[False] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14c8b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options4-valid_groups4-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7eaa1d80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_local_dependencies[-project_with_local_dependencies-required_fixtures0] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_local_dependencies'
project_factory = <function project_factory.<locals>._factory at 0x7bd607962a70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_local_dependencies')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo,bar --without baz --without bim --only bam-groups9] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f2ce9e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_lock_with_incompatible_lockfile[True] _________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b69750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_remove_performs_uninstall_op[up_to_date_lock] _____
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2c940>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_install_passes_options_to_installer[cpython-True] ___
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220ab370>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_check_lock_outdated[--lock] ______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e62320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_source_add_pypi[pypi] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233081630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_set_pypi_token_unsuccessful_multiple_values ______
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbd2d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_config_solver_lazy_wheel ________________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d5f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options5-valid_groups5-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb93f0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only-root-groups1] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943a680>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_chooses_prerelease_if_only_prereleases_are_available _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14d6c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_add_url_constraint_wheel_with_extras[FOO] _______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab3216c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---all-groups-groups10] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f2cdd80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_add_no_constraint ___________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968781a20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_respect_use_poetry_python_on_new[False-1.1] ______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e7423b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_performs_uninstall_op[up_to_date_lock_non_package] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2d6c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_passes_options_to_installer[pypy-False] ____
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a9bd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_source_add_pypi[PyPI] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72330837f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_build_with_local_version_label _____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878ba3b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_migrate[yes-system-git-client = true\n\n[virtualenvs]\nuse-poetry-python = true\n] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d6ef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options6-valid_groups6-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebba830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________________ ERROR at setup of test_cache_list _______________________
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b0355b130>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________________ ERROR at setup of test_search _________________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c4fe13f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo-groups11] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05d3f0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only main-groups2] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943a4d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options7-valid_groups7-True] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbb490>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_search_empty_results __________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495fbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_passes_options_to_installer[pypy-True] _____
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e227780d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_source_add_pypi_explicit ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72330839a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_cache_list_empty ____________________
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b0301c1f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_migrate[no-[experimental]\nsystem-git-client = true\n\n[virtualenvs]\nprefer-active-python = false\n] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d5510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_add_local_version ___________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968782b00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without bam-groups12] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_search_with_legacy_repository _____________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495eef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only foo-groups3] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960e0e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options8-valid_groups8-False] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f290160>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only time --with test --format json-expected17] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6ccf370>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_respect_use_poetry_python_on_new[True-3.10] ______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e6a5ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_source_add_existing_no_change_except_case_of_name[lower] _
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233320550>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_lock_with_incompatible_lockfile[False] _________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac985b3b50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_search_only_legacy_repository _____________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495ecb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_config_migrate_local_config ______________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d7be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_local_dependencies[--format json-project_with_local_dependencies-required_fixtures0] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_local_dependencies'
project_factory = <function project_factory.<locals>._factory at 0x7bd607963760>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_local_dependencies')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_lock_with_invalid_lockfile[True] ____________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97e317e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_lock_with_invalid_lockfile[False] ___________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a53be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\npytest   3.7.3 Pytest package\n1] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5d870>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --format json-expected19] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5f7f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_add_with_constraint __________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef33fd5a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_with_constraint0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_add_constraint_with_optional[None-expected_extras0-True] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaee8280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_command_new[options0-package-package-package-None] ___
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a537f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_source_add_existing_no_change_except_case_of_name[upper] _
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72333212d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_add_prefers_stable_releases ______________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4aed4040>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with bam --without bam-groups13] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05f490>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo --without foo-groups14] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e4160>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_add_non_package_mode_no_name ______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783760>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_add_with_lock _____________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b061c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_lock_does_not_perform_uninstall_op[up_to_date_lock] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782847698040>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_search_multiple_queries ________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c4bc3f40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_show_basic_with_installed_packages[] __________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5094280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_show_basic_with_installed_packages[--format json] ___
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5094f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only foo,bar-groups4] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960cee0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_git_dev_dependency[-project_with_git_dev_dependency] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_git_dev_dependency'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740f250>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_git_dev_dependency')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_git_dev_dependency[--format json-project_with_git_dev_dependency] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_git_dev_dependency'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740d510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_git_dev_dependency')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only bam-groups5] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6d480>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[None-expected_extras0-False] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaaa6b90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_basic_interactive_new _________________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e741ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_check_lock_up_to_date[] ________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e28524b010>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_migrate_local_config_should_raise_if_not_found _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c706c940>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_set_pypi_token_no_values ________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ce7d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_config_installer_build_config_settings _________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c706d750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_list_no_versions ____________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22778dc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_check_lock_up_to_date[--lock] _____________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eea7a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_set_client_cert ____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872e88d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options1-package-package-src/package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a50ee0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_show_basic_with_installed_packages_single[] ______
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5edd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_check_does_not_error_on_pypi_reference _________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284ee9900>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_show_config_with_local_config_file_empty ________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eeab90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_debug_resolve_gives_resolution_results _________
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b0355a170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________________ ERROR at setup of test_list_all ________________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22779870>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_set_client_cert_unsuccessful_multiple_values ______
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_lock_does_not_perform_uninstall_op[up_to_date_lock_non_package] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846e3a290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_build_with_clean[True] _________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba87c65fc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_list_displays_default_value_if_not_set _________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e613f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_add_keyboard_interrupt_restore_content _________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4ad3f520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options2-namespace-package-namespace-package-namespace/package-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a50b80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_no_dev_git_dev_dependency[-project_with_git_dev_dependency] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_git_dev_dependency'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740f6d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_git_dev_dependency')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_build_with_clean[False] ________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878b9d80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_add_with_git_constraint ________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef385f5b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_with_git_constraint0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_show_basic_with_installed_packages_single[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6ccf5b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras1-expected_extras1-True] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12add0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_add_replace_by_constraint _______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968780280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_list_displays_set_get_setting _____________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e60310>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_debug_resolve_tree_option_gives_the_dependency_tree __
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b02f9eef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options3-namespace-package-namespace-package-src/namespace/package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b69750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_run_passes_all_args __________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef7be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_set_cert[path/to/ca.pem-path/to/ca.pem] ________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffb9a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_installed_packages_single_canonicalized[] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6ccfbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_add_with_dry_run_keep_files_intact[cachy --dry-run] __
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b14d120>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras1-expected_extras1-False] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12ba30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options9-valid_groups9-False] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f9afeb0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_cannot_set_with_multiple_values ____________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e603a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_add_no_constraint_editable_error ____________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cc670>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_with_git_constraint_with_extras __________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef34884c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_with_git_constraint_w0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________ ERROR at setup of test_set_cert[true-True] __________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffa7a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_run_is_not_eager ____________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef7880>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_new_creates_structure_in_empty_existing_directory ___
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e742ef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_debug_resolve_git_dependency ______________
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b02f9fb50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_source_add_existing_updating[lower] __________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233737b50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[-cachy  0.1.0 Cachy package\npytest 3.7.3 Pytest package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5095bd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_installed_packages_single_canonicalized[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5c790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras2-expected_extras2-True] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab129c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_dry_run_populates_installer ______________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbbbe0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_no_dev_git_dev_dependency[--format json-project_with_git_dev_dependency] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'project_with_git_dev_dependency'
project_factory = <function project_factory.<locals>._factory at 0x7bd607962710>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/project_with_git_dev_dependency')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_add_equal_constraint __________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cd240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with bam-groups6] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6e200>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_sync_option_is_passed_to_the_installer[True] ______
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f0f3eb0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_build_with_clean_non_existing_output __________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878baef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_set_cert[false-False] _________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_run_passes_args_after_run_before_command ________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef56c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_source_add_existing_updating[upper] __________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7232983e20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras2-expected_extras2-False] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab128d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--format json-expected1] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495dbd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_not_installed_packages_non_decorated[] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5d5a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_dry_run_does_not_build _________________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbaf80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_build_config_settings_bad_values[BAD=VALUE] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c6bbbe20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_sync_option_is_passed_to_the_installer[False] _____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05fd00>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without foo,bar-groups7] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960d750>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[-vP run run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef57e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras3-expected_extras3-True] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab3217e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________________ ERROR at setup of test_unset_cert _______________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbdd80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_source_remove_simple[lower] ______________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233083490>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\npytest   3.7.3 Pytest package\n0] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495ea70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_install_logs_output __________________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb89d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options4-namespace-package_a-namespace-package-a-namespace/package_a-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b6a440>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_no_additional_output_in_verbose_mode[] _________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd14f2e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_no_additional_output_in_v0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_config_installer_build_config_settings_bad_values[BAD] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c6ca7d00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_compile_option_is_passed_to_the_installer[False] ____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05c700>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without main-groups8] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943aef0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_new_with_dot_in_empty_directory ____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e740c10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[run -vP run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2d3f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --format json-expected3] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c4fe03a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_with_dry_run_keep_files_intact[cachy --lock --dry-run] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b14e7a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options5-namespace-package_a-namespace-package-a-src/namespace/package_a-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97e31510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_cannot_set_invalid_value ________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e63400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_install_logs_output_decorated _____________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb8ca0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_source_remove_simple[upper] ______________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233081510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_show_hides_incompatible_package[] ___________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6079627a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_env_activate_prints_correct_script[bash-source-] ____
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b03103910>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________________ ERROR at setup of test_list_invalid_version __________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e224e4040>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_compile_option_is_passed_to_the_installer[True] ____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--without test-cachy 0.1.0 Cachy package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c4fe0700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options6-namespace-package-namespace-package-namespace_package-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a51a20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_cannot_unset_with_value ________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e2851e4160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_build_config_settings_bad_values[{"key": ["str", 0]}] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d7760>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_with_git_constraint_with_subdirectory[git+https://github.com/demo/poetry-plugin2.git#subdirectory=subdir-None] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3489510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_with_git_constraint_w1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo,bar --without baz --without bim --only bam-groups9] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9195a84c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_install_warning_corrupt_root[module-True] _______
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f290dc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_should_not_change_lock_file_when_dependency_installation_fail _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b062170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_build_not_possible_in_non_package_mode _________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878bbbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_source_remove_pypi[pypi] ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72330820e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_no_directory_is_passed_to_installer[True] _______
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05e440>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________________ ERROR at setup of test_list __________________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e223e6200>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_add_greater_constraint _________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899684afe20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options7-namespace-package-namespace-package-src/namespace_package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a527a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--without test --format json-expected5] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5095750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_unset_setting _____________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eead40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---all-groups-groups10] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9195a8700>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_add_with_path_dependency_no_loopiness _________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14c160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_command_config_build_config_settings_get ________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c69d7520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_publish_not_possible_in_non_package_mode ________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e743c70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_no_additional_output_in_verbose_mode[-v] ________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a3520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_no_additional_output_in_v1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
____ ERROR at setup of test_env_activate_prints_correct_script[zsh-source-] ____
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b031869e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______________ ERROR at setup of test_source_remove_pypi[PyPI] ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233080b80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_not_installed_packages_non_decorated[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5e200>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--without main-pytest 3.7.3 Pytest package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5095000>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options8-package-namespace-package-namespace/package-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a53760>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_no_directory_is_passed_to_installer[False] _______
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e4160>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_constraint_with_extras[msgpack] __________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899685cbf40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_with_git_constraint_with_subdirectory[git+https://github.com/demo/poetry-plugin2.git@master#subdirectory=subdir-master] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3206b00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_with_git_constraint_w2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________ ERROR at setup of test_unset_repo_setting ___________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284eeaa70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_show_hides_incompatible_package[--format json] _____
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6075b4820>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_constraint_with_optional[existing_extras3-expected_extras3-False] _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab322440>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_extras_are_parsed_and_included ___________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14f250>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_config_installer_parallel _______________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbdfc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_show_basic_with_not_installed_packages_decorated ____
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5eb00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo-groups11] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6dfc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options9-package-namespace-package-src/namespace/package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b69630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--without main --format json-expected7] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5094f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_unset_value_not_exists _________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e62b90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_constraint_with_extras[MsgPack] __________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783010>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_source_remove_pypi_and_other[pypi] ___________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233321120>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_extras_only_accepts_one_package[requests --extras security socks] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14d120>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_no_additional_output_in_verbose_mode[-vv] _______
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a3e20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_no_additional_output_in_v2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______ ERROR at setup of test_add_constraint_with_optional_not_main_group ______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaaa6dd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[-vPrun run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2e680>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options10-package-namespace-package-namespace/package-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b6b250>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_show_latest_non_decorated[] ______________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6ccf7f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[true-expected0-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ce7d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_add_existing_plugin_warns_about_no_operation ______
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3206dd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_existing_plugin_warns0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
___ ERROR at setup of test_display_single_setting[virtualenvs.create-true\n] ___
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e63a30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_env_activate_prints_correct_script[fish-source-.fish] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b031877f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______________ ERROR at setup of test_list_poetry_managed[False] _______________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220ab400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_add_constraint_dependencies ______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783880>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options11-package-namespace-package-src/namespace/package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b69f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_publish_returns_non_zero_code_for_upload_errors ____
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082eeb08b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_update_locked_dependencies[True-4.3.1-foo] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b14db40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[run -vPrun ] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef6560>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_display_single_setting[repositories.foo.url-{'url': 'https://bar.com/simple/'}\n] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e61cf0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_add_constraint_with_python _______________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab129ab0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_show_latest_non_decorated[--format json] ________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6cce320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_add_with_markers ____________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968782560>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_noninteractive _____________________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f99c706f880>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_list_poetry_managed[True] _______________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220abac0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[true-expected0-installer.only-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffa170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_add_existing_plugin_updates_if_requested ________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_add_existing_plugin_updat0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______ ERROR at setup of test_install_warning_corrupt_root[module-False] _______
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f291990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[-v --project=run run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef7400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_add_constraint_with_platform ______________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12bbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_show_latest_decorated _________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef7180af0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_no_additional_output_in_verbose_mode[-vvv] _______
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e9090>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_no_additional_output_in_v3/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_env_activate_prints_correct_script[nu-overlay use-.nu] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b036c84c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre3/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
___________________ ERROR at setup of test_list_version[3-3] ___________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a9750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_no_all_extras_doesnt_populate_installer ________
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e5ab0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[-v run --project=run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846e39510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_add_git_constraint ___________________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783640>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_publish_returns_non_zero_code_for_connection_errors __
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082eeb1630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_add_constraint_with_source _______________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12b5b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[1-expected1-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8310>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_install_warning_corrupt_root[readme-True] _______
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb9bd0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_show_outdated[] ____________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef7180280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only main-cachy 0.1.0 Cachy package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c4fe15a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_add_git_constraint_with_poetry _____________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cd360>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_adding_a_plugin_can_update_poetry_dependencies_if_needed _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef348a170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_adding_a_plugin_can_updat0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[-v --directory=run run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846e3a200>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_add_constraint_with_source_that_does_not_exist _____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab322830>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_all_extras_populates_installer _____________
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05d990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_show_outdated[--format json] ______________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5dc60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without bam-groups12] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6ed40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[1-expected1-installer.only-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffbeb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_list_version[3.9-2] __________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220ab9a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_install_warning_corrupt_root[readme-False] _______
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebba440>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only main --format json-expected9] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495df30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_passes_args_after_run_before_command_name_conflict[run -v --directory=run] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2e950>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_build_with_multiple_readme_files ____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878bbd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw14/test_build_with_multiple_readm0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________ ERROR at setup of test_add_constraint_not_found_with_source __________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab323370>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_source_remove_pypi_and_other[PyPI] ___________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233322440>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options12-namespace_package-namespace-package-namespace_package-None] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97b6bd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_show_all_shows_incompatible_package[] _________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6075b5630>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_extras_are_parsed_and_populate_installer ________
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05cca0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_install_warning_corrupt_root[-True] __________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbaef0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_run_keeps_options_passed_before_command_args_combined_short_opts _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2f6d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[false-expected2-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbe3b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with bam --without bam-groups13] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9195a8310>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_list_version[3.9.2-0] _________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22779000>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_command_new[options13-namespace_package-namespace-package-src/namespace_package-src] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97e32a70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_source_remove_error[foo] ________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7232ff0d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_update_locked_dependencies[True-4.3.1-foo --lock] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b174b80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_env_info_displays_complete_info ____________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e9240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_to_section_that_does_not_exist_yet[dev] ______
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab321c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --without test-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495de10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_display_single_local_setting ______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284e60ee0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_ensures_project_plugins[--no-plugins-0] ____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05ee60>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_install_warning_corrupt_root[-False] __________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbbb50>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[false-expected2-installer.only-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbeef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --without test --format json-expected11] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c495d870>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_self_install[None] ___________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_self_install_None_0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____ ERROR at setup of test_run_keeps_options_passed_before_command_args ______
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2c700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_display_empty_repositories_setting ___________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284c46b90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo --without foo-groups14] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960ca60>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_command_new_with_readme[None] _____________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a51090>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_update_locked_dependencies[False-4.3.2-foo] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b14df30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_env_info_displays_path_only ______________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a3520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_env_activate_prints_correct_script[csh-source-.csh] __
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b03187010>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre4/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_directory_dependency-] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f291fc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_source_remove_error[pypi] _______________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233080f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --without main,test-pendulum 2.0.0 Pendulum package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5097250>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[0-expected3-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbc700>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_build_output_option[None] _______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba87e36950>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_command_new_with_readme[md] ______________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7cac97a520e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_unset_nonempty_repositories_section[repositories-You cannot remove the [repositories] section] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284ee9360>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_install_ensures_project_plugins[-1] __________
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05cb80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_show_all_shows_incompatible_package[--format json] ___
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740fd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_source_remove_error[PyPI] _______________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72330800d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False--groups0] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960d750>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--with time --without main,test --format json-expected13] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5094550>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_git_constraint_with_extras[foo] __________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683ce320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_env_info_displays_executable_only ___________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd054f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_update_locked_dependencies[False-4.3.2-foo --lock] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bed4b14ec20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry_with_up_to_date_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("up_to_date_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_add.py:56: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '# This file is automatically @generated by Poetry 1.5.0.dev0 and should not be changed by hand.\n\n[[package]]\nname ...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "8f975cfcda1d3c938f9e7013b2e24cb2e43e6a2a573f0c6867acad407b0fb0d9"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_unset_nonempty_repositories_section[repositories.test-There is no test repository defined] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x74e284ee9cf0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options1-valid_groups1-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b68dc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_publish_with_cert ___________________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082f5dc0d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_basic_with_group_options[--only time-pendulum 2.0.0 Pendulum package\n] _
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x77c5c5097010>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_none_activated _____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd056d40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_show_outdated_with_only_up_to_date_packages[] _____
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5ee60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_add_git_constraint_with_extras[FOO] __________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899684afeb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_self_install[[tool.poetry]\nname = "poetry-instance"\nversion = "1.2"\ndescription = ""\nauthors = []\nlicense = ""\n# no package-mode -> defaults to true\n\n[tool.poetry.dependencies]\npython = "3.9"\npoetry = "1.2"\n] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef348bac0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_self_install__tool_poetry0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________ ERROR at setup of test_source_show_simple ___________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c72330828c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only-root-groups1] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960c310>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_extras_conflicts_all_extras ______________
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e60e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_creates_dependencies_array_if_necessary ______
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14d240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with bam --without bam-groups13] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e61d80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_publish_with_client_cert ________________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e6a57e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_add_to_section_that_does_not_exist_yet[foo.BAR] ____
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab323d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options2-valid_groups2-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b69240>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_with_only_up_to_date_packages[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5ec20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________________ ERROR at setup of test_activated _______________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd056710>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_git_constraint_with_subdirectory[git+https://github.com/demo/subdirectories.git#subdirectory=two-None] _
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968781c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_add_poetry_dependencies_if_not_necessary[True] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14eb00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only main-groups2] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6f490>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_show_one[lower] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233321fc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_env_activate_prints_correct_script[tcsh-source-.csh] __
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x777b03185c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x777b02f9e8c0>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw3/test_env_activate_prints_corre5/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo --without foo-groups14] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e63130>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_publish_dry_run_skip_existing[--dry-run] ________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e743640>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options3-valid_groups3-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b6a440>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_creating_poetry_section_does_not_remove_existing_tools _
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897aaaa68c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_run_keeps_options_passed_before_command ________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7828471303a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_in_project_venv ____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e95a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_show_outdated_has_prerelease_but_not_allowed[] _____
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6b5e290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_git_constraint_with_subdirectory[git+https://github.com/demo/subdirectories.git@master#subdirectory=two-master] _
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968780670>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_directory_dependency---without dev] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f2924d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_show_hides_incompatible_package_with_duplicate[] ____
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd607963d00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only bam-groups5] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b035a1ab0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_compile_option_is_passed_to_the_installer[False] ____
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552c700>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_show_one[upper] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233322ef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_publish_dry_run_skip_existing[--skip-existing] _____
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e7439a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_add_to_dev_group ____________________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12b5b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_has_prerelease_but_not_allowed[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6cce950>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_run_has_helpful_error_when_command_not_found ______
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846b2d870>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_in_project_venv_no_explicit_config ___________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6ea320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[0-expected3-installer.only-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872bbfd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_file_dependency-] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb83a0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_add_git_ssh_constraint[False] _____________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with bam-groups6] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9f760>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_add_should_not_select_prereleases ___________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab12a170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_show_two[lower] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233323ac0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_publish_dry_run_skip_existing[--dry-run --skip-existing] _
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e741b40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_show_outdated_has_prerelease_and_allowed[] _______
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6ccfd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_list_version[3.9.3-1] _________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22778040>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_in_project_venv_is_false ________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e8670>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_run_script_exit_code __________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x782846b2fbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry_with_scripts(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("scripts")
    
>       return project_factory(
            name="scripts",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            source=source,
        )

/workspace/tests/console/commands/test_run.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'scripts', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "scripts"\nversion = "0.1.0"\ndescription = ""\nauthors = ["Your Name <you@example.com>"]\nread... "scripts.return_code:main"\n\n[build-system]\nrequires = ["poetry-core"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/scripts'), locker_config = None
use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_hides_incompatible_package_with_duplicate[--format json] _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd607961fc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_add_git_ssh_constraint[True] ______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cd120>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_file_dependency---without dev] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbbd90>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without foo,bar-groups7] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9e4d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[pytest-expected4-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8430>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_skip_existing_output __________________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e740280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_has_prerelease_and_allowed[--format json] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5e5f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_list_implementation[PyPy-1] ______________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220ab640>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_extra_path_dependency_does_not_exist[] _____
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebba320>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_add_does_not_add_poetry_dependencies_if_not_necessary[False] _
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b0625f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without main-groups8] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9ee60>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_show_outdated_formatting[] _______________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782ef6e5d6c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_list_implementation[pypy-1] ______________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a8a60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_sync_deprecation[True] _________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef36680d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_sync_deprecation_True_0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______________ ERROR at setup of test_build_output_option[dist] _______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba87e360e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[pytest-expected4-installer.only-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ff8160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_add_directory_constraint[False-required_fixtures0] ___
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cf130>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_extra_path_dependency_does_not_exist[--extras notinstallable] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f2904c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only foo-groups3] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6dcf0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_poetry_dependencies_if_necessary[True] _______
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14eb00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options4-valid_groups4-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97f80550>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_compile_option_is_passed_to_the_installer[True] ____
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552d480>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_show_all_shows_all_duplicates[] ____________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60737c5e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_config_installer_binary_filter_config[PyTest-expected5-installer.no-binary] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7ed872ffbe20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_missing_directory_dependency_with_no_directory[] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f291a20>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_add_directory_constraint[True-required_fixtures0] ___
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cda20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_poetry_dependencies_if_necessary[False] ______
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14fd90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options5-valid_groups5-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a51cf0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only foo,bar-groups4] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943aa70>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_remove_by_python_version ________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6eb400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_list_implementation[CPython-2] _____________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e223e6320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_no_directory_is_passed_to_installer[True] _______
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284ee95a0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_show_all_shows_all_duplicates[--format json] ______
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60737caf0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_file_dependency---without dev] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbd990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_sync_deprecation[False] ________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3206290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_sync_deprecation_False_0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--with foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e4c10>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_build_output_option[test/dir] _____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba87c66dd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_remove_by_name _____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd056d40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_source_show_two[upper] _________________
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233320f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_build_format_is_not_valid _______________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14f9a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options6-valid_groups6-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a539a0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________________ ERROR at setup of test_show_tree _______________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6075b55a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only bam-groups5] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91943bd00>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_publish_dist_dir_option[None] _____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e8f3eb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_option_N0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______ ERROR at setup of test_no_directory_is_passed_to_installer[False] _______
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284ee9360>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_remove_invalid_version _________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e223e65f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_extra_path_dependency_does_not_exist[] _____
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbeef0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo,bar --without baz --without bim --only bam-groups9] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036c8940>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_remove_all[None] ____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a39a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_version_show_with_underscore ______________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b1744c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options7-valid_groups7-True] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a53a30>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_show_tree_no_dev ____________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6075b6320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_source_show_given_priority[source_primary] _______
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7232ff29e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_extra_path_dependency_does_not_exist[--extras notinstallable] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbc040>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_no_all_extras_doesnt_populate_installer ________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e60a60>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---all-groups-groups10] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9e290>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_show_entire_description_truncate[False] ________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91943aef0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_build_output_option[../dist] ______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878b9480>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_short_version_show ___________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b175240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_remove_version_not_precise_enough ___________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e2277a5f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options8-valid_groups8-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b6a440>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_remove_all[empty] ___________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a37f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--without foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05e3b0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_remove_installed_package ________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3206c20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_remove_installed_package0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
____________ ERROR at setup of test_all_extras_populates_installer _____________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e624d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_version_update _____________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b175e10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_missing_directory_dependency_with_no_directory[--no-directory] _
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f292ef0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo-groups11] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9f1c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_source_show_given_priority[source_supplemental] ____
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233080550>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options9-valid_groups9-False] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b6a4d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_remove_version_no_installation _____________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e2277b2e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_extras_are_parsed_and_populate_installer ________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e60700>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_remove_all[self] ____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e9750>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_add_to_new_group_keeps_existing_group _________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7899683cfe20>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--with foo,bar --without baz] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f2ce9e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---without bam-groups12] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b03185e10>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_non_package_mode_does_not_try_to_install_root _____
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7ebb9bd0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_source_show_given_priority[source_explicit] ______
[gw7] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7c7233080ee0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7c7232ff1870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_show_entire_description_truncate[True] _________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6e4d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_add_to_existing_group[False] ______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968702b90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_show_errors_without_lock_file _____________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6edd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_build_output_option[absolute] _____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x76ba878b8dc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_remove_all[other] ___________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6ebbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with bam --without bam-groups13] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b031863b0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_remove_version _____________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22779360>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_remove_installed_package_dry_run ____________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488310>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_remove_installed_package_0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--only foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f2ce4d0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_lock_does_not_update_if_not_necessary _________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x75ab7ebbb520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x75ab7ebb8670>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_add_to_existing_group[True] ______________
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968780790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_show_tree_why_package _________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6079620e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_remove_all[self_and_other] _______________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6ea320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_missing_directory_dependency_with_no_directory[] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed873210550>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_show_dependency_installed_from_git_in_dev[] ______
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb43a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---with foo --without foo-groups14] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b031868c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_add_to_group_with_latest_overwrite_existing ______
[gw11] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x789968783370>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x789968701870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--all-groups] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e4040>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_show_tree_why _____________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60737cdc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_missing_directory_dependency_with_no_directory[--no-directory] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ffa290>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_remove_all_and_version _________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e8f70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_short_version_update __________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b175510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________________ ERROR at setup of test_show_why[] _______________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60737c5e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--with foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e5900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_dry_run_populates_installer ______________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97f80040>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_version_show ______________________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7897ab2704c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_non_package_mode_does_not_try_to_install_root _____
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ff91b0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_install_ensures_project_plugins[--no-plugins-0] ____
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552d900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_phase_version_update __________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14d000>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_show_why[--format json] ________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740f400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_dry_run_does_not_build _________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a531c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_sync_option_not_available _______________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ffa680>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________________ ERROR at setup of test_dry_run ________________________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bed4b14db40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_install_ensures_project_plugins[-1] __________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28524b2e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_show_required_by_deps[] ________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd60740fac0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_install_logs_output __________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97e329e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_publish_dist_dir_option[dist] _____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082f5dc0d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_option_d0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________ ERROR at setup of test_show_required_by_deps[--format json] __________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7bd6075b68c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_synced_installer ____________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbec20>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False--groups0] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036c9630>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens0-result0] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7828470297e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_install_logs_output_decorated _____________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97e32a70>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_extras_conflicts_all_extras ______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284c46dd0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_update_with_dry_run_keep_files_intact[--dry-run] ____
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbfeb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only-root-groups1] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b0301c790>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens1-result1] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782847008e50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_install_warning_corrupt_root[module-True] _______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b68790>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_remove_version_implementation[cpython] _________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e2277beb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--with foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284eea710>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_publish_dist_dir_option[other_dist/dist] ________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e7408b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_option_o0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--without foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e6ef0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only main-groups2] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9d870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_install_warning_corrupt_root[module-False] _______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b684c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_remove_multiple ____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a3a30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens2-result2] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7828470080d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--without foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284eebe20>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--with foo,bar --without baz] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05cd30>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only foo-groups3] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9dfc0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens3-result3] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7828470ebf40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_publish_dist_dir_option[absolute] ___________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e743f40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_option_a0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________ ERROR at setup of test_remove_version_implementation[pypy] __________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a97e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--with foo,bar --without baz] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552db40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_remove_in_project ___________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e9bd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_dependency_installed_from_git_in_dev[--format json] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb5090>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only foo,bar-groups4] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b02f9f1c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--only foo] _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05e710>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens4-result4] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7828470ea4d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_remove_in_project_all _________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6ea320>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_update_with_dry_run_keep_files_intact[docker --dry-run] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed873210820>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_publish_dist_dir_and_build_options[../dist] ______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e6a6710>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_and_buil0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---only bam-groups5] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036c9510>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_remove_multiple_versions ________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e220a8a60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens5-result5] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef4a60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_activate_activates_non_existing_virtualenv_no_envs_file _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6ebd00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_update_prints_operations[-True] ____________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ffb520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_application_input_configuration_and_sorting[tokens6-result6] _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x782846ef4940>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_get_prefers_explicitly_activated_virtualenvs_over_env_var _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6eb370>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_install_warning_corrupt_root[readme-True] _______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97f80e50>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_update_prints_operations[--dry-run-True] ________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ffba30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_url_dependency_is_not_outdated_by_repository_package[] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6edd0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_publish_dist_dir_and_build_options[tmp/dist] ______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e6a5c60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_and_buil1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________ ERROR at setup of test_update_prints_operations[--lock-False] _________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbcf70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_get_prefers_explicitly_activated_non_existing_virtualenvs_over_env_var _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e8550>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--only foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552e9e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_install_warning_corrupt_root[readme-False] _______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a52320>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________________ ERROR at setup of test_show_format[] _____________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_format__0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____ ERROR at setup of test_update_sync_option_is_passed_to_the_installer _____
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872bbc280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry_with_outdated_lockfile(
        project_factory: ProjectFactory, fixture_dir: FixtureDirGetter
    ) -> Poetry:
        source = fixture_dir("outdated_lock")
    
>       return project_factory(
            name="foobar",
            pyproject_content=(source / "pyproject.toml").read_text(encoding="utf-8"),
            poetry_lock_content=(source / "poetry.lock").read_text(encoding="utf-8"),
        )

/workspace/tests/console/commands/test_update.py:27: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'foobar', dependencies = {}, dev_dependencies = {}
pyproject_content = '[project]\nname = "foobar"\nversion = "0.1.0"\nrequires-python = ">=3.8,<4.0"\ndependencies = [\n    "docker>=4.3.1",\n]\n\n[build-system]\nrequires = ["poetry-core>=1.0.0"]\nbuild-backend = "poetry.core.masonry.api"\n'
poetry_lock_content = '[[package]]\nname = "certifi"\nversion = "2020.6.20"\ndescription = "Python package for providing Mozilla\'s CA Bundl...= "2.0"\npython-versions = "^3.8"\ncontent-hash = "2f47de5e052dabeff3c1362d3a37b5cfcaf9bbe9d9ce1681207e72ca1f4dab55"\n'
install_deps = True, source = None, locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_only_root_conflicts_with_without_only_all_groups[--all-groups] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284c45510>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_install_invalid_version ________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6e84c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_url_dependency_is_not_outdated_by_repository_package[--format json] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6dfc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_publish_dist_dir_and_build_options[absolute] ______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082eeb0d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw21/test_publish_dist_dir_and_buil2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with bam-groups6] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036c8430>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_install_warning_corrupt_root[-True] __________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97a52f80>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_add_no_constraint ___________________
[gw6] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f6e22883400>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f6e223e5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw6/test_add_no_constraint0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--with foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e61c60>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________________ ERROR at setup of test_show_top_level[] ____________________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91960c280>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_remove_from_project_and_poetry _____________
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082eeb1d80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without foo,bar-groups7] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b031dbc70>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_install_warning_corrupt_root[-False] __________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b6b250>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_show_top_level[--format json] _____________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91960c430>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--without foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e63910>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without main-groups8] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b0301c790>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_show_top_level_with_explicitly_defined_dependency[] __
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91960dd80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--with foo,bar --without baz] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e284e601f0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_directory_dependency-] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97b68820>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo,bar --without baz --without bim --only bam-groups9] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b03187130>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_top_level_with_explicitly_defined_dependency[--format json] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb4d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_all_groups_conflicts_with_only_with_without[--only foo] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552d480>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---all-groups-groups10] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b03185f30>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_directory_dependency---without dev] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97f80280>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_install_free_threaded_not_supported __________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd62cdc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---with foo-groups11] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036caa70>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_remove_from_pep735_group_and_poetry_group _______
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e900d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_without_specific_group_removes_from_all_groups[True] _
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e826b90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_show_format[--format json] _______________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef39f44c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_format___format_json0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
____________________ ERROR at setup of test_install_exists _____________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a2b00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_without_specific_group_removes_from_all_groups[False] _
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082eeb0d30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_show_top_level_with_extras[] ______________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb5e10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________________ ERROR at setup of test_install_no_download __________________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7accbd6a31c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_invalid_groups_with_without_only[options0-valid_groups0-False] _
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x74e28552f130>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_specific_group_removes_from_specific_groups[True] _
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e743d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_show_top_level_with_extras[--format json] _______
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91960cee0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_with_specific_group_removes_from_specific_groups[False] _
[gw21] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x78082e743f40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x78082e6a5870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_show_format[--format text] _______________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3205ea0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_format___format_text0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[False---without bam-groups12] _
[gw3] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x777b036cb1c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_install_path_dependency_does_not_exist[missing_file_dependency-] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac97f81900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________ ERROR at setup of test_show_error_top_level_with_tree _____________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d91960d510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_show_error_top_level_with_single_package ________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6d5a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_outdated_missing_directory_dependency[deleted_directory_dependency-required_fixtures0] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'deleted_directory_dependency'
project_factory = <function project_factory.<locals>._factory at 0x70d919c6d990>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/deleted_directory_dependency')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_show_error_invalid_output_format ____________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb56c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_displays_installed_plugins[entry_point_values_by_group0-poetry-plugin] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3206950>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_displays_installed_p0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
___ ERROR at setup of test_show_error_invalid_output_format_with_tree_option ___
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x70d919cb43a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True--groups0] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919cb7250>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_displays_installed_plugins[entry_point_values_by_group0-not-package-name] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_displays_installed_p1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only-root-groups1] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d91960e8c0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only main-groups2] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9195ab2e0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_displays_installed_plugins_with_multiple_plugins[entry_point_values_by_group0] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef348b5b0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_displays_installed_p2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only foo-groups3] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6f9a0>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_group_options_are_passed_to_the_installer[True---only foo,bar-groups4] _
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d919c6ed40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory) -> Poetry:
>       return project_factory(name="export", pyproject_content=PYPROJECT_CONTENT)

/workspace/tests/console/commands/test_install.py:73: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'export', dependencies = {}, dev_dependencies = {}
pyproject_content = '[tool.poetry]\nname = "simple-project"\nversion = "1.2.3"\ndescription = "Some description."\nauthors = [\n    "Pytho...l.poetry.group.bam.dependencies]\nbam = "^1.4"\n\n[tool.poetry.extras]\nextras_a = [ "fizz" ]\nextras_b = [ "buzz" ]\n'
poetry_lock_content = None, install_deps = True, source = None
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_show_displays_installed_plugins_with_dependencies[entry_point_values_by_group0-plugin_package_requires_dist0] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3943be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_show_displays_installed_p3/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________ ERROR at setup of test_self_install[None] ___________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef33fd5a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_self_install_None_1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_self_install[[tool.poetry]\nname = "poetry-instance"\nversion = "1.2"\ndescription = ""\nauthors = []\nlicense = ""\n# no package-mode -> defaults to true\n\n[tool.poetry.dependencies]\npython = "3.9"\npoetry = "1.2"\n] _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef39f4dc0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_self_install__tool_poetry1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______________ ERROR at setup of test_sync_option_not_available _______________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef3489b40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_sync_option_not_available0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_uploader_skips_existing[400-file name has already been taken] _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872fa79a0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
___ ERROR at setup of test_uploader_skip_existing_bubbles_unskippable_errors ___
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872a9bb20>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
___________________ ERROR at setup of test_synced_installer ____________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef348b520>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_synced_installer0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______ ERROR at setup of test_uploader_properly_handles_file_not_existing ______
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872b59e40>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_self_update_can_update_from_recommended_installation __
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_directory = 'simple_project'
project_factory = <function project_factory.<locals>._factory at 0x7f5ef348b0a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(
        project_directory: str,
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
    ) -> Poetry:
>       return project_factory(name="simple", source=fixture_dir(project_directory))

/workspace/tests/console/conftest.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw5/test_self_update_can_update_fr0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_ ERROR at setup of test_uploader_properly_handles_redirects[307-Temporary Redirect] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c706b580>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_properly_handles_redirects[304-Not Modified] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6e83910>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
__ ERROR at setup of test_uploader_properly_handles_redirects[303-See Other] ___
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c712e680>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
____ ERROR at setup of test_uploader_properly_handles_redirects[302-Found] _____
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6d077c0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_________ ERROR at setup of test_uploader_properly_handles_400_errors __________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97b73d00>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_properly_handles_redirects[301-Moved Permanently] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c452c460>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_________ ERROR at setup of test_uploader_properly_handles_403_errors __________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97b36710>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_____ ERROR at setup of test_uploader_properly_handles_nonstandard_errors ______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97b35a80>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_properly_handles_redirects[308-Permanent Redirect] _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97ec6ce0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_properly_handles_redirects[300-Multiple Choices] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c7090e20>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
________ ERROR at setup of test_uploader_properly_handles_301_redirects ________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c712caf0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_____ ERROR at setup of test_uploader_registers_for_appropriate_400_errors _____
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c451bc70>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_____________ ERROR at setup of test_uploader_skips_existing[409-] _____________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c69abb50>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
___ ERROR at setup of test_uploader_skips_existing[400-File already exists] ____
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6eae290>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_skips_existing[400-Repository does not allow updating assets] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c442c1c0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ ERROR at setup of test_uploader_skips_existing[403-Not enough permissions to overwrite artifact] _
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def uploader(fixture_dir: FixtureDirGetter) -> Uploader:
>       return Uploader(Factory().create_poetry(fixture_dir("simple_project")), NullIO())

/workspace/tests/publishing/test_uploader.py:24: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/uploader.py:34: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6ed74c0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
______________ ERROR at setup of test_system_site_packages[False] ______________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96e0d990>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
installed_results = [<importlib.metadata.PathDistribution object at 0x7cac97baa2f0>, <importlib.metadata.PathDistribution object at 0x7cac...tadata.PathDistribution object at 0x7cac96e8dae0>, <importlib.metadata.PathDistribution object at 0x7cac96e8db40>, ...]

    @pytest.fixture
    def poetry(
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
        installed_results: list[metadata.PathDistribution],
    ) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/repositories/test_installed_repository.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_system_site_packages[True] _______________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96e0c790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
installed_results = [<importlib.metadata.PathDistribution object at 0x7cac97baa2f0>, <importlib.metadata.PathDistribution object at 0x7cac...tadata.PathDistribution object at 0x7cac96e8dae0>, <importlib.metadata.PathDistribution object at 0x7cac96e8db40>, ...]

    @pytest.fixture
    def poetry(
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
        installed_results: list[metadata.PathDistribution],
    ) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/repositories/test_installed_repository.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_system_site_packages_source_type ____________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96e0ee60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
installed_results = [<importlib.metadata.PathDistribution object at 0x7cac97baa2f0>, <importlib.metadata.PathDistribution object at 0x7cac...tadata.PathDistribution object at 0x7cac96e8dae0>, <importlib.metadata.PathDistribution object at 0x7cac96e8db40>, ...]

    @pytest.fixture
    def poetry(
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
        installed_results: list[metadata.PathDistribution],
    ) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/repositories/test_installed_repository.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_pipx_shared_lib_site_packages _____________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96e0cb80>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
installed_results = [<importlib.metadata.PathDistribution object at 0x7cac97baa2f0>, <importlib.metadata.PathDistribution object at 0x7cac...tadata.PathDistribution object at 0x7cac96e8dae0>, <importlib.metadata.PathDistribution object at 0x7cac96e8db40>, ...]

    @pytest.fixture
    def poetry(
        project_factory: ProjectFactory,
        fixture_dir: FixtureDirGetter,
        installed_results: list[metadata.PathDistribution],
    ) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/repositories/test_installed_repository.py:159: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_env_system_packages_are_relative_to_lib[True] _____
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef2fdfeb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_env_system_packages_are_relative_to_lib[False] _____
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef2fddc60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_env_no_pip[flags2-packages2] ______________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f99c7019240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_env_no_pip[flags0-packages0] ______________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef2fdcd30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_env_system_packages[True] _______________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6da8c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_env_no_pip[flags1-packages1] ______________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef2fded40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_marker_env_is_equal_for_all_envs ____________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bd60740e290>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_build_environment_not_called_without_build_script_specified _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed872ffbd90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_activate_activates_different_virtualenv_with_envs_file _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22cb703a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ca22f2cdb40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_env_system_packages[False] _______________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6da5f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_command_from_bin_preserves_relative_path ________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed87174a170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________ ERROR at setup of test_deactivate_non_activated_but_existing _________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f167be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x75ab7ebb8670>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______________ ERROR at setup of test_generic_env_system_packages ______________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6d9900>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_activate_in_project_venv_no_explicit_config ______
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9197c6170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_activate_activates_recreates_for_different_patch ____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f05eb00>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ca22f2cdb40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____________________ ERROR at setup of test_remove_by_name _____________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bd6071744c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_tries_to_find_a_compatible_python_executable_using_generic_ones_first _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6abbe0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_get_venv_with_venv_folder_present[None] ________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7828450c2680>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_raises_if_acting_on_different_project_by_name __
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9181445e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_remove_by_string_with_python_and_version ________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bd607174ca0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_activate_does_not_recreate_when_switching_minor ____
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e5480>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ca22f2cdb40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ ERROR at setup of test_env_finds_the_correct_executables ___________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f99c701b1c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_create_venv_finds_no_python_executable _________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6a81f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_build_venv_does_not_change_loglevel __________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96f33d90>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ ERROR at setup of test_remove_by_full_path_to_python _____________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bd6071767a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_activate_with_in_project_setting_does_not_fail_if_no_venvs_dir _
[gw19] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ca22f3e4160>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ca22f2cdb40>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_get_prefers_explicitly_activated_virtualenvs_over_env_var _
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7828450c2cb0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____ ERROR at setup of test_raises_when_passing_old_env_after_dir_rename ______
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d918145510>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_env_finds_the_correct_executables_for_generic_env ___
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f99c45432e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_activate_activates_non_existing_virtualenv_no_envs_file _
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef30cd120>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_remove_raises_if_acting_on_different_project_by_full_path _
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7bd607174a60>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_tries_to_find_a_compatible_python_executable_using_specific_ones _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc4b5f30>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
____ ERROR at setup of test_env_finds_fallback_executables_for_generic_env _____
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f99c4540e50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_generate_env_name_ignores_case_for_case_insensitive_fs _
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7cac96bea9e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________________ ERROR at setup of test_remove_also_deactivates ________________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9197c7be0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________ ERROR at setup of test_deactivate_activated __________________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab66e4cf70>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x75ab7ebb8670>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_________________________ ERROR at setup of test_list __________________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7828450c32e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
______ ERROR at setup of test_activate_fails_when_python_cannot_be_found _______
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef385fb50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_does_not_try_to_find_compatible_versions_with_executable _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed8727e15a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
________ ERROR at setup of test_get_venv_with_venv_folder_present[True] ________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7eabb640>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x75ab7ebb8670>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_uses_patch_version_to_detect_compatibility _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed87174b0a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__ ERROR at setup of test_activate_activates_existing_virtualenv_no_envs_file __
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef385ff40>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_accepts_fallback_version_w_nonzero_patchlevel _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x76ba864c52d0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
__________ ERROR at setup of test_remove_keeps_dir_if_not_deleteable ___________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x70d9197c43a0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______________ ERROR at setup of test_remove_by_python_version ________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7828450c3910>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782846e39870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_uses_patch_version_to_detect_compatibility_with_executable _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed87174bb50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___ ERROR at setup of test_activate_activates_same_virtualenv_with_envs_file ___
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7f5ef3488790>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_______ ERROR at setup of test_get_venv_with_venv_folder_present[False] ________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7eaba680>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x75ab7ebb8670>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_does_not_keep_inconsistent_envs_entry[False] _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x76ba8649ce50>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_fails_if_current_python_version_is_not_supported _
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7ed87286c820>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_fails_if_no_compatible_python_version_could_be_found _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x7accbc6db1c0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_virtualenvs_with_spaces_in_their_path_work_as_expected _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x782ef685d240>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_env_commands_with_spaces_in_their_arg_work_as_expected _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x782ef685cc10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_env_get_supported_tags_matches_inside_virtualenv[True] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x782ef685e170>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_create_venv_does_not_keep_inconsistent_envs_entry[True] _
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x76ba8649d7e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_ ERROR at setup of test_env_get_supported_tags_matches_inside_virtualenv[False] _
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x782ef685e680>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x782ef6b5d990>

    @pytest.fixture
    def poetry(project_factory: ProjectFactory, fixture_dir: FixtureDirGetter) -> Poetry:
>       return project_factory("simple", source=fixture_dir("simple_project"))

/workspace/tests/utils/env/conftest.py:18: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
=================================== FAILURES ===================================
______________________ test_build_handler_build_isolated _______________________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x74e284c45870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x74e285cafc10>

    def test_build_handler_build_isolated(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture
    ) -> None:
        from build import ProjectBuilder
    
        poetry = Factory().create_poetry(fixture_dir("build_systems/has_build_script"))
    
        mock_builder = mocker.MagicMock(spec=ProjectBuilder)
        mock_isolated_builder = mocker.patch(
            "poetry.console.commands.build.isolated_builder"
        )
        mock_isolated_builder.return_value.__enter__.return_value = mock_builder
    
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
>       handler.build(BuildOptions(clean=True, formats=["wheel"], output="dist"))

/workspace/tests/console/commands/test_build.py:302: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:130: in build
    if not self.poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x74e28e9aa0e0>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
__________ test_interactive_with_directory_dependency_and_other_name ___________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad47ad8fd0>
repo = <tests.helpers.TestRepository object at 0x72ad47abc760>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw12/test_interactive_with_director0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x72ad47bcd900>

    def test_interactive_with_directory_dependency_and_other_name(
        tester: CommandTester,
        repo: TestRepository,
        source_dir: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        demo = fixture_dir("git") / "github.com" / "demo" / "pyproject-demo"
        shutil.copytree(str(demo), str(source_dir / "pyproject-demo"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "./pyproject-demo",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:520: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad47e72a40>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
____________________ test_interactive_with_file_dependency _____________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad47e67c40>
repo = <tests.helpers.TestRepository object at 0x72ad47e612a0>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw12/test_interactive_with_file_dep0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x72ad47bcd900>

    def test_interactive_with_file_dependency(
        tester: CommandTester,
        repo: TestRepository,
        source_dir: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        demo = fixture_dir("distributions") / "demo-0.1.0-py2.py3-none-any.whl"
        shutil.copyfile(str(demo), str(source_dir / demo.name))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "./demo-0.1.0-py2.py3-none-any.whl",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:576: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad480751b0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
________________ test_interactive_with_wrong_dependency_inputs _________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad480a9840>
repo = <tests.helpers.TestRepository object at 0x72ad480727d0>

    def test_interactive_with_wrong_dependency_inputs(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.8",  # Python
            "",  # Interactive packages
            "foo 1.19.2",
            "pendulum 2.0.0 foo",  # Package name and constraint (invalid)
            "pendulum@^2.0.0",  # Package name and constraint (valid)
            "",  # End package selection
            "",  # Interactive dev packages
            "pytest 3.6.0 foo",  # Dev package name and constraint (invalid)
            "pytest 3.6.0",  # Dev package name and constraint (invalid)
            "pytest@3.6.0",  # Dev package name and constraint (valid)
            "",  # End package selection
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:625: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad480aad70>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
__________________________ test_predefined_dependency __________________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad48075030>
repo = <tests.helpers.TestRepository object at 0x72ad47e5b040>

    def test_predefined_dependency(tester: CommandTester, repo: TestRepository) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "n",  # Interactive packages
            "n",  # Interactive dev packages
            "\n",  # Generate
        ]
>       tester.execute("--dependency pendulum", inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:695: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:193: in _init_pyproject
    self._determine_requirements(self.option("dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad48075870>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_________________ test_predefined_and_interactive_dependencies _________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad48053370>
repo = <tests.helpers.TestRepository object at 0x72ad47b8b910>

    def test_predefined_and_interactive_dependencies(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pyramid", "1.10"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "pyramid",  # Search for package
            "0",  # First option
            "",  # Do not set constraint
            "",  # Stop searching for packages
            "n",  # Interactive dev packages
            "\n",  # Generate
        ]
    
>       tester.execute("--dependency pendulum", inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:738: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:193: in _init_pyproject
    self._determine_requirements(self.option("dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad48051a80>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
________________________ test_predefined_dev_dependency ________________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad48269c00>
repo = <tests.helpers.TestRepository object at 0x72ad48106740>

    def test_predefined_dev_dependency(tester: CommandTester, repo: TestRepository) -> None:
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "n",  # Interactive packages
            "n",  # Interactive dev packages
            "\n",  # Generate
        ]
    
>       tester.execute("--dev-dependency pytest", inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:774: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:221: in _init_pyproject
    self._determine_requirements(self.option("dev-dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad4826ae90>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_______________ test_predefined_and_interactive_dev_dependencies _______________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad4833c070>
repo = <tests.helpers.TestRepository object at 0x72ad482cf190>

    def test_predefined_and_interactive_dev_dependencies(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("pytest", "3.6.0"))
        repo.add_package(get_package("pytest-requests", "0.2.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "n",  # Interactive packages
            "",  # Interactive dev packages
            "pytest-requests",  # Search for package
            "0",  # Select first option
            "",  # Do not set constraint
            "",  # Stop searching for dev packages
            "\n",  # Generate
        ]
    
>       tester.execute("--dev-dependency pytest", inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:821: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:221: in _init_pyproject
    self._determine_requirements(self.option("dev-dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad4833d510>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_________________________ test_predefined_all_options __________________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad4826a6e0>
repo = <tests.helpers.TestRepository object at 0x72ad48084af0>

    def test_predefined_all_options(tester: CommandTester, repo: TestRepository) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "1.2.3",  # Version
            "",  # Author
            "n",  # Interactive packages
            "n",  # Interactive dev packages
            "\n",  # Generate
        ]
    
>       tester.execute(
            "--name my-package "
            "--description 'This is a description' "
            "--author 'Foo Bar <foo@example.com>' "
            "--python '>=3.8' "
            "--license MIT "
            "--dependency pendulum "
            "--dev-dependency pytest",
            inputs="\n".join(inputs),
        )

/workspace/tests/console/commands/test_init.py:860: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:193: in _init_pyproject
    self._determine_requirements(self.option("dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad48067010>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_________________ test_add_package_with_extras_and_whitespace __________________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad48320640>

    def test_add_package_with_extras_and_whitespace(tester: CommandTester) -> None:
        command = tester.command
        assert isinstance(command, InitCommand)
>       result = command._parse_requirements(["databases[postgresql, sqlite]"])

/workspace/tests/console/commands/test_init.py:899: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad48054ee0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_________ test_init_non_interactive_existing_pyproject_add_dependency __________
[gw12] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x72ad480b4b20>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw12/test_init_non_interactive_exis0')
init_basic_inputs = 'my-package\n1.2.3\nThis is a description\nn\nMIT\n>=3.6\nn\nn\n\n'
repo = <tests.helpers.TestRepository object at 0x72ad48254b20>

    def test_init_non_interactive_existing_pyproject_add_dependency(
        tester: CommandTester,
        source_dir: Path,
        init_basic_inputs: str,
        repo: TestRepository,
    ) -> None:
        pyproject_file = source_dir / "pyproject.toml"
        existing_section = """
    [tool.black]
    line-length = 88
    """
        pyproject_file.write_text(existing_section, encoding="utf-8")
    
        repo.add_package(get_package("foo", "1.19.2"))
    
>       tester.execute(
            "--author 'Your Name <you@example.com>' "
            "--name 'my-package' "
            "--python '>=3.6' "
            "--dependency foo",
            interactive=False,
        )

/workspace/tests/console/commands/test_init.py:962: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:193: in _init_pyproject
    self._determine_requirements(self.option("dependency"))
/workspace/src/poetry/console/commands/init.py:411: in _determine_requirements
    for requirement in self._parse_requirements(requires):
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x72ad480b61d0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
______________________ test_interactive_with_dependencies ______________________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c6d1f7f0>
repo = <tests.helpers.TestRepository object at 0x7f99c6e75930>

    def test_interactive_with_dependencies(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("django-pendulum", "0.1.6-pre4"))
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
        repo.add_package(get_package("flask", "2.0.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "pendulu",  # Search for package
            "1",  # Second option is pendulum
            "",  # Do not set constraint
            "Flask",
            "0",
            "",
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:138: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6d1f730>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_interactive_with_dependencies_and_no_selection ______________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c6b3fa30>
repo = <tests.helpers.TestRepository object at 0x7f99c6f75600>

    def test_interactive_with_dependencies_and_no_selection(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("django-pendulum", "0.1.6-pre4"))
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "pendulu",  # Search for package
            "",  # Do not select an option
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "",  # Do not select an option
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:196: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6b50fa0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
____________________ test_interactive_with_git_dependencies ____________________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c6ecf190>
repo = <tests.helpers.TestRepository object at 0x7f99c696fd60>

    def test_interactive_with_git_dependencies(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "git+https://github.com/demo/demo.git",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:265: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6ecdf90>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_______________ test_application_verify_source_cache_flag[True] ________________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

disable_cache = True
set_project_context = <function set_project_context.<locals>.project_context at 0x782847133be0>

    @pytest.mark.parametrize("disable_cache", [True, False])
    def test_application_verify_source_cache_flag(
        disable_cache: bool, set_project_context: SetProjectContext
    ) -> None:
        with set_project_context("sample_project"):
            app = Application()
    
            tester = ApplicationTester(app)
            command = "debug info"
    
            if disable_cache:
                command = f"{command} --no-cache"
    
            assert not app._poetry
    
            tester.execute(command)
    
>           assert app.poetry.pool.repositories
E           AttributeError: 'NoneType' object has no attribute 'repositories'

/workspace/tests/console/test_application.py:153: AttributeError
_______________ test_application_verify_source_cache_flag[False] _______________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

disable_cache = False
set_project_context = <function set_project_context.<locals>.project_context at 0x7828470e9a20>

    @pytest.mark.parametrize("disable_cache", [True, False])
    def test_application_verify_source_cache_flag(
        disable_cache: bool, set_project_context: SetProjectContext
    ) -> None:
        with set_project_context("sample_project"):
            app = Application()
    
            tester = ApplicationTester(app)
            command = "debug info"
    
            if disable_cache:
                command = f"{command} --no-cache"
    
            assert not app._poetry
    
            tester.execute(command)
    
>           assert app.poetry.pool.repositories
E           AttributeError: 'NoneType' object has no attribute 'repositories'

/workspace/tests/console/test_application.py:153: AttributeError
____________ test_interactive_with_git_dependencies_with_reference _____________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c6a90cd0>
repo = <tests.helpers.TestRepository object at 0x7f99c6eac040>

    def test_interactive_with_git_dependencies_with_reference(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "git+https://github.com/demo/demo.git@develop",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:361: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6a935b0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_application_verify_cache_flag_at_install[True] ______________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x782846a78dc0>
disable_cache = True
set_project_context = <function set_project_context.<locals>.project_context at 0x782846ef7d90>

    @pytest.mark.parametrize("disable_cache", [True, False])
    def test_application_verify_cache_flag_at_install(
        mocker: MockerFixture,
        disable_cache: bool,
        set_project_context: SetProjectContext,
    ) -> None:
        import poetry.utils.authenticator
    
        # Set default authenticator to None so that it is recreated for each test
        # and we get a consistent call_count.
        poetry.utils.authenticator._authenticator = None
    
        with set_project_context("sample_project"):
            app = Application()
    
            tester = ApplicationTester(app)
            command = "install --dry-run"
    
            if disable_cache:
                command = f"{command} --no-cache"
    
            spy = mocker.spy(Authenticator, "__init__")
    
            tester.execute(command)
    
            # The third call is the default authenticator, which ignores the cache flag.
>           assert spy.call_count == 3
E           assert 0 == 3
E            +  where 0 = <function __init__ at 0x782847009fc0>.call_count

/workspace/tests/console/test_application.py:186: AssertionError
_____________ test_application_verify_cache_flag_at_install[False] _____________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x782846efa380>
disable_cache = False
set_project_context = <function set_project_context.<locals>.project_context at 0x78284700add0>

    @pytest.mark.parametrize("disable_cache", [True, False])
    def test_application_verify_cache_flag_at_install(
        mocker: MockerFixture,
        disable_cache: bool,
        set_project_context: SetProjectContext,
    ) -> None:
        import poetry.utils.authenticator
    
        # Set default authenticator to None so that it is recreated for each test
        # and we get a consistent call_count.
        poetry.utils.authenticator._authenticator = None
    
        with set_project_context("sample_project"):
            app = Application()
    
            tester = ApplicationTester(app)
            command = "install --dry-run"
    
            if disable_cache:
                command = f"{command} --no-cache"
    
            spy = mocker.spy(Authenticator, "__init__")
    
            tester.execute(command)
    
            # The third call is the default authenticator, which ignores the cache flag.
>           assert spy.call_count == 3
E           assert 0 == 3
E            +  where 0 = <function __init__ at 0x7828470289d0>.call_count

/workspace/tests/console/test_application.py:186: AssertionError
___________________ test_build_relative_directory_src_layout ___________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw14/test_build_relative_directory_0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    def test_build_relative_directory_src_layout(
        tmp_path: Path, fixture_dir: FixtureDirGetter
    ) -> None:
        tmp_project_path = tmp_path / "project"
        with with_working_directory(fixture_dir("simple_project"), tmp_project_path):
            shutil.rmtree(tmp_project_path / "dist")
            (tmp_project_path / "src").mkdir()
            (tmp_project_path / "simple_project").rename(
                tmp_project_path / "src" / "simple_project"
            )
    
            # We have to use ApplicationTester because CommandTester
            # initializes Poetry before passing the directory.
            app = Application()
            tester = ApplicationTester(app)
            tester.execute("build --project .")
    
            build_dir = tmp_project_path / "dist"
    
>           assert len(list(build_dir.iterdir())) == 2

/workspace/tests/console/commands/test_build.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw14/test_build_relative_directory_0/project/dist')

    def iterdir(self):
        """Iterate over the files in this directory.  Does not yield any
        result for the special paths '.' and '..'.
        """
>       for name in self._accessor.listdir(self):
E       FileNotFoundError: [Errno 2] No such file or directory: '/tmp/pytest-of-root/pytest-0/popen-gw14/test_build_relative_directory_0/project/dist'

/usr/local/lib/python3.10/pathlib.py:1017: FileNotFoundError
____________ test_interactive_with_git_dependencies_and_other_name _____________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c708d810>
repo = <tests.helpers.TestRepository object at 0x7f99c706afb0>

    def test_interactive_with_git_dependencies_and_other_name(
        tester: CommandTester, repo: TestRepository
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "git+https://github.com/demo/pyproject-demo.git",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:410: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c708c400>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
__________________ test_interactive_with_directory_dependency __________________
[gw17] linux -- Python 3.10.18 /opt/venv/bin/python

tester = <cleo.testers.command_tester.CommandTester object at 0x7f99c6f11720>
repo = <tests.helpers.TestRepository object at 0x7f99c6ac6800>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw17/test_interactive_with_director0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f99c6da9870>

    def test_interactive_with_directory_dependency(
        tester: CommandTester,
        repo: TestRepository,
        source_dir: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        repo.add_package(get_package("pendulum", "2.0.0"))
        repo.add_package(get_package("pytest", "3.6.0"))
    
        demo = fixture_dir("git") / "github.com" / "demo" / "demo"
        shutil.copytree(str(demo), str(source_dir / "demo"))
    
        inputs = [
            "my-package",  # Package name
            "1.2.3",  # Version
            "This is a description",  # Description
            "n",  # Author
            "MIT",  # License
            ">=3.6",  # Python
            "",  # Interactive packages
            "./demo",  # Search for package
            "",  # Stop searching for packages
            "",  # Interactive dev packages
            "pytest",  # Search for package
            "0",
            "",
            "",
            "\n",  # Generate
        ]
>       tester.execute(inputs="\n".join(inputs))

/workspace/tests/console/commands/test_init.py:465: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/opt/venv/lib/python3.10/site-packages/cleo/testers/command_tester.py:88: in execute
    self._status_code = self._command.run(self._io)
/opt/venv/lib/python3.10/site-packages/cleo/commands/base_command.py:117: in run
    return self.execute(io) or 0
/opt/venv/lib/python3.10/site-packages/cleo/commands/command.py:61: in execute
    return self.handle()
/workspace/src/poetry/console/commands/init.py:85: in handle
    return self._init_pyproject(project_path=project_path)
/workspace/src/poetry/console/commands/init.py:214: in _init_pyproject
    self._format_requirements(self._determine_requirements([]))
/workspace/src/poetry/console/commands/init.py:331: in _determine_requirements
    constraint = self._parse_requirements([package])[0]
/workspace/src/poetry/console/commands/init.py:467: in _parse_requirements
    cwd = self.poetry.file.path.parent
/workspace/src/poetry/poetry.py:51: in file
    return self.pyproject.file
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7f99c6f11030>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
____________________________ test_info_setup_simple ____________________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x782ef6d30be0>
demo_setup = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_simple0/source')

    def test_info_setup_simple(mocker: MockerFixture, demo_setup: Path) -> None:
        spy = mocker.spy(VirtualEnv, "run")
>       info = PackageInfo.from_directory(demo_setup)

/workspace/tests/inspection/test_info.py:331: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef7272440>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef6dc2d70>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpv2_x8c_2/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______________ test_requires_isolated_build[core_in_range-False] _______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'core_in_range', isolated_build = False
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87f97910>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba87d199c0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_requires_isolated_build[core_not_in_range-True] _____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'core_not_in_range', isolated_build = True
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87dd1db0>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba879407f0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_requires_isolated_build[has_build_script-True] ______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'has_build_script', isolated_build = True
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87dd3e20>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba879013c0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
____________ test_requires_isolated_build[multiple_build_deps-True] ____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'multiple_build_deps', isolated_build = True
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87cb3940>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba879bb9a0>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
__________________ test_requires_isolated_build[no_core-True] __________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'no_core', isolated_build = True
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87d757b0>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba87f73790>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_______________ test_requires_isolated_build[core_from_git-True] _______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'core_from_git', isolated_build = True
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba877c3280>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba87d51f90>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_requires_isolated_build[no_build_system-False] ______________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'no_build_system', isolated_build = False
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87da06d0>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba878b4a00>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
_____________ test_requires_isolated_build[no_build_backend-False] _____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'no_build_backend', isolated_build = False
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba877ad3c0>

    @pytest.mark.parametrize(
        ["project", "isolated_build"],
        [
            ("core_in_range", False),
            ("core_not_in_range", True),
            ("has_build_script", True),
            ("multiple_build_deps", True),
            ("no_core", True),
            ("core_from_git", True),
            ("no_build_system", False),
            ("no_build_backend", False),
        ],
    )
    def test_requires_isolated_build(
        project: str,
        isolated_build: bool,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(f"build_systems/{project}"))
        handler = BuildHandler(poetry=poetry, env=mocker.Mock(), io=NullIO())
    
>       assert handler._requires_isolated_build() is isolated_build

/workspace/tests/console/commands/test_build.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/console/commands/build.py:94: in _requires_isolated_build
    if not self._has_build_backend_defined():
/workspace/src/poetry/console/commands/build.py:127: in _has_build_backend_defined
    return "build-backend" in self.poetry.pyproject.data.get("build-system", {})
/workspace/src/poetry/poetry.py:46: in pyproject
    pyproject = super().pyproject
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba87856620>

    @property
    def pyproject(self) -> PyProjectTOML:
>       return self._pyproject
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:39: AttributeError
___________________________ test_info_setup_complex ____________________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

demo_setup_complex = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_complex0/source')

    def test_info_setup_complex(demo_setup_complex: Path) -> None:
>       info = PackageInfo.from_directory(demo_setup_complex)

/workspace/tests/inspection/test_info.py:338: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef721a800>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef7219c60>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp5ib0z3xn/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
____________________ test_info_setup_complex_pep517_legacy _____________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

demo_setup_complex_pep517_legacy = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_complex_pep5171/source')

    def test_info_setup_complex_pep517_legacy(
        demo_setup_complex_pep517_legacy: Path,
    ) -> None:
>       info = PackageInfo.from_directory(demo_setup_complex_pep517_legacy)

/workspace/tests/inspection/test_info.py:367: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef6e07430>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef6e6ee60>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp3pg68qml/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____________________ test_info_setup_complex_calls_script _____________________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

demo_setup_complex_calls_script = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_complex_calls_0/source')

    def test_info_setup_complex_calls_script(demo_setup_complex_calls_script: Path) -> None:
        """Building the project requires calling a script from its build_requires."""
>       info = PackageInfo.from_directory(demo_setup_complex_calls_script)

/workspace/tests/inspection/test_info.py:373: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef6e3d150>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef6e3d960>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpl3p4576x/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______________________ test_info_from_sdist_no_pkg_info _______________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_info_from_sdist_no_pkg_info(fixture_dir: FixtureDirGetter) -> None:
        path = fixture_dir("distributions") / "demo_no_pkg_info-0.1.0.tar.gz"
>       info = PackageInfo.from_sdist(path)

/workspace/tests/inspection/test_info.py:193: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x7bd607511e70>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd607575c00>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp7wlpffv1/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______ test_info_setup_missing_mandatory_should_trigger_pep517[version] _______
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x782ef6d58b80>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_missing_mandat0/source')
missing = 'version'

    @pytest.mark.parametrize("missing", ["version", "name"])
    def test_info_setup_missing_mandatory_should_trigger_pep517(
        mocker: MockerFixture, source_dir: Path, missing: str
    ) -> None:
        setup = "from setuptools import setup; "
        setup += "setup("
        setup += 'name="demo", ' if missing != "name" else ""
        setup += 'version="0.1.0", ' if missing != "version" else ""
        setup += 'install_requires=["package"]'
        setup += ")"
    
        setup_py = source_dir / "setup.py"
        setup_py.write_text(setup, encoding="utf-8")
    
        spy = mocker.spy(ProjectBuilder, "from_isolated_env")
>       _ = PackageInfo.from_directory(source_dir)

/workspace/tests/inspection/test_info.py:392: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef6e11db0>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef6e12980>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpua9j75h8/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______ test_builder_generates_proper_metadata_when_multiple_readme_files _______
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

with_multiple_readme_files = <poetry.poetry.Poetry object at 0x7ed872c68460>
tmp_venv = VirtualEnv("/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_generates_proper_0/venv")

    def test_builder_generates_proper_metadata_when_multiple_readme_files(
        with_multiple_readme_files: Poetry, tmp_venv: VirtualEnv
    ) -> None:
>       builder = EditableBuilder(with_multiple_readme_files, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:310: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872c68460>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_generates_proper_0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________ test_builder_should_execute_build_scripts ___________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x7ed8732435e0>
extended_without_setup_poetry = <poetry.poetry.Poetry object at 0x7ed872a878e0>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_should_execute_bu0')

    def test_builder_should_execute_build_scripts(
        mocker: MockerFixture, extended_without_setup_poetry: Poetry, tmp_path: Path
    ) -> None:
        env = MockEnv(path=tmp_path / "foo")
        mocker.patch(
            "poetry.masonry.builders.editable.build_environment"
        ).return_value.__enter__.return_value = env
    
>       builder = EditableBuilder(extended_without_setup_poetry, env, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:352: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872a878e0>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
__________________ test_builder_catches_bad_scripts_no_colon ___________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

bad_scripts_no_colon = <poetry.poetry.Poetry object at 0x7ed8728e5180>
tmp_venv = VirtualEnv("/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_catches_bad_scrip0/venv")

    def test_builder_catches_bad_scripts_no_colon(
        bad_scripts_no_colon: Poetry, tmp_venv: VirtualEnv
    ) -> None:
>       builder = EditableBuilder(bad_scripts_no_colon, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:364: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed8728e5180>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_catches_bad_scrip0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________ test_info_setup_missing_mandatory_should_trigger_pep517[name] _________
[gw0] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x782ef6d5ae60>
source_dir = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw0/test_info_setup_missing_mandat1/source')
missing = 'name'

    @pytest.mark.parametrize("missing", ["version", "name"])
    def test_info_setup_missing_mandatory_should_trigger_pep517(
        mocker: MockerFixture, source_dir: Path, missing: str
    ) -> None:
        setup = "from setuptools import setup; "
        setup += "setup("
        setup += 'name="demo", ' if missing != "name" else ""
        setup += 'version="0.1.0", ' if missing != "version" else ""
        setup += 'install_requires=["package"]'
        setup += ")"
    
        setup_py = source_dir / "setup.py"
        setup_py.write_text(setup, encoding="utf-8")
    
        spy = mocker.spy(ProjectBuilder, "from_isolated_env")
>       _ = PackageInfo.from_directory(source_dir)

/workspace/tests/inspection/test_info.py:392: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782ef6dae0e0>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x782ef6dae980>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpl9rh6ow_/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_______________ test_builder_catches_bad_scripts_too_many_colon ________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

bad_scripts_too_many_colon = <poetry.poetry.Poetry object at 0x7ed872c18820>
tmp_venv = VirtualEnv("/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_catches_bad_scrip1/venv")

    def test_builder_catches_bad_scripts_too_many_colon(
        bad_scripts_too_many_colon: Poetry, tmp_venv: VirtualEnv
    ) -> None:
>       builder = EditableBuilder(bad_scripts_too_many_colon, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:378: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872c18820>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw16/test_builder_catches_bad_scrip1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________ test_publish_can_publish_to_given_repository[sample_project] _________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac9803f070>
config = <tests.conftest.Config object at 0x7cac97b4b0a0>
fixture_name = 'sample_project'

    @pytest.mark.parametrize("fixture_name", ["sample_project", "with_source"])
    def test_publish_can_publish_to_given_repository(
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
        config: Config,
        fixture_name: str,
    ) -> None:
        uploader_auth = mocker.patch("poetry.publishing.uploader.Uploader.auth")
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
    
        config.merge(
            {
                "repositories": {"foo": {"url": "http://foo.bar"}},
                "http-basic": {"foo": {"username": "foo", "password": "bar"}},
            }
        )
    
        mocker.patch("poetry.config.config.Config.create", return_value=config)
        poetry = Factory().create_poetry(fixture_dir(fixture_name))
    
        io = BufferedIO()
>       publisher = Publisher(poetry, io)

/workspace/tests/publishing/test_publisher.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97f9f2b0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
___ test_builder_installs_proper_files_for_standard_packages[simple_project] ___
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'simple_project'
simple_poetry = <poetry.poetry.Poetry object at 0x7accbd828e80>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.mark.parametrize("project", ("simple_project", "simple_project_legacy"))
    def test_builder_installs_proper_files_for_standard_packages(
        project: str,
        simple_poetry: Poetry,
        tmp_path: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        simple_poetry = Factory().create_poetry(fixture_dir(project))
        env_manager = EnvManager(simple_poetry)
        venv_path = tmp_path / "venv"
        env_manager.build_venv(venv_path)
        tmp_venv = VirtualEnv(venv_path)
    
>       builder = EditableBuilder(simple_poetry, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7accbd828e80>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f0/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________ test_publish_can_publish_to_given_repository[with_source] ___________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac97b4ba30>
config = <tests.conftest.Config object at 0x7cac97b48550>
fixture_name = 'with_source'

    @pytest.mark.parametrize("fixture_name", ["sample_project", "with_source"])
    def test_publish_can_publish_to_given_repository(
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
        config: Config,
        fixture_name: str,
    ) -> None:
        uploader_auth = mocker.patch("poetry.publishing.uploader.Uploader.auth")
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
    
        config.merge(
            {
                "repositories": {"foo": {"url": "http://foo.bar"}},
                "http-basic": {"foo": {"username": "foo", "password": "bar"}},
            }
        )
    
        mocker.patch("poetry.config.config.Config.create", return_value=config)
        poetry = Factory().create_poetry(fixture_dir(fixture_name))
    
        io = BufferedIO()
>       publisher = Publisher(poetry, io)

/workspace/tests/publishing/test_publisher.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97f9c3d0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
______________ test_publish_raises_error_for_undefined_repository ______________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
config = <tests.conftest.Config object at 0x7cac97b61bd0>

    def test_publish_raises_error_for_undefined_repository(
        fixture_dir: FixtureDirGetter, config: Config
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
        poetry._config = config
        poetry.config.merge(
            {"http-basic": {"my-repo": {"username": "foo", "password": "bar"}}}
        )
>       publisher = Publisher(poetry, NullIO())

/workspace/tests/publishing/test_publisher.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac97a08eb0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_ test_builder_installs_proper_files_for_standard_packages[simple_project_legacy] _
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'simple_project_legacy'
simple_poetry = <poetry.poetry.Poetry object at 0x7accbc615450>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f1')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7accbd055900>

    @pytest.mark.parametrize("project", ("simple_project", "simple_project_legacy"))
    def test_builder_installs_proper_files_for_standard_packages(
        project: str,
        simple_poetry: Poetry,
        tmp_path: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        simple_poetry = Factory().create_poetry(fixture_dir(project))
        env_manager = EnvManager(simple_poetry)
        venv_path = tmp_path / "venv"
        env_manager.build_venv(venv_path)
        tmp_venv = VirtualEnv(venv_path)
    
>       builder = EditableBuilder(simple_poetry, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7accbc615450>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f1/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____________________ test_publish_uses_token_if_it_exists _____________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac97aaf070>
config = <tests.conftest.Config object at 0x7cac97b72fe0>

    def test_publish_uses_token_if_it_exists(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture, config: Config
    ) -> None:
        config.merge({"pypi-token": {"pypi": "my-token"}})
>       assert_publish_uses_token_if_it_exists(fixture_dir, mocker, config)

/workspace/tests/publishing/test_publisher.py:118: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/tests/publishing/test_publisher.py:104: in assert_publish_uses_token_if_it_exists
    publisher = Publisher(poetry, NullIO())
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac96ddcdf0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_________________ test_ensure_plugins_install_missing_plugins __________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd60755eec0>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd60755e5f0>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env0")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd60792df90>

    def test_ensure_plugins_install_missing_plugins(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:319: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd60755eec0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
___________________ test_publish_uses_env_token_if_it_exists ___________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac97a08340>
environ = None

    def test_publish_uses_env_token_if_it_exists(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture, environ: None
    ) -> None:
        os.environ["POETRY_PYPI_TOKEN_PYPI"] = "my-token"
>       assert_publish_uses_token_if_it_exists(fixture_dir, mocker)

/workspace/tests/publishing/test_publisher.py:125: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/tests/publishing/test_publisher.py:104: in assert_publish_uses_token_if_it_exists
    publisher = Publisher(poetry, NullIO())
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac96ddf700>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_______________ test_ensure_plugins_install_only_missing_plugins _______________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd6075661d0>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd607564580>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env1")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd607221b40>

    def test_ensure_plugins_install_only_missing_plugins(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        fixture_path = fixture_dir("project_plugins")
        for dist_info in (
            "my_application_plugin-2.0.dist-info",
            "some_lib-2.0.dist-info",
        ):
            shutil.copytree(fixture_path / dist_info, system_env.purelib / dist_info)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:373: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd6075661d0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
____________________________ test_publish_uses_cert ____________________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac97b12800>
config = <tests.conftest.Config object at 0x7cac96de7850>

    def test_publish_uses_cert(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture, config: Config
    ) -> None:
        cert = "path/to/ca.pem"
        uploader_auth = mocker.patch("poetry.publishing.uploader.Uploader.auth")
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
        poetry._config = config
        poetry.config.merge(
            {
                "repositories": {"foo": {"url": "https://foo.bar"}},
                "http-basic": {"foo": {"username": "foo", "password": "bar"}},
                "certificates": {"foo": {"cert": cert}},
            }
        )
>       publisher = Publisher(poetry, NullIO())

/workspace/tests/publishing/test_publisher.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac96f46320>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
______ test_ensure_plugins_install_overwrite_wrong_version_plugins[False] ______
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd6079af400>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd6079ac220>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env2")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd60737beb0>
debug_out = False

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_install_overwrite_wrong_version_plugins(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
        debug_out: bool,
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
        fixture_path = fixture_dir("project_plugins")
        for dist_info in (
            "my_application_plugin-1.0.dist-info",
            "some_lib-2.0.dist-info",
        ):
            shutil.copytree(fixture_path / dist_info, system_env.purelib / dist_info)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:424: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd6079af400>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
______ test_ensure_plugins_install_overwrite_wrong_version_plugins[True] _______
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd607061120>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd607061150>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env3")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd607b6f5e0>
debug_out = True

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_install_overwrite_wrong_version_plugins(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
        debug_out: bool,
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
        fixture_path = fixture_dir("project_plugins")
        for dist_info in (
            "my_application_plugin-1.0.dist-info",
            "some_lib-2.0.dist-info",
        ):
            shutil.copytree(fixture_path / dist_info, system_env.purelib / dist_info)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:424: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd607061120>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
______________ test_ensure_plugins_pins_other_installed_packages _______________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd6070403a0>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd607040250>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env4")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd607b7d960>

    def test_ensure_plugins_pins_other_installed_packages(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        mocker: MockerFixture,
    ) -> None:
        fixture_path = fixture_dir("project_plugins")
        for dist_info in (
            "my_application_plugin-1.0.dist-info",
            "some_lib-1.0.dist-info",
        ):
            shutil.copytree(fixture_path / dist_info, system_env.purelib / dist_info)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:484: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd6070403a0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
___ test_builder_falls_back_on_setup_and_pip_for_packages_with_build_scripts ___
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x7accbc3f3d30>
extended_poetry = <poetry.poetry.Poetry object at 0x7accbd731b10>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_falls_back_on_set0')

    def test_builder_falls_back_on_setup_and_pip_for_packages_with_build_scripts(
        mocker: MockerFixture, extended_poetry: Poetry, tmp_path: Path
    ) -> None:
        pip_install = mocker.patch("poetry.masonry.builders.editable.pip_install")
        env = MockEnv(path=tmp_path / "foo")
>       builder = EditableBuilder(extended_poetry, env, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:273: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7accbd731b10>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
_________ test_builder_installs_proper_files_when_packages_configured __________
[gw4] linux -- Python 3.10.18 /opt/venv/bin/python

project_with_include = <poetry.poetry.Poetry object at 0x7accbd225ff0>
tmp_venv = VirtualEnv("/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f2/venv")

    def test_builder_installs_proper_files_when_packages_configured(
        project_with_include: Poetry, tmp_venv: VirtualEnv
    ) -> None:
>       builder = EditableBuilder(project_with_include, tmp_venv, NullIO())

/workspace/tests/masonry/builders/test_editable_builder.py:285: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/masonry/builders/editable.py:47: in __init__
    super().__init__(poetry)
/opt/venv/lib/python3.10/site-packages/poetry/core/masonry/builders/builder.py:39: in __init__
    if not poetry.is_package_mode:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7accbd225ff0>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
------------------------------ Captured log setup ------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/pytest-of-root/pytest-0/popen-gw4/test_builder_installs_proper_f2/venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________ test_project_plugins_are_installed_in_project_folder[False] __________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd60707e680>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd60707ea40>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env5")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw2/test_project_plugins_are_insta0')
other_version = False

    @pytest.mark.parametrize("other_version", [False, True])
    def test_project_plugins_are_installed_in_project_folder(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        tmp_path: Path,
        other_version: bool,
    ) -> None:
        orig_purelib = system_env.purelib
        orig_platlib = system_env.platlib
    
        # make sure that the path dependency is on the same drive (for Windows tests in CI)
        orig_wheel_path = (
            fixture_dir("wheel_with_no_requires_dist") / "demo-0.1.0-py2.py3-none-any.whl"
        )
        wheel_path = tmp_path / orig_wheel_path.name
        shutil.copy(orig_wheel_path, wheel_path)
    
        if other_version:
            WheelInstaller(system_env).install(wheel_path)
            dist_info = orig_purelib / "demo-0.1.0.dist-info"
            metadata = dist_info / "METADATA"
            metadata.write_text(
                metadata.read_text(encoding="utf-8").replace("0.1.0", "0.1.2"),
                encoding="utf-8",
            )
            dist_info.rename(orig_purelib / "demo-0.1.2.dist-info")
    
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:550: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd60707e680>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
________________________ test_publish_uses_client_cert _________________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac97aab4f0>
config = <tests.conftest.Config object at 0x7cac97aabb80>

    def test_publish_uses_client_cert(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture, config: Config
    ) -> None:
        client_cert = "path/to/client.pem"
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
        poetry._config = config
        poetry.config.merge(
            {
                "repositories": {"foo": {"url": "https://foo.bar"}},
                "certificates": {"foo": {"client-cert": client_cert}},
            }
        )
>       publisher = Publisher(poetry, NullIO())

/workspace/tests/publishing/test_publisher.py:172: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac96e12cb0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_________________ test_publish_read_from_environment_variable __________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
environ = None
mocker = <pytest_mock.plugin.MockerFixture object at 0x7cac9801f3a0>
config = <tests.conftest.Config object at 0x7cac96dbe920>

    def test_publish_read_from_environment_variable(
        fixture_dir: FixtureDirGetter,
        environ: None,
        mocker: MockerFixture,
        config: Config,
    ) -> None:
        os.environ["POETRY_REPOSITORIES_FOO_URL"] = "https://foo.bar"
        os.environ["POETRY_HTTP_BASIC_FOO_USERNAME"] = "bar"
        os.environ["POETRY_HTTP_BASIC_FOO_PASSWORD"] = "baz"
        uploader_auth = mocker.patch("poetry.publishing.uploader.Uploader.auth")
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
>       publisher = Publisher(poetry, NullIO())

/workspace/tests/publishing/test_publisher.py:199: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7cac96de74f0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
__________ test_project_plugins_are_installed_in_project_folder[True] __________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x7bd607029ea0>
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd60702a590>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw2/system_env6")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw2/test_project_plugins_are_insta1')
other_version = True

    @pytest.mark.parametrize("other_version", [False, True])
    def test_project_plugins_are_installed_in_project_folder(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
        tmp_path: Path,
        other_version: bool,
    ) -> None:
        orig_purelib = system_env.purelib
        orig_platlib = system_env.platlib
    
        # make sure that the path dependency is on the same drive (for Windows tests in CI)
        orig_wheel_path = (
            fixture_dir("wheel_with_no_requires_dist") / "demo-0.1.0-py2.py3-none-any.whl"
        )
        wheel_path = tmp_path / orig_wheel_path.name
        shutil.copy(orig_wheel_path, wheel_path)
    
        if other_version:
            WheelInstaller(system_env).install(wheel_path)
            dist_info = orig_purelib / "demo-0.1.0.dist-info"
            metadata = dist_info / "METADATA"
            metadata.write_text(
                metadata.read_text(encoding="utf-8").replace("0.1.0", "0.1.2"),
                encoding="utf-8",
            )
            dist_info.rename(orig_purelib / "demo-0.1.2.dist-info")
    
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:550: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd607029ea0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
__________________ test_publish_publishes_to_pypi_by_default ___________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>
mocker = <pytest_mock.plugin.MockerFixture object at 0x7bd60700fe20>
config = <tests.conftest.Config object at 0x7bd60751e980>

    def test_publish_publishes_to_pypi_by_default(
        fixture_dir: FixtureDirGetter, mocker: MockerFixture, config: Config
    ) -> None:
        uploader_auth = mocker.patch("poetry.publishing.uploader.Uploader.auth")
        uploader_upload = mocker.patch("poetry.publishing.uploader.Uploader.upload")
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
        poetry._config = config
        poetry.config.merge(
            {"http-basic": {"pypi": {"username": "foo", "password": "bar"}}}
        )
>       publisher = Publisher(poetry, NullIO())

/workspace/tests/publishing/test_publisher.py:35: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/publishing/publisher.py:28: in __init__
    self._package = poetry.package
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd60755c460>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
________ test_search_for_directory_setup_with_base[non-canonical-name] _________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

provider = <poetry.puzzle.provider.Provider object at 0x76ba87d3dc00>
directory = 'non-canonical-name'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw14/test_search_for_directory_setu0')

    @pytest.mark.parametrize("directory", ["demo", "non-canonical-name"])
    def test_search_for_directory_setup_with_base(
        provider: Provider, directory: str, fixture_dir: FixtureDirGetter, tmp_path: Path
    ) -> None:
        path = shutil.copytree(
            fixture_dir("git") / "github.com" / "demo" / directory, tmp_path / "project"
        )
    
        dependency = DirectoryDependency("demo", path, base=path)
    
>       package = provider.search_for_direct_origin_dependency(dependency)

/workspace/tests/puzzle/test_provider.py:329: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/provider.py:253: in search_for_direct_origin_dependency
    package = self._search_for_directory(dependency)
/workspace/src/poetry/puzzle/provider.py:357: in _search_for_directory
    package = self._direct_origin.get_package_from_directory(dependency.full_path)
/workspace/src/poetry/packages/direct_origin.py:80: in get_package_from_directory
    return PackageInfo.from_directory(path=directory).to_package(root_dir=directory)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x76ba87cb3dc0>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x76ba87d3ed40>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp83bpdlly/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________________________ test_load_plugins_and_activate ________________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

manager_factory = <function manager_factory.<locals>._manager at 0x77c5bf7f2b00>
poetry = <poetry.poetry.Poetry object at 0x77c5c51a2200>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c51a23e0>
with_my_plugin = None

    def test_load_plugins_and_activate(
        manager_factory: ManagerFactory,
        poetry: Poetry,
        io: BufferedIO,
        with_my_plugin: None,
    ) -> None:
        manager = manager_factory()
        manager.load_plugins()
>       manager.activate(poetry, io)

/workspace/tests/plugins/test_plugin_manager.py:145: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:82: in activate
    plugin.activate(*args, **kwargs)
/workspace/tests/plugins/test_plugin_manager.py:52: in activate
    poetry.package.readmes = (Path("README.md"),)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c51a2200>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
________ test_solver_can_resolve_directory_dependencies_nested_editable ________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

repo = <poetry.repositories.repository.Repository object at 0x7897ab0728f0>
pool = <poetry.repositories.repository_pool.RepositoryPool object at 0x7897ab375060>
io = <cleo.io.null_io.NullIO object at 0x7897ab0d57e0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7897aaaa5870>

    def test_solver_can_resolve_directory_dependencies_nested_editable(
        repo: Repository,
        pool: RepositoryPool,
        io: NullIO,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        base = fixture_dir("project_with_nested_local")
        poetry = Factory().create_poetry(cwd=base)
>       package = poetry.package

/workspace/tests/puzzle/test_solver.py:2865: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7897aad445e0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_________________________ test_add_project_plugin_path _________________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c50c89d0>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c50c9000>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw1/system_env0")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    def test_add_project_plugin_path(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        dist_info_1 = "my_application_plugin-1.0.dist-info"
        dist_info_2 = "my_application_plugin-2.0.dist-info"
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:171: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c50c89d0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
___________________ test_ensure_plugins_no_plugins_no_output ___________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry = <poetry.poetry.Poetry object at 0x77c5c4b6a800>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c51ca440>

    def test_ensure_plugins_no_plugins_no_output(poetry: Poetry, io: BufferedIO) -> None:
>       PluginManager.ensure_project_plugins(poetry, io)

/workspace/tests/plugins/test_plugin_manager.py:191: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:69: in ensure_project_plugins
    ProjectPluginCache(poetry, io).ensure_plugins()
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c4b6a800>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
___________ test_ensure_plugins_no_plugins_existing_cache_is_removed ___________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry = <poetry.poetry.Poetry object at 0x77c5c4b8cca0>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c4f62bc0>

    def test_ensure_plugins_no_plugins_existing_cache_is_removed(
        poetry: Poetry, io: BufferedIO
    ) -> None:
>       plugin_path = poetry.pyproject_path.parent / ProjectPluginCache.PATH

/workspace/tests/plugins/test_plugin_manager.py:201: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c4b8cca0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
_______ test_search_for_directory_setup_read_setup_with_no_dependencies ________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

provider = <poetry.puzzle.provider.Provider object at 0x76ba87e6d9f0>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw14/test_search_for_directory_setu3')

    def test_search_for_directory_setup_read_setup_with_no_dependencies(
        provider: Provider, fixture_dir: FixtureDirGetter, tmp_path: Path
    ) -> None:
        path = shutil.copytree(
            fixture_dir("git") / "github.com" / "demo" / "no-dependencies",
            tmp_path / "project",
        )
    
        dependency = DirectoryDependency("demo", path)
    
>       package = provider.search_for_direct_origin_dependency(dependency)

/workspace/tests/puzzle/test_provider.py:412: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/provider.py:253: in search_for_direct_origin_dependency
    package = self._search_for_directory(dependency)
/workspace/src/poetry/puzzle/provider.py:357: in _search_for_directory
    package = self._direct_origin.get_package_from_directory(dependency.full_path)
/workspace/src/poetry/packages/direct_origin.py:80: in get_package_from_directory
    return PackageInfo.from_directory(path=directory).to_package(root_dir=directory)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x76ba87865b10>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x76ba87e6fbb0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpabsrm387/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________________ test_ensure_plugins_no_output_if_fresh[False] _________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c49d7f40>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c49d4880>
debug_out = False

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_no_output_if_fresh(
        poetry_with_plugins: Poetry, io: BufferedIO, debug_out: bool
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c49d7f40>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
_________________ test_ensure_plugins_no_output_if_fresh[True] _________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c4a0ee30>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c4a0ff40>, debug_out = True

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_no_output_if_fresh(
        poetry_with_plugins: Poetry, io: BufferedIO, debug_out: bool
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:218: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c4a0ee30>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
_____________ test_ensure_plugins_ignore_irrelevant_markers[False] _____________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c4954b20>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c4955750>
debug_out = False

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_ignore_irrelevant_markers(
        poetry_with_plugins: Poetry, io: BufferedIO, debug_out: bool
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
>       poetry_with_plugins.local_config["requires-plugins"] = {
            "irrelevant": {"version": "1.0", "markers": "python_version < '3'"}
        }

/workspace/tests/plugins/test_plugin_manager.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c4954b20>

    @property
    def local_config(self) -> dict[str, Any]:
>       return self._local_config
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:57: AttributeError
_____________ test_ensure_plugins_ignore_irrelevant_markers[True] ______________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c50fda20>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c50ff490>, debug_out = True

    @pytest.mark.parametrize("debug_out", [False, True])
    def test_ensure_plugins_ignore_irrelevant_markers(
        poetry_with_plugins: Poetry, io: BufferedIO, debug_out: bool
    ) -> None:
        io.set_verbosity(Verbosity.DEBUG if debug_out else Verbosity.NORMAL)
>       poetry_with_plugins.local_config["requires-plugins"] = {
            "irrelevant": {"version": "1.0", "markers": "python_version < '3'"}
        }

/workspace/tests/plugins/test_plugin_manager.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c50fda20>

    @property
    def local_config(self) -> dict[str, Any]:
>       return self._local_config
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:57: AttributeError
_____________________ test_ensure_plugins_remove_outdated ______________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c50b4280>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c50b6a10>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    def test_ensure_plugins_remove_outdated(
        poetry_with_plugins: Poetry, io: BufferedIO, fixture_dir: FixtureDirGetter
    ) -> None:
        # Test with irrelevant plugins because this is the first return
        # where it is relevant that an existing cache is removed.
>       poetry_with_plugins.local_config["requires-plugins"] = {
            "irrelevant": {"version": "1.0", "markers": "python_version < '3'"}
        }

/workspace/tests/plugins/test_plugin_manager.py:264: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c50b4280>

    @property
    def local_config(self) -> dict[str, Any]:
>       return self._local_config
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:57: AttributeError
__________ test_ensure_plugins_ignore_already_installed_in_system_env __________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

poetry_with_plugins = <poetry.poetry.Poetry object at 0x77c5c50fc5e0>
io = <cleo.io.buffered_io.BufferedIO object at 0x77c5c50fc520>
system_env = MockEnv("/tmp/pytest-of-root/pytest-0/popen-gw1/system_env1")
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    def test_ensure_plugins_ignore_already_installed_in_system_env(
        poetry_with_plugins: Poetry,
        io: BufferedIO,
        system_env: Env,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        fixture_path = fixture_dir("project_plugins")
        for dist_info in (
            "my_application_plugin-2.0.dist-info",
            "my_other_plugin-1.0.dist-info",
        ):
            shutil.copytree(fixture_path / dist_info, system_env.purelib / dist_info)
>       cache = ProjectPluginCache(poetry_with_plugins, io)

/workspace/tests/plugins/test_plugin_manager.py:296: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/plugins/plugin_manager.py:111: in __init__
    self._path = poetry.pyproject_path.parent / self.PATH
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x77c5c50fc5e0>

    @property
    def pyproject_path(self) -> Path:
>       return self._pyproject.path
E       AttributeError: 'Poetry' object has no attribute '_pyproject'. Did you mean: 'pyproject'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:43: AttributeError
_________ test_search_for_directory_setup_egg_info[non-canonical-name] _________
[gw18] linux -- Python 3.10.18 /opt/venv/bin/python

provider = <poetry.puzzle.provider.Provider object at 0x70d919dcaf50>
directory = 'non-canonical-name'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x70d91960d120>
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw18/test_search_for_directory_setu1')

    @pytest.mark.parametrize("directory", ["demo", "non-canonical-name"])
    def test_search_for_directory_setup_egg_info(
        provider: Provider, directory: str, fixture_dir: FixtureDirGetter, tmp_path: Path
    ) -> None:
        path = shutil.copytree(
            fixture_dir("git") / "github.com" / "demo" / directory, tmp_path / "project"
        )
        dependency = DirectoryDependency("demo", path)
    
>       package = provider.search_for_direct_origin_dependency(dependency)

/workspace/tests/puzzle/test_provider.py:280: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/provider.py:253: in search_for_direct_origin_dependency
    package = self._search_for_directory(dependency)
/workspace/src/poetry/puzzle/provider.py:357: in _search_for_directory
    package = self._direct_origin.get_package_from_directory(dependency.full_path)
/workspace/src/poetry/packages/direct_origin.py:80: in get_package_from_directory
    return PackageInfo.from_directory(path=directory).to_package(root_dir=directory)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x70d919d12830>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x70d919b0d8a0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpujook9cn/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________________ test_create_poetry_with_packages_and_includes _________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_create_poetry_with_packages_and_includes(
        fixture_dir: FixtureDirGetter,
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir("with-include"))
    
>       package = poetry.package

/workspace/tests/test_factory.py:198: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd60735ed40>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
________ test_poetry_with_primary_source[with_primary_source_implicit] _________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'with_primary_source_implicit'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>
with_simple_keyring = None

    @pytest.mark.parametrize(
        "project",
        ("with_primary_source_implicit", "with_primary_source_explicit"),
    )
    def test_poetry_with_primary_source(
        project: str, fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir(project), io=io)
    
>       assert not poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:269: AttributeError
_____________ test_create_poetry_with_multi_constraints_dependency _____________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_create_poetry_with_multi_constraints_dependency(
        fixture_dir: FixtureDirGetter,
    ) -> None:
        poetry = Factory().create_poetry(
            fixture_dir("project_with_multi_constraints_dependency")
        )
    
>       package = poetry.package

/workspace/tests/test_factory.py:231: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd607b6d390>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_____________________ test_create_poetry_with_local_config _____________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    def test_create_poetry_with_local_config(fixture_dir: FixtureDirGetter) -> None:
        poetry = Factory().create_poetry(fixture_dir("with_local_config"))
    
>       assert not poetry.config.get("virtualenvs.in-project")
E       AttributeError: 'NoneType' object has no attribute 'get'

/workspace/tests/test_factory.py:439: AttributeError
_______________________ test_create_poetry_with_plugins ________________________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87ccb460>
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>

    def test_create_poetry_with_plugins(
        mocker: MockerFixture, fixture_dir: FixtureDirGetter
    ) -> None:
        mock_metadata_entry_points(mocker, MyPlugin)
    
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
    
>       assert poetry.package.readmes == (Path("README.md"),)

/workspace/tests/test_factory.py:453: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x76ba86532860>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_____________________ test_create_poetry_non_package_mode ______________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_create_poetry_non_package_mode(fixture_dir: FixtureDirGetter) -> None:
        poetry = Factory().create_poetry(fixture_dir("non_package_mode"))
    
>       assert not poetry.is_package_mode

/workspace/tests/test_factory.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7bd607323cd0>

    @property
    def is_package_mode(self) -> bool:
>       package_mode = self._local_config["package-mode"]
E       AttributeError: 'Poetry' object has no attribute '_local_config'. Did you mean: 'local_config'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:51: AttributeError
________ test_poetry_with_primary_source[with_primary_source_explicit] _________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'with_primary_source_explicit'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>
with_simple_keyring = None

    @pytest.mark.parametrize(
        "project",
        ("with_primary_source_implicit", "with_primary_source_explicit"),
    )
    def test_poetry_with_primary_source(
        project: str, fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir(project), io=io)
    
>       assert not poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:269: AttributeError
__ test_poetry_with_pypi_explicit_only[with_explicit_pypi_and_other_explicit] __
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'with_explicit_pypi_and_other_explicit'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>
with_simple_keyring = None

    @pytest.mark.parametrize(
        "project", ["with_explicit_pypi_no_other", "with_explicit_pypi_and_other_explicit"]
    )
    def test_poetry_with_pypi_explicit_only(
        project: str, fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
>       with pytest.raises(PoetryError) as e:
E       Failed: DID NOT RAISE <class 'poetry.exceptions.PoetryError'>

/workspace/tests/test_factory.py:379: Failed
______________________ test_poetry_with_no_default_source ______________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>

    def test_poetry_with_no_default_source(fixture_dir: FixtureDirGetter) -> None:
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
    
>       assert poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:322: AttributeError
______________________________ test_create_poetry ______________________________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    def test_create_poetry(fixture_dir: FixtureDirGetter) -> None:
        poetry = Factory().create_poetry(fixture_dir("sample_project"))
    
>       package = poetry.package

/workspace/tests/test_factory.py:47: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872b2eaa0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_______________ test_get_package_information_fallback_read_setup _______________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x75ab7ec0f970>
name = 'jupyter'
version = Version(epoch=0, release=Release(major=1, minor=0, patch=0, extra=(), precision=3, text='1.0.0', _compare_key=(1,)), p...y=(1,)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('jupyter', '1.0.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x75ab7ec0f970>

    def test_get_package_information_fallback_read_setup(
        legacy_repository: LegacyRepository,
    ) -> None:
        repo = legacy_repository
    
>       package = repo.package("jupyter", Version.parse("1.0.0"))

/workspace/tests/repositories/test_legacy_repository.py:138: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x75ab7f06a800>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x75ab7f06a590>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0db10>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/jupyter/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0dea0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0fc70>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/c9/a9/371d0b8fe37dd231cf4b2cff0a9f0f25e98f3a73c3771742444be27f2944/jupyter-1.0.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0caf0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0d6f0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/c9/a9/371d0b8fe37dd231cf4b2cff0a9f0f25e98f3a73c3771742444be27f2944/jupyter-1.0.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x75ab7ec0ff40>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpujjzcc7j/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________________ test_poetry_with_multiple_supplemental_sources ________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>
with_simple_keyring = None

    def test_poetry_with_multiple_supplemental_sources(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir("with_multiple_supplemental_sources"))
    
>       assert poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:281: AttributeError
_____________________ test_poetry_with_supplemental_source _____________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
with_simple_keyring = None

    def test_poetry_with_supplemental_source(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir("with_supplemental_source"), io=io)
    
>       assert poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:334: AttributeError
__________ test_create_pyproject_from_package[simple_project_legacy] ___________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'simple_project_legacy'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.mark.parametrize(
        ("project",),
        [
            ("simple_project_legacy",),
            ("project_with_extras",),
        ],
    )
    def test_create_pyproject_from_package(
        project: str, fixture_dir: FixtureDirGetter
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(project))
>       package = poetry.package

/workspace/tests/test_factory.py:165: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872b2e1a0>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
_______________________ test_poetry_with_explicit_source _______________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
with_simple_keyring = None

    def test_poetry_with_explicit_source(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir("with_explicit_source"), io=io)
    
>       assert len(poetry.pool.repositories) == 1
E       AttributeError: 'NoneType' object has no attribute 'repositories'

/workspace/tests/test_factory.py:350: AttributeError
______________________ test_poetry_with_multiple_sources _______________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>
with_simple_keyring = None

    def test_poetry_with_multiple_sources(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir("with_multiple_sources"))
    
>       assert not poetry.pool.has_repository("PyPI")
E       AttributeError: 'NoneType' object has no attribute 'has_repository'

/workspace/tests/test_factory.py:296: AttributeError
___________________ test_poetry_with_explicit_pypi_and_other ___________________
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
with_simple_keyring = None

    def test_poetry_with_explicit_pypi_and_other(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir("with_explicit_pypi_and_other"), io=io)
    
>       assert len(poetry.pool.repositories) == 1
E       AttributeError: 'NoneType' object has no attribute 'repositories'

/workspace/tests/test_factory.py:367: AttributeError
___________ test_create_pyproject_from_package[project_with_extras] ____________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'project_with_extras'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7ed872e89870>

    @pytest.mark.parametrize(
        ("project",),
        [
            ("simple_project_legacy",),
            ("project_with_extras",),
        ],
    )
    def test_create_pyproject_from_package(
        project: str, fixture_dir: FixtureDirGetter
    ) -> None:
        poetry = Factory().create_poetry(fixture_dir(project))
>       package = poetry.package

/workspace/tests/test_factory.py:165: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed872c1c370>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
____________________ test_poetry_with_multiple_sources_pypi ____________________
[gw5] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7f5ef3205870>
with_simple_keyring = None

    def test_poetry_with_multiple_sources_pypi(
        fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
        io = BufferedIO()
        poetry = Factory().create_poetry(fixture_dir("with_multiple_sources_pypi"), io=io)
    
>       assert len(poetry.pool.repositories) == 4
E       AttributeError: 'NoneType' object has no attribute 'repositories'

/workspace/tests/test_factory.py:310: AttributeError
_______ test_poetry_with_pypi_explicit_only[with_explicit_pypi_no_other] _______
[gw13] linux -- Python 3.10.18 /opt/venv/bin/python

project = 'with_explicit_pypi_no_other'
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7cac97e31870>
with_simple_keyring = None

    @pytest.mark.parametrize(
        "project", ["with_explicit_pypi_no_other", "with_explicit_pypi_and_other_explicit"]
    )
    def test_poetry_with_pypi_explicit_only(
        project: str, fixture_dir: FixtureDirGetter, with_simple_keyring: None
    ) -> None:
>       with pytest.raises(PoetryError) as e:
E       Failed: DID NOT RAISE <class 'poetry.exceptions.PoetryError'>

/workspace/tests/test_factory.py:379: Failed
______________________ test_create_poetry_version_not_ok _______________________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_create_poetry_version_not_ok(fixture_dir: FixtureDirGetter) -> None:
>       with pytest.raises(PoetryError) as e:
E       Failed: DID NOT RAISE <class 'poetry.exceptions.PoetryError'>

/workspace/tests/test_factory.py:251: Failed
______________ test_get_package_retrieves_packages_with_no_hashes ______________
[gw20] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x782847175c00>
name = 'jupyter'
version = Version(epoch=0, release=Release(major=1, minor=0, patch=0, extra=(), precision=3, text='1.0.0', _compare_key=(1,)), p...y=(1,)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('jupyter', '1.0.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x782847175c00>
dist_hash_getter = <function dist_hash_getter.<locals>.get_hash at 0x78284672bb50>

    def test_get_package_retrieves_packages_with_no_hashes(
        legacy_repository: LegacyRepository, dist_hash_getter: DistributionHashGetter
    ) -> None:
        repo = legacy_repository
    
>       package = repo.package("jupyter", Version.parse("1.0.0"))

/workspace/tests/repositories/test_legacy_repository.py:455: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x782846f9c490>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x78284700cfa0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782847177d30>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/jupyter/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782847174a90>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782846ac5b70>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/c9/a9/371d0b8fe37dd231cf4b2cff0a9f0f25e98f3a73c3771742444be27f2944/jupyter-1.0.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782846ac7ca0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782846ac71f0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/c9/a9/371d0b8fe37dd231cf4b2cff0a9f0f25e98f3a73c3771742444be27f2944/jupyter-1.0.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x782846ac4490>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpve50o29e/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
__________________________ test_package_partial_yank ___________________________
[gw8] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x7897aaff8160>
name = 'futures'
version = Version(epoch=0, release=Release(major=3, minor=2, patch=0, extra=(), precision=3, text='3.2.0', _compare_key=(3, 2)),...(3, 2)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('futures', '3.2.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x7897aaff9e40>
legacy_repository_partial_yank = <poetry.repositories.legacy_repository.LegacyRepository object at 0x7897aaff8160>

    def test_package_partial_yank(
        legacy_repository: LegacyRepository,
        legacy_repository_partial_yank: LegacyRepository,
    ) -> None:
        repo = legacy_repository
        package = repo.package("futures", Version.parse("3.2.0"))
        assert len(package.files) == 2
    
        repo = legacy_repository_partial_yank
>       package = repo.package("futures", Version.parse("3.2.0"))

/workspace/tests/repositories/test_legacy_repository.py:501: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x7897ab1ea560>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x7897aac747f0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897ab29e050>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/futures/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aaff8370>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0ec20>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/2d/99/b2c4e9d5a30f6471e410a146232b4118e697fa3ffc06d6a65efde84debd0/futures-3.2.0-py2-none-any.whl", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'identity', 'Accept': '*/*', 'Connection': 'keep-alive', 'Cache-Control': 'no-cache', 'Range': 'bytes=-10000'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0ebc0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0ebc0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0ed10>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/2d/99/b2c4e9d5a30f6471e410a146232b4118e697fa3ffc06d6a65efde84debd0/futures-3.2.0-py2-none-any.whl", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0fd00>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0c310>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/futures-partial-yank/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0f310>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0e4d0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/1f/9e/7b2ff7e965fc654592269f2906ade1c7d705f1bf25b7d469fa153f7d19eb/futures-3.2.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x7897aac0ec80>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp482nwzb1/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____ test_solver_does_not_choose_from_supplemental_repository_by_default ______
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e285388d00>
name = 'pastel'
version = Version(epoch=0, release=Release(major=0, minor=1, patch=0, extra=(), precision=3, text='0.1.0', _compare_key=(0, 1)),...(0, 1)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('pastel', '0.1.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

package = Package('root', '1.0')
io = <cleo.io.null_io.NullIO object at 0x74e285388790>
legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e285388d00>
pypi_repository = <poetry.repositories.pypi_repository.PyPiRepository object at 0x74e284114a00>

    def test_solver_does_not_choose_from_supplemental_repository_by_default(
        package: ProjectPackage,
        io: NullIO,
        legacy_repository: LegacyRepository,
        pypi_repository: PyPiRepository,
    ) -> None:
        package.python_versions = "^3.7"
        package.add_dependency(Factory.create_dependency("clikit", {"version": "^0.2.0"}))
    
        pool = RepositoryPool()
        pool.add_repository(pypi_repository, priority=Priority.SUPPLEMENTAL)
        pool.add_repository(legacy_repository)
    
        solver = Solver(package, pool, [], [], io)
    
>       transaction = solver.solve()

/workspace/tests/puzzle/test_solver.py:3362: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/solver.py:87: in solve
    packages = self._solve()
/workspace/src/poetry/puzzle/solver.py:170: in _solve
    result = resolve_version(self._package, self._provider)
/workspace/src/poetry/mixology/__init__.py:18: in resolve_version
    return solver.solve()
/workspace/src/poetry/mixology/version_solver.py:192: in solve
    next = self._choose_package_version()
/workspace/src/poetry/mixology/version_solver.py:599: in _choose_package_version
    package = self._provider.complete_package(package)
/workspace/src/poetry/puzzle/provider.py:476: in complete_package
    self.get_package_from_pool(
/workspace/src/poetry/repositories/repository_pool.py:162: in package
    return repo.package(name, version)
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x74e2854c3520>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x74e2840eaec0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2853892a0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/clikit/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285388310>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284f06260>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/7b/0d/bb4c8a2d0edca8c300373ed736fb4680cf73be5be2ff84544dee5f979c14/clikit-0.2.4-py2.py3-none-any.whl", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'identity', 'Accept': '*/*', 'Connection': 'keep-alive', 'Cache-Control': 'no-cache', 'Range': 'bytes=-10000'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284f04280>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284f04280>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284f07610>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/7b/0d/bb4c8a2d0edca8c300373ed736fb4680cf73be5be2ff84544dee5f979c14/clikit-0.2.4-py2.py3-none-any.whl", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284f047c0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cd210>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pylev/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cd5d0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cf3a0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/simple/pylev/", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': 'application/vnd.pypi.simple.v1+json', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cce50>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855ccac0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pylev/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855ce8c0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855ce6b0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/pypi/pylev/1.3.0/json", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cc9a0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cf8e0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pastel/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cedd0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cfa30>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855cfeb0>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpayj_chbs/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2854c3c40>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2854c29e0>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp7kt42pis/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2854c21a0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2854c2050>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpuyq5x90u/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_____________ test_build_environment_called_build_script_specified _____________
[gw16] linux -- Python 3.10.18 /opt/venv/bin/python

mocker = <pytest_mock.plugin.MockerFixture object at 0x7ed872f18c70>
extended_without_setup_poetry = <poetry.poetry.Poetry object at 0x7ed871772530>

    def test_build_environment_called_build_script_specified(
        mocker: MockerFixture,
        extended_without_setup_poetry: Poetry,
    ) -> None:
        patched_install = mocker.patch("poetry.utils.isolated_build.IsolatedEnv.install")
    
        with ephemeral_environment() as project_env:
            import poetry.utils.env
    
            spy = mocker.spy(poetry.utils.env, "ephemeral_environment")
    
>           with build_environment(extended_without_setup_poetry, project_env):

/workspace/tests/utils/env/test_env.py:502: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/env/__init__.py:63: in build_environment
    if not env or poetry.package.build_script:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.poetry.Poetry object at 0x7ed871772530>

    @property
    def package(self) -> ProjectPackage:
>       return self._package
E       AttributeError: 'Poetry' object has no attribute '_package'. Did you mean: 'package'?

/opt/venv/lib/python3.10/site-packages/poetry/core/poetry.py:47: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/opt/venv/bin/python)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, system=/usr/local/bin/python3.10, exe=/opt/venv/bin/python, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp03kv7frp/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______________ test_create_poetry_fails_on_invalid_configuration _______________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    def test_create_poetry_fails_on_invalid_configuration(
        fixture_dir: FixtureDirGetter,
    ) -> None:
>       with pytest.raises(RuntimeError) as e:
E       Failed: DID NOT RAISE <class 'RuntimeError'>

/workspace/tests/test_factory.py:411: Failed
_________________ test_create_poetry_fails_on_nameless_project _________________
[gw1] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x77c5c495d900>

    def test_create_poetry_fails_on_nameless_project(
        fixture_dir: FixtureDirGetter,
    ) -> None:
>       with pytest.raises(RuntimeError) as e:
E       Failed: DID NOT RAISE <class 'RuntimeError'>

/workspace/tests/test_factory.py:425: Failed
___________ test_create_venv_project_name_empty_sets_correct_prompt ____________
[gw14] linux -- Python 3.10.18 /opt/venv/bin/python

fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x76ba87c65870>
project_factory = <function project_factory.<locals>._factory at 0x76ba863332e0>
config = <tests.conftest.Config object at 0x76ba87d167a0>
mocker = <pytest_mock.plugin.MockerFixture object at 0x76ba87d16200>
config_virtualenvs_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw14/test_create_venv_project_name_0/.cache/pypoetry/virtualenvs')
mocked_python_register = <function mocked_python_register.<locals>.register at 0x76ba86333f40>

    def test_create_venv_project_name_empty_sets_correct_prompt(
        fixture_dir: FixtureDirGetter,
        project_factory: ProjectFactory,
        config: Config,
        mocker: MockerFixture,
        config_virtualenvs_path: Path,
        mocked_python_register: MockedPythonRegister,
    ) -> None:
        config.config["virtualenvs"]["use-poetry-python"] = True
        if "VIRTUAL_ENV" in os.environ:
            del os.environ["VIRTUAL_ENV"]
    
>       poetry = project_factory("no", source=fixture_dir("no_name_project"))

/workspace/tests/utils/env/test_env_manager.py:1138: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'no', dependencies = {}, dev_dependencies = {}, pyproject_content = None
poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/no_name_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
___________ test_run_installs_with_local_setuptools_directory[False] ___________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

installer = <poetry.installation.installer.Installer object at 0x7bed4ad36a10>
locker = <tests.installation.test_installer.Locker object at 0x7bed4b214430>
repo = <poetry.repositories.repository.Repository object at 0x7bed4aef65f0>
package = Package('root', '1.0')
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw10/test_run_installs_with_local_s0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    def test_run_installs_with_local_setuptools_directory(
        installer: Installer,
        locker: Locker,
        repo: Repository,
        package: ProjectPackage,
        tmp_path: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        root_dir = tmp_path / "root"
        package.root_dir = root_dir
        locker.set_lock_path(root_dir)
        file_path = shutil.copytree(fixture_dir("project_with_setup"), root_dir / "project")
        package.add_dependency(
            Factory.create_dependency(
                "project-with-setup",
                {"path": str(file_path.relative_to(root_dir))},
                root_dir=root_dir,
            )
        )
    
        repo.add_package(get_package("pendulum", "1.4.4"))
        repo.add_package(get_package("cachy", "0.2.0"))
    
>       result = installer.run()

/workspace/tests/installation/test_installer.py:1806: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:241: in _do_install
    solved_packages = solver.solve(
/workspace/src/poetry/puzzle/solver.py:87: in solve
    packages = self._solve()
/workspace/src/poetry/puzzle/solver.py:170: in _solve
    result = resolve_version(self._package, self._provider)
/workspace/src/poetry/mixology/__init__.py:18: in resolve_version
    return solver.solve()
/workspace/src/poetry/mixology/version_solver.py:192: in solve
    next = self._choose_package_version()
/workspace/src/poetry/mixology/version_solver.py:599: in _choose_package_version
    package = self._provider.complete_package(package)
/workspace/src/poetry/puzzle/provider.py:577: in complete_package
    self.search_for_direct_origin_dependency(dep)
/workspace/src/poetry/puzzle/provider.py:253: in search_for_direct_origin_dependency
    package = self._search_for_directory(dependency)
/workspace/src/poetry/puzzle/provider.py:357: in _search_for_directory
    package = self._direct_origin.get_package_from_directory(dependency.full_path)
/workspace/src/poetry/packages/direct_origin.py:80: in get_package_from_directory
    return PackageInfo.from_directory(path=directory).to_package(root_dir=directory)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x7bed4b2824d0>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x7bed4b281030>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpm_f0gkkq/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
_________________________ test_python_find_compatible __________________________
[gw15] linux -- Python 3.10.18 /opt/venv/bin/python

project_factory = <function project_factory.<locals>._factory at 0x75ab7f1663b0>
mocked_python_register = <function mocked_python_register.<locals>.register at 0x75ab7f1670a0>

    def test_python_find_compatible(
        project_factory: ProjectFactory, mocked_python_register: MockedPythonRegister
    ) -> None:
        # Note: This test may fail on Windows systems using Python from the Microsoft Store,
        # as the executable is named `py.exe`, which is not currently recognized by
        # Python.get_compatible_python. This issue will be resolved in #2117.
        # However, this does not cause problems in our case because Poetry's own
        # Python interpreter is used before attempting to find another compatible version.
        fixture = Path(__file__).parent.parent / "fixtures" / "simple_project"
>       poetry = project_factory("simple-project", source=fixture)

/workspace/tests/utils/test_python_manager.py:140: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

name = 'simple-project', dependencies = {}, dev_dependencies = {}
pyproject_content = None, poetry_lock_content = None, install_deps = True
source = PosixPath('/workspace/tests/fixtures/simple_project')
locker_config = None, use_test_locker = True

    def _factory(
        name: str | None = None,
        dependencies: Mapping[str, str] | None = None,
        dev_dependencies: Mapping[str, str] | None = None,
        pyproject_content: str | None = None,
        poetry_lock_content: str | None = None,
        install_deps: bool = True,
        source: Path | None = None,
        locker_config: dict[str, Any] | None = None,
        use_test_locker: bool = True,
    ) -> Poetry:
        project_dir = workspace / f"poetry-fixture-{name}"
        dependencies = dependencies or {}
        dev_dependencies = dev_dependencies or {}
    
        if pyproject_content or source:
            if source:
                project_dir.parent.mkdir(parents=True, exist_ok=True)
                shutil.copytree(source, project_dir)
            else:
                project_dir.mkdir(parents=True, exist_ok=True)
    
            if pyproject_content:
                with (project_dir / "pyproject.toml").open("w", encoding="utf-8") as f:
                    f.write(pyproject_content)
        else:
            assert name is not None
            layout("src")(
                name,
                "0.1.0",
                author="PyTest Tester <mc.testy@testface.com>",
                readme_format="md",
                python=default_python,
                dependencies=dependencies,
                dev_dependencies=dev_dependencies,
            ).create(project_dir, with_tests=False)
    
        if poetry_lock_content:
            lock_file = project_dir / "poetry.lock"
            lock_file.write_text(data=poetry_lock_content, encoding="utf-8")
    
        poetry = Factory().create_poetry(project_dir)
    
        if use_test_locker:
            locker = TestLocker(
>               poetry.locker.lock, locker_config or poetry.locker._pyproject_data
            )
E           AttributeError: 'NoneType' object has no attribute 'lock'

/workspace/tests/conftest.py:515: AttributeError
_____________ test_isolated_builder_outside_poetry_project_context _____________
[gw2] linux -- Python 3.10.18 /opt/venv/bin/python

tmp_working_directory = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw2/test_isolated_builder_outside_0')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bd60740e830>

    def test_isolated_builder_outside_poetry_project_context(
        tmp_working_directory: Path, fixture_dir: FixtureDirGetter
    ) -> None:
        source = tmp_working_directory / "source"
        shutil.copytree(fixture_dir("project_with_setup"), source)
        destination = tmp_working_directory / "dist"
    
        try:
>           with isolated_builder(source, "wheel") as builder:

/workspace/tests/utils/test_isolated_build.py:127: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x7bd607371360>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x7bd607ba5a50>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpjil8rcv2/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
______________ test_solver_chooses_from_supplemental_if_explicit _______________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e2855d7f70>
name = 'pastel'
version = Version(epoch=0, release=Release(major=0, minor=1, patch=0, extra=(), precision=3, text='0.1.0', _compare_key=(0, 1)),...(0, 1)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('pastel', '0.1.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

package = Package('root', '1.0')
io = <cleo.io.null_io.NullIO object at 0x74e2853538e0>
legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e2855d7f70>
pypi_repository = <poetry.repositories.pypi_repository.PyPiRepository object at 0x74e2840deb00>

    def test_solver_chooses_from_supplemental_if_explicit(
        package: ProjectPackage,
        io: NullIO,
        legacy_repository: LegacyRepository,
        pypi_repository: PyPiRepository,
    ) -> None:
        package.python_versions = "^3.7"
        package.add_dependency(
            Factory.create_dependency("clikit", {"version": "^0.2.0", "source": "PyPI"})
        )
    
        pool = RepositoryPool()
        pool.add_repository(pypi_repository, priority=Priority.SUPPLEMENTAL)
        pool.add_repository(legacy_repository)
    
        solver = Solver(package, pool, [], [], io)
    
>       transaction = solver.solve()

/workspace/tests/puzzle/test_solver.py:3414: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/solver.py:87: in solve
    packages = self._solve()
/workspace/src/poetry/puzzle/solver.py:170: in _solve
    result = resolve_version(self._package, self._provider)
/workspace/src/poetry/mixology/__init__.py:18: in resolve_version
    return solver.solve()
/workspace/src/poetry/mixology/version_solver.py:192: in solve
    next = self._choose_package_version()
/workspace/src/poetry/mixology/version_solver.py:599: in _choose_package_version
    package = self._provider.complete_package(package)
/workspace/src/poetry/puzzle/provider.py:476: in complete_package
    self.get_package_from_pool(
/workspace/src/poetry/repositories/repository_pool.py:162: in package
    return repo.package(name, version)
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x74e285607c10>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x74e284e97f70>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855d5270>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/simple/clikit/", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': 'application/vnd.pypi.simple.v1+json', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855d6350>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855d47f0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/pypi/clikit/0.2.4/json", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855d7d60>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285604e50>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pylev/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285605090>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285605810>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/simple/pylev/", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': 'application/vnd.pypi.simple.v1+json', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285605660>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285606ef0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pylev/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285606290>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285604610>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/pypi/pylev/1.3.0/json", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285605c00>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2856070d0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pastel/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285606c20>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285607430>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285606200>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpdr4wt_rw/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2856071f0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2863d4970>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpba2vndhd/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2840ca6e0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2840ca5f0>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpi8gbhje9/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
___________ test_run_installs_with_local_setuptools_directory[True] ____________
[gw10] linux -- Python 3.10.18 /opt/venv/bin/python

installer = <poetry.installation.installer.Installer object at 0x7bed4aa60bb0>
locker = <tests.installation.test_installer.Locker object at 0x7bed4ababfd0>
repo = <poetry.repositories.repository.Repository object at 0x7bed4abaaad0>
package = Package('root', '1.0')
tmp_path = PosixPath('/tmp/pytest-of-root/pytest-0/popen-gw10/test_run_installs_with_local_s1')
fixture_dir = <function fixture_dir.<locals>._fixture_dir at 0x7bed4b061870>

    def test_run_installs_with_local_setuptools_directory(
        installer: Installer,
        locker: Locker,
        repo: Repository,
        package: ProjectPackage,
        tmp_path: Path,
        fixture_dir: FixtureDirGetter,
    ) -> None:
        root_dir = tmp_path / "root"
        package.root_dir = root_dir
        locker.set_lock_path(root_dir)
        file_path = shutil.copytree(fixture_dir("project_with_setup"), root_dir / "project")
        package.add_dependency(
            Factory.create_dependency(
                "project-with-setup",
                {"path": str(file_path.relative_to(root_dir))},
                root_dir=root_dir,
            )
        )
    
        repo.add_package(get_package("pendulum", "1.4.4"))
        repo.add_package(get_package("cachy", "0.2.0"))
    
>       result = installer.run()

/workspace/tests/installation/test_installer.py:1806: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:241: in _do_install
    solved_packages = solver.solve(
/workspace/src/poetry/puzzle/solver.py:87: in solve
    packages = self._solve()
/workspace/src/poetry/puzzle/solver.py:170: in _solve
    result = resolve_version(self._package, self._provider)
/workspace/src/poetry/mixology/__init__.py:18: in resolve_version
    return solver.solve()
/workspace/src/poetry/mixology/version_solver.py:192: in solve
    next = self._choose_package_version()
/workspace/src/poetry/mixology/version_solver.py:599: in _choose_package_version
    package = self._provider.complete_package(package)
/workspace/src/poetry/puzzle/provider.py:577: in complete_package
    self.search_for_direct_origin_dependency(dep)
/workspace/src/poetry/puzzle/provider.py:253: in search_for_direct_origin_dependency
    package = self._search_for_directory(dependency)
/workspace/src/poetry/puzzle/provider.py:357: in _search_for_directory
    package = self._direct_origin.get_package_from_directory(dependency.full_path)
/workspace/src/poetry/packages/direct_origin.py:80: in get_package_from_directory
    return PackageInfo.from_directory(path=directory).to_package(root_dir=directory)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x7bed4ac49120>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x7bed4aa608b0>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpbm9eu6m2/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
________ test_solver_ignores_explicit_repo_for_transitive_dependencies _________
[gw9] linux -- Python 3.10.18 /opt/venv/bin/python

self = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e285342350>
name = 'pastel'
version = Version(epoch=0, release=Release(major=0, minor=1, patch=0, extra=(), precision=3, text='0.1.0', _compare_key=(0, 1)),...(0, 1)), ReleaseTag(phase='z', number=0), ReleaseTag(phase='', number=0), ReleaseTag(phase='z', number=0), ((0, ''),)))

    def package(self, name: str, version: Version) -> Package:
        """
        Retrieve the release information.
    
        This is a heavy task which takes time.
        We have to download a package to get the dependencies.
        We also need to download every file matching this release
        to get the various hashes.
    
        Note that this will be cached so the subsequent operations
        should be much faster.
        """
        try:
>           index = self._packages.index(Package(name, version))
E           ValueError: Package('pastel', '0.1.0') is not in list

/workspace/src/poetry/repositories/legacy_repository.py:62: ValueError

During handling of the above exception, another exception occurred:

package = Package('root', '1.0')
io = <cleo.io.null_io.NullIO object at 0x74e285341ea0>
legacy_repository = <poetry.repositories.legacy_repository.LegacyRepository object at 0x74e285342350>
pypi_repository = <poetry.repositories.pypi_repository.PyPiRepository object at 0x74e284f047c0>

    def test_solver_ignores_explicit_repo_for_transitive_dependencies(
        package: ProjectPackage,
        io: NullIO,
        legacy_repository: LegacyRepository,
        pypi_repository: PyPiRepository,
    ) -> None:
        # clikit depends on pylev, which is in pypi_repository (explicit) but not in
        # legacy_repository
        package.python_versions = "^3.7"
        package.add_dependency(
            Factory.create_dependency("clikit", {"version": "^0.2.0", "source": "PyPI"})
        )
    
        pool = RepositoryPool()
        pool.add_repository(pypi_repository, priority=Priority.EXPLICIT)
        pool.add_repository(legacy_repository)
    
        solver = Solver(package, pool, [], [], io)
    
        with pytest.raises(SolverProblemError):
>           solver.solve()

/workspace/tests/puzzle/test_solver.py:3510: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/workspace/src/poetry/puzzle/solver.py:87: in solve
    packages = self._solve()
/workspace/src/poetry/puzzle/solver.py:170: in _solve
    result = resolve_version(self._package, self._provider)
/workspace/src/poetry/mixology/__init__.py:18: in resolve_version
    return solver.solve()
/workspace/src/poetry/mixology/version_solver.py:192: in solve
    next = self._choose_package_version()
/workspace/src/poetry/mixology/version_solver.py:599: in _choose_package_version
    package = self._provider.complete_package(package)
/workspace/src/poetry/puzzle/provider.py:476: in complete_package
    self.get_package_from_pool(
/workspace/src/poetry/repositories/repository_pool.py:162: in package
    return repo.package(name, version)
/workspace/src/poetry/repositories/legacy_repository.py:66: in package
    package = super().package(name, version)
/workspace/src/poetry/repositories/cached_repository.py:70: in package
    return self.get_release_info(canonicalize_name(name), version).to_package(
/workspace/src/poetry/repositories/cached_repository.py:50: in get_release_info
    return PackageInfo.load(self._get_release_info(name, version))
/workspace/src/poetry/repositories/legacy_repository.py:119: in _get_release_info
    return self._links_to_data(
/workspace/src/poetry/repositories/http_repository.py:367: in _links_to_data
    info = self._get_info_from_links(links, ignore_yanked=not data.yanked)
/workspace/src/poetry/repositories/http_repository.py:332: in _get_info_from_links
    return self._get_info_from_metadata(sdists[0]) or self._get_info_from_sdist(
/workspace/src/poetry/repositories/http_repository.py:167: in _get_info_from_sdist
    return PackageInfo.from_sdist(filepath)
/workspace/src/poetry/inspection/info.py:479: in from_sdist
    return cls._from_sdist_file(path=path)
/workspace/src/poetry/inspection/info.py:335: in _from_sdist_file
    new_info = cls.from_directory(path=sdist_dir)
/workspace/src/poetry/inspection/info.py:459: in from_directory
    info = get_pep517_metadata(path)
/workspace/src/poetry/inspection/info.py:540: in get_pep517_metadata
    with isolated_builder(path, "wheel") as builder:
/usr/local/lib/python3.10/contextlib.py:135: in __enter__
    return next(self.gen)
/workspace/src/poetry/utils/isolated_build.py:199: in isolated_builder
    env.install(builder.build_system_requires)
/workspace/src/poetry/utils/isolated_build.py:152: in install
    if installer.run() != 0:
/workspace/src/poetry/installation/installer.py:103: in run
    return self._do_install()
/workspace/src/poetry/installation/installer.py:230: in _do_install
    solver = Solver(
/workspace/src/poetry/puzzle/solver.py:62: in __init__
    self._provider = Provider(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <poetry.puzzle.provider.Provider object at 0x74e2853d0b50>
package = Package('__root__', '0.0.0'), pool = None
io = <cleo.io.buffered_io.BufferedIO object at 0x74e285589e70>

    def __init__(
        self,
        package: Package,
        pool: RepositoryPool,
        io: IO,
        *,
        locked: list[Package] | None = None,
        active_root_extras: Collection[NormalizedName] | None = None,
    ) -> None:
        self._package = package
        self._pool = pool
>       self._direct_origin = DirectOrigin(self._pool.artifact_cache)
E       AttributeError: 'NoneType' object has no attribute 'artifact_cache'

/workspace/src/poetry/puzzle/provider.py:126: AttributeError
------------------------------ Captured log call -------------------------------
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284e67820>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/simple/clikit/", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': 'application/vnd.pypi.simple.v1+json', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284e65f30>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284e65e40>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://pypi.org/pypi/clikit/0.2.4/json", headers={'Host': 'pypi.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e284e66440>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285589d80>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pylev/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e28558af80>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855883a0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://legacy.foo.bar/pastel/", headers={'Host': 'legacy.foo.bar', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'gzip, deflate, zstd', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e28558ace0>: 'super' object has no attribute 'flush'
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285588ac0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e285589660>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp2_3jg31r/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e28558ba00>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2855897e0>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmpjcjvx3ao/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
DEBUG    httpretty.core:core.py:588 setsockopt(6, 1, 1) failed
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e2853d3fa0>: 'super' object has no attribute 'flush'
INFO     httpretty.core:core.py:1626 captured: <HTTPrettyRequest("GET", "https://files.pythonhosted.org/packages/bd/13/a68f2e448b471e8c49e9b596d569ae167a5135ac672b1dc5f24f62f9c15f/pastel-0.1.0.tar.gz", headers={'Host': 'files.pythonhosted.org', 'User-Agent': 'poetry/1.8.2 CPython/3.10.18 Linux/6.6.87.2-microsoft-standard-WSL2', 'Accept-Encoding': 'Identity', 'Accept': '*/*', 'Connection': 'keep-alive'}, body=0)>
DEBUG    httpretty.core:core.py:458 error closing file <httpretty.core.FakeSockFile object at 0x74e28558b0d0>: 'super' object has no attribute 'flush'
INFO     virtualenv.discovery.builtin:builtin.py:78 find interpreter for spec PythonSpec(path=/usr/local/bin/python3.10)
INFO     virtualenv.discovery.builtin:builtin.py:85 proposed PythonInfo(spec=CPython3.10.18.final.0-64, exe=/usr/local/bin/python3.10, platform=linux, version='3.10.18 (main, Sep 30 2025, 00:42:07) [GCC 14.2.0]', encoding_fs_io=utf-8-utf-8)
WARNING  virtualenv.seed.embed.base_embed:base_embed.py:38 The --no-wheel and --wheel options are deprecated. They have no effect for Python > 3.8 as wheel is no longer bundled in virtualenv.
INFO     virtualenv.run.session:session.py:52 create virtual environment via CPython3Posix(dest=/tmp/tmp7ixc5x19/.venv, clear=False, no_vcs_ignore=False, global=False)
INFO     virtualenv.run.session:session.py:65 add activators for Bash, CShell, Fish, Nushell, PowerShell, Python
=========================== short test summary info ============================
SKIPPED [3] tests/console/commands/env/test_activate.py:53: Only Windows shells
SKIPPED [1] tests/console/commands/test_sync.py:26: Only relevant for `poetry install`
SKIPPED [1] tests/console/commands/test_run.py:159: Poetry only installs CMD script files for console scripts of editable dependencies on Windows
SKIPPED [1] tests/installation/test_executor.py:414: https://github.com/python-poetry/poetry/issues/7983
SKIPPED [1] tests/console/commands/self/test_sync.py:26: Only relevant for `poetry self install`
SKIPPED [1] tests/utils/env/test_env_manager.py:1265: requires darwin
SKIPPED [1] tests/utils/test_python_manager.py:104: Windows only
ERROR tests/console/commands/test_add.py::test_add_multiple_dependencies_to_dependency_group
ERROR tests/console/commands/test_config.py::test_set_malformed_repositories_setting
ERROR tests/console/commands/test_lock.py::test_lock_always_updates_path_dependencies[True]
ERROR tests/console/commands/test_remove.py::test_remove_does_not_keep_empty_groups[True]
ERROR tests/console/commands/test_add.py::test_add_should_skip_when_adding_existing_package_with_no_constraint[True]
ERROR tests/console/commands/test_check.py::test_check_valid - AttributeError...
ERROR tests/console/commands/test_add.py::test_add_to_group_uses_existing_legacy_group
ERROR tests/console/commands/test_lock.py::test_lock_always_updates_path_dependencies[False]
ERROR tests/console/commands/test_config.py::test_display_undefined_setting[repositories.foo-There is no foo repository defined]
ERROR tests/console/commands/test_add.py::test_add_should_skip_when_adding_existing_package_with_no_constraint[False]
ERROR tests/console/commands/test_remove.py::test_remove_does_not_keep_empty_groups[False]
ERROR tests/console/commands/test_check.py::test_check_valid_legacy[args0-0]
ERROR tests/console/commands/python/test_python_install.py::test_install_failure
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options0-valid_groups0-False]
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_does_not_exist[missing_directory_dependency-True]
ERROR tests/console/commands/test_config.py::test_display_undefined_setting[foo-There is no foo setting.]
ERROR tests/console/commands/source/test_show.py::test_source_show_pypi - Att...
ERROR tests/console/commands/source/test_add.py::test_source_add_simple - Att...
ERROR tests/console/commands/test_add.py::test_add_group_directory_constraint_mix_pep735[required_fixtures0]
ERROR tests/console/commands/test_remove.py::test_remove_canonicalized_named_removes_dependency_correctly[True]
ERROR tests/console/commands/test_add.py::test_add_should_skip_when_adding_canonicalized_existing_package_with_no_constraint[True]
ERROR tests/console/commands/test_check.py::test_check_valid_legacy[args1-1]
ERROR tests/console/commands/test_new.py::test_command_new_with_readme[rst]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[PyTest-expected5-installer.only-binary]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---with bam-groups6]
ERROR tests/console/commands/python/test_python_install.py::test_install_corrupt[False]
ERROR tests/console/commands/source/test_show.py::test_source_show_pypi_and_other
ERROR tests/console/commands/source/test_add.py::test_source_add_simple_without_existing_sources
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options1-valid_groups1-True]
ERROR tests/console/commands/test_build.py::test_build_creates_packages_in_dist_directory_if_no_output_is_specified[sdist]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[pytest,black-expected6-installer.no-binary]
ERROR tests/console/commands/source/test_add.py::test_source_add_supplemental
ERROR tests/console/commands/source/test_show.py::test_source_show_no_sources
ERROR tests/console/commands/python/test_python_install.py::test_install_corrupt[True]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[pytest,black-expected6-installer.only-binary]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options2-valid_groups2-True]
ERROR tests/console/commands/test_config.py::test_list_displays_set_get_local_setting
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---without foo,bar-groups7]
ERROR tests/console/commands/test_build.py::test_build_creates_packages_in_dist_directory_if_no_output_is_specified[wheel]
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_does_not_exist[missing_directory_dependency-False]
ERROR tests/console/commands/test_new.py::test_command_new_with_readme[adoc]
ERROR tests/console/commands/test_check.py::test_check_invalid_dep_name_same_as_project_name
ERROR tests/console/commands/test_add.py::test_add_should_skip_when_adding_canonicalized_existing_package_with_no_constraint[False]
ERROR tests/console/commands/test_add.py::test_add_directory_with_poetry[required_fixtures0]
ERROR tests/console/commands/test_remove.py::test_remove_canonicalized_named_removes_dependency_correctly[False]
ERROR tests/console/commands/test_config.py::test_list_must_not_display_sources_from_pyproject_toml
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_does_not_exist[missing_file_dependency-True]
ERROR tests/console/commands/test_new.py::test_command_new_with_readme[creole]
ERROR tests/console/commands/test_check.py::test_check_invalid - AttributeErr...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---without main-groups8]
ERROR tests/console/commands/test_add.py::test_add_should_fail_circular_dependency
ERROR tests/console/commands/test_remove.py::test_remove_package_does_not_exist
ERROR tests/console/commands/test_add.py::test_add_file_constraint_wheel[required_fixtures0]
ERROR tests/console/commands/test_config.py::test_set_http_basic - AttributeE...
ERROR tests/console/commands/test_build.py::test_build_creates_packages_in_dist_directory_if_no_output_is_specified[all]
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_does_not_exist[missing_file_dependency-False]
ERROR tests/console/commands/test_check.py::test_check_private - AttributeErr...
ERROR tests/console/commands/test_remove.py::test_remove_package_no_dependencies
ERROR tests/console/commands/test_config.py::test_unset_http_basic - Attribut...
ERROR tests/console/commands/test_add.py::test_add_latest_should_strip_out_invalid_pep508_path
ERROR tests/console/commands/test_add.py::test_add_file_constraint_sdist[required_fixtures0]
ERROR tests/console/commands/source/test_add.py::test_source_add_explicit - A...
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_deleted_from_pyproject[deleted_directory_dependency-True]
ERROR tests/console/commands/source/test_show.py::test_source_show_no_sources_implicit_pypi
ERROR tests/console/commands/test_check.py::test_check_non_package_mode - Att...
ERROR tests/console/commands/python/test_python_install.py::test_install_success
ERROR tests/console/commands/test_add.py::test_add_latest_should_not_create_duplicate_keys[True]
ERROR tests/console/commands/test_remove.py::test_remove_command_should_not_write_changes_upon_installer_errors
ERROR tests/console/commands/test_run.py::test_run_script_sys_argv0[not installed]
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_deleted_from_pyproject[deleted_directory_dependency-False]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_extras_option[msgpack]
ERROR tests/console/commands/test_config.py::test_set_http_basic_unsuccessful_multiple_values
ERROR tests/console/commands/test_check.py::test_check_lock_missing[-All set!\n-0]
ERROR tests/console/commands/test_add.py::test_add_latest_should_not_create_duplicate_keys[False]
ERROR tests/console/commands/python/test_python_install.py::test_install_reinstall
ERROR tests/console/commands/source/test_add.py::test_source_add_error_no_url
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_deleted_from_pyproject[deleted_file_dependency-True]
ERROR tests/console/commands/test_run.py::test_run_script_sys_argv0[installed]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_extras_option[MsgPack]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options3-valid_groups3-True]
ERROR tests/console/commands/test_remove.py::test_remove_with_dry_run_keep_files_intact[up_to_date_lock]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only time --format json-expected15]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[-expected7-installer.no-binary]
ERROR tests/console/commands/test_check.py::test_check_lock_missing[--lock-Error: poetry.lock was not found.\n-1]
ERROR tests/console/commands/test_config.py::test_set_pypi_token - AttributeE...
ERROR tests/console/commands/source/test_show.py::test_source_show_error - At...
ERROR tests/console/commands/test_add.py::test_add_should_work_when_adding_existing_package_with_latest_constraint[True]
ERROR tests/console/commands/test_show.py::test_show_outdated_formatting[--format json]
ERROR tests/console/commands/test_lock.py::test_lock_path_dependency_deleted_from_pyproject[deleted_file_dependency-False]
ERROR tests/console/commands/test_add.py::test_add_url_constraint_wheel - Att...
ERROR tests/console/commands/test_remove.py::test_remove_with_dry_run_keep_files_intact[up_to_date_lock_non_package]
ERROR tests/console/commands/python/test_python_install.py::test_install_passes_options_to_installer[cpython-False]
ERROR tests/console/commands/source/test_add.py::test_source_add_error_pypi
ERROR tests/console/commands/test_check.py::test_check_lock_outdated[] - Attr...
ERROR tests/console/commands/test_config.py::test_unset_pypi_token - Attribut...
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only time --with test-pendulum 2.0.0 Pendulum package\n]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True--groups0]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[-expected7-installer.only-binary]
ERROR tests/console/commands/test_add.py::test_add_url_constraint_wheel_with_extras[foo]
ERROR tests/console/commands/test_add.py::test_add_should_work_when_adding_existing_package_with_latest_constraint[False]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options4-valid_groups4-True]
ERROR tests/console/commands/test_show.py::test_show_outdated_local_dependencies[-project_with_local_dependencies-required_fixtures0]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---with foo,bar --without baz --without bim --only bam-groups9]
ERROR tests/console/commands/test_lock.py::test_lock_with_incompatible_lockfile[True]
ERROR tests/console/commands/test_remove.py::test_remove_performs_uninstall_op[up_to_date_lock]
ERROR tests/console/commands/python/test_python_install.py::test_install_passes_options_to_installer[cpython-True]
ERROR tests/console/commands/test_check.py::test_check_lock_outdated[--lock]
ERROR tests/console/commands/source/test_add.py::test_source_add_pypi[pypi]
ERROR tests/console/commands/test_config.py::test_set_pypi_token_unsuccessful_multiple_values
ERROR tests/console/commands/test_config.py::test_config_solver_lazy_wheel - ...
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options5-valid_groups5-True]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---only-root-groups1]
ERROR tests/console/commands/test_add.py::test_add_chooses_prerelease_if_only_prereleases_are_available
ERROR tests/console/commands/test_add.py::test_add_url_constraint_wheel_with_extras[FOO]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---all-groups-groups10]
ERROR tests/console/commands/test_add.py::test_add_no_constraint - AttributeE...
ERROR tests/console/commands/test_new.py::test_respect_use_poetry_python_on_new[False-1.1]
ERROR tests/console/commands/test_remove.py::test_remove_performs_uninstall_op[up_to_date_lock_non_package]
ERROR tests/console/commands/python/test_python_install.py::test_install_passes_options_to_installer[pypy-False]
ERROR tests/console/commands/source/test_add.py::test_source_add_pypi[PyPI]
ERROR tests/console/commands/test_build.py::test_build_with_local_version_label
ERROR tests/console/commands/test_config.py::test_config_migrate[yes-system-git-client = true\n\n[virtualenvs]\nuse-poetry-python = true\n]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options6-valid_groups6-True]
ERROR tests/console/commands/cache/test_list.py::test_cache_list - AttributeE...
ERROR tests/console/commands/test_search.py::test_search - AttributeError: 'N...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---with foo-groups11]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---only main-groups2]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options7-valid_groups7-True]
ERROR tests/console/commands/test_search.py::test_search_empty_results - Attr...
ERROR tests/console/commands/python/test_python_install.py::test_install_passes_options_to_installer[pypy-True]
ERROR tests/console/commands/source/test_add.py::test_source_add_pypi_explicit
ERROR tests/console/commands/cache/test_list.py::test_cache_list_empty - Attr...
ERROR tests/console/commands/test_config.py::test_config_migrate[no-[experimental]\nsystem-git-client = true\n\n[virtualenvs]\nprefer-active-python = false\n]
ERROR tests/console/commands/test_add.py::test_add_local_version - AttributeE...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---without bam-groups12]
ERROR tests/console/commands/test_search.py::test_search_with_legacy_repository
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---only foo-groups3]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options8-valid_groups8-False]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only time --with test --format json-expected17]
ERROR tests/console/commands/test_new.py::test_respect_use_poetry_python_on_new[True-3.10]
ERROR tests/console/commands/source/test_add.py::test_source_add_existing_no_change_except_case_of_name[lower]
ERROR tests/console/commands/test_lock.py::test_lock_with_incompatible_lockfile[False]
ERROR tests/console/commands/test_search.py::test_search_only_legacy_repository
ERROR tests/console/commands/test_config.py::test_config_migrate_local_config
ERROR tests/console/commands/test_show.py::test_show_outdated_local_dependencies[--format json-project_with_local_dependencies-required_fixtures0]
ERROR tests/console/commands/test_lock.py::test_lock_with_invalid_lockfile[True]
ERROR tests/console/commands/test_lock.py::test_lock_with_invalid_lockfile[False]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\npytest   3.7.3 Pytest package\n1]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --format json-expected19]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_with_constraint
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[None-expected_extras0-True]
ERROR tests/console/commands/test_new.py::test_command_new[options0-package-package-package-None]
ERROR tests/console/commands/source/test_add.py::test_source_add_existing_no_change_except_case_of_name[upper]
ERROR tests/console/commands/test_add.py::test_add_prefers_stable_releases - ...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---with bam --without bam-groups13]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---with foo --without foo-groups14]
ERROR tests/console/commands/test_add.py::test_add_non_package_mode_no_name
ERROR tests/console/commands/test_add.py::test_add_with_lock - AttributeError...
ERROR tests/console/commands/test_remove.py::test_remove_with_lock_does_not_perform_uninstall_op[up_to_date_lock]
ERROR tests/console/commands/test_search.py::test_search_multiple_queries - A...
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages[]
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages[--format json]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---only foo,bar-groups4]
ERROR tests/console/commands/test_show.py::test_show_outdated_git_dev_dependency[-project_with_git_dev_dependency]
ERROR tests/console/commands/test_show.py::test_show_outdated_git_dev_dependency[--format json-project_with_git_dev_dependency]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---only bam-groups5]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[None-expected_extras0-False]
ERROR tests/console/commands/test_new.py::test_basic_interactive_new - Attrib...
ERROR tests/console/commands/test_check.py::test_check_lock_up_to_date[] - At...
ERROR tests/console/commands/test_config.py::test_config_migrate_local_config_should_raise_if_not_found
ERROR tests/console/commands/test_config.py::test_set_pypi_token_no_values - ...
ERROR tests/console/commands/test_config.py::test_config_installer_build_config_settings
ERROR tests/console/commands/python/test_python_list.py::test_list_no_versions
ERROR tests/console/commands/test_check.py::test_check_lock_up_to_date[--lock]
ERROR tests/console/commands/test_config.py::test_set_client_cert - Attribute...
ERROR tests/console/commands/test_new.py::test_command_new[options1-package-package-src/package-src]
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages_single[]
ERROR tests/console/commands/test_check.py::test_check_does_not_error_on_pypi_reference
ERROR tests/console/commands/test_config.py::test_show_config_with_local_config_file_empty
ERROR tests/console/commands/debug/test_resolve.py::test_debug_resolve_gives_resolution_results
ERROR tests/console/commands/python/test_python_list.py::test_list_all - Attr...
ERROR tests/console/commands/test_config.py::test_set_client_cert_unsuccessful_multiple_values
ERROR tests/console/commands/test_remove.py::test_remove_with_lock_does_not_perform_uninstall_op[up_to_date_lock_non_package]
ERROR tests/console/commands/test_build.py::test_build_with_clean[True] - Att...
ERROR tests/console/commands/test_config.py::test_list_displays_default_value_if_not_set
ERROR tests/console/commands/test_add.py::test_add_keyboard_interrupt_restore_content
ERROR tests/console/commands/test_new.py::test_command_new[options2-namespace-package-namespace-package-namespace/package-None]
ERROR tests/console/commands/test_show.py::test_show_outdated_no_dev_git_dev_dependency[-project_with_git_dev_dependency]
ERROR tests/console/commands/test_build.py::test_build_with_clean[False] - At...
ERROR tests/console/commands/self/test_add_plugins.py::test_add_with_git_constraint
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages_single[--format json]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras1-expected_extras1-True]
ERROR tests/console/commands/test_add.py::test_add_replace_by_constraint - At...
ERROR tests/console/commands/test_config.py::test_list_displays_set_get_setting
ERROR tests/console/commands/debug/test_resolve.py::test_debug_resolve_tree_option_gives_the_dependency_tree
ERROR tests/console/commands/test_new.py::test_command_new[options3-namespace-package-namespace-package-src/namespace/package-src]
ERROR tests/console/commands/test_run.py::test_run_passes_all_args - Attribut...
ERROR tests/console/commands/test_config.py::test_set_cert[path/to/ca.pem-path/to/ca.pem]
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages_single_canonicalized[]
ERROR tests/console/commands/test_add.py::test_add_with_dry_run_keep_files_intact[cachy --dry-run]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras1-expected_extras1-False]
ERROR tests/console/commands/test_install.py::test_invalid_groups_with_without_only[options9-valid_groups9-False]
ERROR tests/console/commands/test_config.py::test_cannot_set_with_multiple_values
ERROR tests/console/commands/test_add.py::test_add_no_constraint_editable_error
ERROR tests/console/commands/self/test_add_plugins.py::test_add_with_git_constraint_with_extras
ERROR tests/console/commands/test_config.py::test_set_cert[true-True] - Attri...
ERROR tests/console/commands/test_run.py::test_run_is_not_eager - AttributeEr...
ERROR tests/console/commands/test_new.py::test_new_creates_structure_in_empty_existing_directory
ERROR tests/console/commands/debug/test_resolve.py::test_debug_resolve_git_dependency
ERROR tests/console/commands/source/test_add.py::test_source_add_existing_updating[lower]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[-cachy  0.1.0 Cachy package\npytest 3.7.3 Pytest package\n]
ERROR tests/console/commands/test_show.py::test_show_basic_with_installed_packages_single_canonicalized[--format json]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras2-expected_extras2-True]
ERROR tests/console/commands/test_install.py::test_dry_run_populates_installer
ERROR tests/console/commands/test_show.py::test_show_outdated_no_dev_git_dev_dependency[--format json-project_with_git_dev_dependency]
ERROR tests/console/commands/test_add.py::test_add_equal_constraint - Attribu...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---with bam-groups6]
ERROR tests/console/commands/test_install.py::test_sync_option_is_passed_to_the_installer[True]
ERROR tests/console/commands/test_build.py::test_build_with_clean_non_existing_output
ERROR tests/console/commands/test_config.py::test_set_cert[false-False] - Att...
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command
ERROR tests/console/commands/source/test_add.py::test_source_add_existing_updating[upper]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras2-expected_extras2-False]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--format json-expected1]
ERROR tests/console/commands/test_show.py::test_show_basic_with_not_installed_packages_non_decorated[]
ERROR tests/console/commands/test_install.py::test_dry_run_does_not_build - A...
ERROR tests/console/commands/test_config.py::test_config_installer_build_config_settings_bad_values[BAD=VALUE]
ERROR tests/console/commands/test_install.py::test_sync_option_is_passed_to_the_installer[False]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---without foo,bar-groups7]
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[-vP run run]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras3-expected_extras3-True]
ERROR tests/console/commands/test_config.py::test_unset_cert - AttributeError...
ERROR tests/console/commands/source/test_remove.py::test_source_remove_simple[lower]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\npytest   3.7.3 Pytest package\n0]
ERROR tests/console/commands/test_install.py::test_install_logs_output - Attr...
ERROR tests/console/commands/test_new.py::test_command_new[options4-namespace-package_a-namespace-package-a-namespace/package_a-None]
ERROR tests/console/commands/env/test_activate.py::test_no_additional_output_in_verbose_mode[]
ERROR tests/console/commands/test_config.py::test_config_installer_build_config_settings_bad_values[BAD]
ERROR tests/console/commands/test_install.py::test_compile_option_is_passed_to_the_installer[False]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---without main-groups8]
ERROR tests/console/commands/test_new.py::test_new_with_dot_in_empty_directory
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[run -vP run]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --format json-expected3]
ERROR tests/console/commands/test_add.py::test_add_with_dry_run_keep_files_intact[cachy --lock --dry-run]
ERROR tests/console/commands/test_new.py::test_command_new[options5-namespace-package_a-namespace-package-a-src/namespace/package_a-src]
ERROR tests/console/commands/test_config.py::test_cannot_set_invalid_value - ...
ERROR tests/console/commands/test_install.py::test_install_logs_output_decorated
ERROR tests/console/commands/source/test_remove.py::test_source_remove_simple[upper]
ERROR tests/console/commands/test_show.py::test_show_hides_incompatible_package[]
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[bash-source-]
ERROR tests/console/commands/python/test_python_list.py::test_list_invalid_version
ERROR tests/console/commands/test_install.py::test_compile_option_is_passed_to_the_installer[True]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--without test-cachy 0.1.0 Cachy package\n]
ERROR tests/console/commands/test_new.py::test_command_new[options6-namespace-package-namespace-package-namespace_package-None]
ERROR tests/console/commands/test_config.py::test_cannot_unset_with_value - A...
ERROR tests/console/commands/test_config.py::test_config_installer_build_config_settings_bad_values[{"key": ["str", 0]}]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_with_git_constraint_with_subdirectory[git+https://github.com/demo/poetry-plugin2.git#subdirectory=subdir-None]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---with foo,bar --without baz --without bim --only bam-groups9]
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[module-True]
ERROR tests/console/commands/test_add.py::test_add_should_not_change_lock_file_when_dependency_installation_fail
ERROR tests/console/commands/test_build.py::test_build_not_possible_in_non_package_mode
ERROR tests/console/commands/source/test_remove.py::test_source_remove_pypi[pypi]
ERROR tests/console/commands/test_install.py::test_no_directory_is_passed_to_installer[True]
ERROR tests/console/commands/python/test_python_list.py::test_list - Attribut...
ERROR tests/console/commands/test_add.py::test_add_greater_constraint - Attri...
ERROR tests/console/commands/test_new.py::test_command_new[options7-namespace-package-namespace-package-src/namespace_package-src]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--without test --format json-expected5]
ERROR tests/console/commands/test_config.py::test_unset_setting - AttributeEr...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---all-groups-groups10]
ERROR tests/console/commands/test_add.py::test_add_with_path_dependency_no_loopiness
ERROR tests/console/commands/test_config.py::test_command_config_build_config_settings_get
ERROR tests/console/commands/test_publish.py::test_publish_not_possible_in_non_package_mode
ERROR tests/console/commands/env/test_activate.py::test_no_additional_output_in_verbose_mode[-v]
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[zsh-source-]
ERROR tests/console/commands/source/test_remove.py::test_source_remove_pypi[PyPI]
ERROR tests/console/commands/test_show.py::test_show_basic_with_not_installed_packages_non_decorated[--format json]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--without main-pytest 3.7.3 Pytest package\n]
ERROR tests/console/commands/test_new.py::test_command_new[options8-package-namespace-package-namespace/package-None]
ERROR tests/console/commands/test_install.py::test_no_directory_is_passed_to_installer[False]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_extras[msgpack]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_with_git_constraint_with_subdirectory[git+https://github.com/demo/poetry-plugin2.git@master#subdirectory=subdir-master]
ERROR tests/console/commands/test_config.py::test_unset_repo_setting - Attrib...
ERROR tests/console/commands/test_show.py::test_show_hides_incompatible_package[--format json]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional[existing_extras3-expected_extras3-False]
ERROR tests/console/commands/test_add.py::test_add_extras_are_parsed_and_included
ERROR tests/console/commands/test_config.py::test_config_installer_parallel
ERROR tests/console/commands/test_show.py::test_show_basic_with_not_installed_packages_decorated
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---with foo-groups11]
ERROR tests/console/commands/test_new.py::test_command_new[options9-package-namespace-package-src/namespace/package-src]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--without main --format json-expected7]
ERROR tests/console/commands/test_config.py::test_unset_value_not_exists - At...
ERROR tests/console/commands/test_add.py::test_add_constraint_with_extras[MsgPack]
ERROR tests/console/commands/source/test_remove.py::test_source_remove_pypi_and_other[pypi]
ERROR tests/console/commands/test_add.py::test_add_extras_only_accepts_one_package[requests --extras security socks]
ERROR tests/console/commands/env/test_activate.py::test_no_additional_output_in_verbose_mode[-vv]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_optional_not_main_group
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[-vPrun run]
ERROR tests/console/commands/test_new.py::test_command_new[options10-package-namespace-package-namespace/package-None]
ERROR tests/console/commands/test_show.py::test_show_latest_non_decorated[]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[true-expected0-installer.no-binary]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_existing_plugin_warns_about_no_operation
ERROR tests/console/commands/test_config.py::test_display_single_setting[virtualenvs.create-true\n]
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[fish-source-.fish]
ERROR tests/console/commands/python/test_python_list.py::test_list_poetry_managed[False]
ERROR tests/console/commands/test_add.py::test_add_constraint_dependencies - ...
ERROR tests/console/commands/test_new.py::test_command_new[options11-package-namespace-package-src/namespace/package-src]
ERROR tests/console/commands/test_publish.py::test_publish_returns_non_zero_code_for_upload_errors
ERROR tests/console/commands/test_add.py::test_add_does_not_update_locked_dependencies[True-4.3.1-foo]
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[run -vPrun ]
ERROR tests/console/commands/test_config.py::test_display_single_setting[repositories.foo.url-{'url': 'https://bar.com/simple/'}\n]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_python - A...
ERROR tests/console/commands/test_show.py::test_show_latest_non_decorated[--format json]
ERROR tests/console/commands/test_add.py::test_add_with_markers - AttributeEr...
ERROR tests/console/commands/test_init.py::test_noninteractive - AttributeErr...
ERROR tests/console/commands/python/test_python_list.py::test_list_poetry_managed[True]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[true-expected0-installer.only-binary]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_existing_plugin_updates_if_requested
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[module-False]
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[-v --project=run run]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_platform
ERROR tests/console/commands/test_show.py::test_show_latest_decorated - Attri...
ERROR tests/console/commands/env/test_activate.py::test_no_additional_output_in_verbose_mode[-vvv]
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[nu-overlay use-.nu]
ERROR tests/console/commands/python/test_python_list.py::test_list_version[3-3]
ERROR tests/console/commands/test_install.py::test_no_all_extras_doesnt_populate_installer
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[-v run --project=run]
ERROR tests/console/commands/test_add.py::test_add_git_constraint - Attribute...
ERROR tests/console/commands/test_publish.py::test_publish_returns_non_zero_code_for_connection_errors
ERROR tests/console/commands/test_add.py::test_add_constraint_with_source - A...
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[1-expected1-installer.no-binary]
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[readme-True]
ERROR tests/console/commands/test_show.py::test_show_outdated[] - AttributeEr...
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only main-cachy 0.1.0 Cachy package\n]
ERROR tests/console/commands/test_add.py::test_add_git_constraint_with_poetry
ERROR tests/console/commands/self/test_add_plugins.py::test_adding_a_plugin_can_update_poetry_dependencies_if_needed
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[-v --directory=run run]
ERROR tests/console/commands/test_add.py::test_add_constraint_with_source_that_does_not_exist
ERROR tests/console/commands/test_install.py::test_all_extras_populates_installer
ERROR tests/console/commands/test_show.py::test_show_outdated[--format json]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---without bam-groups12]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[1-expected1-installer.only-binary]
ERROR tests/console/commands/python/test_python_list.py::test_list_version[3.9-2]
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[readme-False]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only main --format json-expected9]
ERROR tests/console/commands/test_run.py::test_run_passes_args_after_run_before_command_name_conflict[run -v --directory=run]
ERROR tests/console/commands/test_build.py::test_build_with_multiple_readme_files
ERROR tests/console/commands/test_add.py::test_add_constraint_not_found_with_source
ERROR tests/console/commands/source/test_remove.py::test_source_remove_pypi_and_other[PyPI]
ERROR tests/console/commands/test_new.py::test_command_new[options12-namespace_package-namespace-package-namespace_package-None]
ERROR tests/console/commands/test_show.py::test_show_all_shows_incompatible_package[]
ERROR tests/console/commands/test_install.py::test_extras_are_parsed_and_populate_installer
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[-True]
ERROR tests/console/commands/test_run.py::test_run_keeps_options_passed_before_command_args_combined_short_opts
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[false-expected2-installer.no-binary]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---with bam --without bam-groups13]
ERROR tests/console/commands/python/test_python_list.py::test_list_version[3.9.2-0]
ERROR tests/console/commands/test_new.py::test_command_new[options13-namespace_package-namespace-package-src/namespace_package-src]
ERROR tests/console/commands/source/test_remove.py::test_source_remove_error[foo]
ERROR tests/console/commands/test_add.py::test_add_does_not_update_locked_dependencies[True-4.3.1-foo --lock]
ERROR tests/console/commands/env/test_info.py::test_env_info_displays_complete_info
ERROR tests/console/commands/test_add.py::test_add_to_section_that_does_not_exist_yet[dev]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --without test-cachy    0.1.0 Cachy package\npendulum 2.0.0 Pendulum package\n]
ERROR tests/console/commands/test_config.py::test_display_single_local_setting
ERROR tests/console/commands/test_install.py::test_install_ensures_project_plugins[--no-plugins-0]
ERROR tests/console/commands/test_install.py::test_install_warning_corrupt_root[-False]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[false-expected2-installer.only-binary]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --without test --format json-expected11]
ERROR tests/console/commands/self/test_install.py::test_self_install[None] - ...
ERROR tests/console/commands/test_run.py::test_run_keeps_options_passed_before_command_args
ERROR tests/console/commands/test_config.py::test_display_empty_repositories_setting
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[True---with foo --without foo-groups14]
ERROR tests/console/commands/test_new.py::test_command_new_with_readme[None]
ERROR tests/console/commands/test_add.py::test_add_does_not_update_locked_dependencies[False-4.3.2-foo]
ERROR tests/console/commands/env/test_info.py::test_env_info_displays_path_only
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[csh-source-.csh]
ERROR tests/console/commands/test_install.py::test_install_path_dependency_does_not_exist[missing_directory_dependency-]
ERROR tests/console/commands/source/test_remove.py::test_source_remove_error[pypi]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --without main,test-pendulum 2.0.0 Pendulum package\n]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[0-expected3-installer.no-binary]
ERROR tests/console/commands/test_build.py::test_build_output_option[None] - ...
ERROR tests/console/commands/test_new.py::test_command_new_with_readme[md] - ...
ERROR tests/console/commands/test_config.py::test_unset_nonempty_repositories_section[repositories-You cannot remove the [repositories] section]
ERROR tests/console/commands/test_install.py::test_install_ensures_project_plugins[-1]
ERROR tests/console/commands/test_show.py::test_show_all_shows_incompatible_package[--format json]
ERROR tests/console/commands/source/test_remove.py::test_source_remove_error[PyPI]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False--groups0]
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--with time --without main,test --format json-expected13]
ERROR tests/console/commands/test_add.py::test_add_git_constraint_with_extras[foo]
ERROR tests/console/commands/env/test_info.py::test_env_info_displays_executable_only
ERROR tests/console/commands/test_add.py::test_add_does_not_update_locked_dependencies[False-4.3.2-foo --lock]
ERROR tests/console/commands/test_config.py::test_unset_nonempty_repositories_section[repositories.test-There is no test repository defined]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options1-valid_groups1-True]
ERROR tests/console/commands/test_publish.py::test_publish_with_cert - Attrib...
ERROR tests/console/commands/test_show.py::test_show_basic_with_group_options[--only time-pendulum 2.0.0 Pendulum package\n]
ERROR tests/console/commands/env/test_list.py::test_none_activated - Attribut...
ERROR tests/console/commands/test_show.py::test_show_outdated_with_only_up_to_date_packages[]
ERROR tests/console/commands/test_add.py::test_add_git_constraint_with_extras[FOO]
ERROR tests/console/commands/self/test_install.py::test_self_install[[tool.poetry]\nname = "poetry-instance"\nversion = "1.2"\ndescription = ""\nauthors = []\nlicense = ""\n# no package-mode -> defaults to true\n\n[tool.poetry.dependencies]\npython = "3.9"\npoetry = "1.2"\n]
ERROR tests/console/commands/source/test_show.py::test_source_show_simple - A...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---only-root-groups1]
ERROR tests/console/commands/test_install.py::test_extras_conflicts_all_extras
ERROR tests/console/commands/test_add.py::test_add_creates_dependencies_array_if_necessary
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---with bam --without bam-groups13]
ERROR tests/console/commands/test_publish.py::test_publish_with_client_cert
ERROR tests/console/commands/test_add.py::test_add_to_section_that_does_not_exist_yet[foo.BAR]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options2-valid_groups2-True]
ERROR tests/console/commands/test_show.py::test_show_outdated_with_only_up_to_date_packages[--format json]
ERROR tests/console/commands/env/test_list.py::test_activated - AttributeErro...
ERROR tests/console/commands/test_add.py::test_add_git_constraint_with_subdirectory[git+https://github.com/demo/subdirectories.git#subdirectory=two-None]
ERROR tests/console/commands/test_add.py::test_add_does_not_add_poetry_dependencies_if_not_necessary[True]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---only main-groups2]
ERROR tests/console/commands/source/test_show.py::test_source_show_one[lower]
ERROR tests/console/commands/env/test_activate.py::test_env_activate_prints_correct_script[tcsh-source-.csh]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---with foo --without foo-groups14]
ERROR tests/console/commands/test_publish.py::test_publish_dry_run_skip_existing[--dry-run]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options3-valid_groups3-True]
ERROR tests/console/commands/test_add.py::test_add_creating_poetry_section_does_not_remove_existing_tools
ERROR tests/console/commands/test_run.py::test_run_keeps_options_passed_before_command
ERROR tests/console/commands/env/test_list.py::test_in_project_venv - Attribu...
ERROR tests/console/commands/test_show.py::test_show_outdated_has_prerelease_but_not_allowed[]
ERROR tests/console/commands/test_add.py::test_add_git_constraint_with_subdirectory[git+https://github.com/demo/subdirectories.git@master#subdirectory=two-master]
ERROR tests/console/commands/test_install.py::test_install_path_dependency_does_not_exist[missing_directory_dependency---without dev]
ERROR tests/console/commands/test_show.py::test_show_hides_incompatible_package_with_duplicate[]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---only bam-groups5]
ERROR tests/console/commands/test_sync.py::test_compile_option_is_passed_to_the_installer[False]
ERROR tests/console/commands/source/test_show.py::test_source_show_one[upper]
ERROR tests/console/commands/test_publish.py::test_publish_dry_run_skip_existing[--skip-existing]
ERROR tests/console/commands/test_add.py::test_add_to_dev_group - AttributeEr...
ERROR tests/console/commands/test_show.py::test_show_outdated_has_prerelease_but_not_allowed[--format json]
ERROR tests/console/commands/test_run.py::test_run_has_helpful_error_when_command_not_found
ERROR tests/console/commands/env/test_list.py::test_in_project_venv_no_explicit_config
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[0-expected3-installer.only-binary]
ERROR tests/console/commands/test_install.py::test_install_path_dependency_does_not_exist[missing_file_dependency-]
ERROR tests/console/commands/test_add.py::test_add_git_ssh_constraint[False]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---with bam-groups6]
ERROR tests/console/commands/test_add.py::test_add_should_not_select_prereleases
ERROR tests/console/commands/source/test_show.py::test_source_show_two[lower]
ERROR tests/console/commands/test_publish.py::test_publish_dry_run_skip_existing[--dry-run --skip-existing]
ERROR tests/console/commands/test_show.py::test_show_outdated_has_prerelease_and_allowed[]
ERROR tests/console/commands/python/test_python_list.py::test_list_version[3.9.3-1]
ERROR tests/console/commands/env/test_list.py::test_in_project_venv_is_false
ERROR tests/console/commands/test_run.py::test_run_script_exit_code - Attribu...
ERROR tests/console/commands/test_show.py::test_show_hides_incompatible_package_with_duplicate[--format json]
ERROR tests/console/commands/test_add.py::test_add_git_ssh_constraint[True]
ERROR tests/console/commands/test_install.py::test_install_path_dependency_does_not_exist[missing_file_dependency---without dev]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---without foo,bar-groups7]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[pytest-expected4-installer.no-binary]
ERROR tests/console/commands/test_publish.py::test_skip_existing_output - Att...
ERROR tests/console/commands/test_show.py::test_show_outdated_has_prerelease_and_allowed[--format json]
ERROR tests/console/commands/python/test_python_list.py::test_list_implementation[PyPy-1]
ERROR tests/console/commands/test_install.py::test_install_extra_path_dependency_does_not_exist[]
ERROR tests/console/commands/test_add.py::test_add_does_not_add_poetry_dependencies_if_not_necessary[False]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---without main-groups8]
ERROR tests/console/commands/test_show.py::test_show_outdated_formatting[] - ...
ERROR tests/console/commands/python/test_python_list.py::test_list_implementation[pypy-1]
ERROR tests/console/commands/self/test_install.py::test_sync_deprecation[True]
ERROR tests/console/commands/test_build.py::test_build_output_option[dist] - ...
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[pytest-expected4-installer.only-binary]
ERROR tests/console/commands/test_add.py::test_add_directory_constraint[False-required_fixtures0]
ERROR tests/console/commands/test_install.py::test_install_extra_path_dependency_does_not_exist[--extras notinstallable]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---only foo-groups3]
ERROR tests/console/commands/test_add.py::test_add_poetry_dependencies_if_necessary[True]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options4-valid_groups4-True]
ERROR tests/console/commands/test_sync.py::test_compile_option_is_passed_to_the_installer[True]
ERROR tests/console/commands/test_show.py::test_show_all_shows_all_duplicates[]
ERROR tests/console/commands/test_config.py::test_config_installer_binary_filter_config[PyTest-expected5-installer.no-binary]
ERROR tests/console/commands/test_install.py::test_install_missing_directory_dependency_with_no_directory[]
ERROR tests/console/commands/test_add.py::test_add_directory_constraint[True-required_fixtures0]
ERROR tests/console/commands/test_add.py::test_add_poetry_dependencies_if_necessary[False]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options5-valid_groups5-True]
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---only foo,bar-groups4]
ERROR tests/console/commands/env/test_remove.py::test_remove_by_python_version
ERROR tests/console/commands/python/test_python_list.py::test_list_implementation[CPython-2]
ERROR tests/console/commands/test_sync.py::test_no_directory_is_passed_to_installer[True]
ERROR tests/console/commands/test_show.py::test_show_all_shows_all_duplicates[--format json]
ERROR tests/console/commands/test_sync.py::test_install_path_dependency_does_not_exist[missing_file_dependency---without dev]
ERROR tests/console/commands/self/test_install.py::test_sync_deprecation[False]
ERROR tests/console/commands/test_install.py::test_only_root_conflicts_with_without_only_all_groups[--with foo]
ERROR tests/console/commands/test_build.py::test_build_output_option[test/dir]
ERROR tests/console/commands/env/test_remove.py::test_remove_by_name - Attrib...
ERROR tests/console/commands/source/test_show.py::test_source_show_two[upper]
ERROR tests/console/commands/test_build.py::test_build_format_is_not_valid - ...
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options6-valid_groups6-True]
ERROR tests/console/commands/test_show.py::test_show_tree - AttributeError: '...
ERROR tests/console/commands/test_install.py::test_group_options_are_passed_to_the_installer[False---only bam-groups5]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_option[None]
ERROR tests/console/commands/test_sync.py::test_no_directory_is_passed_to_installer[False]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_invalid_version
ERROR tests/console/commands/test_sync.py::test_install_extra_path_dependency_does_not_exist[]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---with foo,bar --without baz --without bim --only bam-groups9]
ERROR tests/console/commands/env/test_remove.py::test_remove_all[None] - Attr...
ERROR tests/console/commands/test_version.py::test_version_show_with_underscore
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options7-valid_groups7-True]
ERROR tests/console/commands/test_show.py::test_show_tree_no_dev - AttributeE...
ERROR tests/console/commands/source/test_show.py::test_source_show_given_priority[source_primary]
ERROR tests/console/commands/test_sync.py::test_install_extra_path_dependency_does_not_exist[--extras notinstallable]
ERROR tests/console/commands/test_sync.py::test_no_all_extras_doesnt_populate_installer
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---all-groups-groups10]
ERROR tests/console/commands/test_show.py::test_show_entire_description_truncate[False]
ERROR tests/console/commands/test_build.py::test_build_output_option[../dist]
ERROR tests/console/commands/test_version.py::test_short_version_show - Attri...
ERROR tests/console/commands/python/test_python_remove.py::test_remove_version_not_precise_enough
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options8-valid_groups8-False]
ERROR tests/console/commands/env/test_remove.py::test_remove_all[empty] - Att...
ERROR tests/console/commands/test_install.py::test_only_root_conflicts_with_without_only_all_groups[--without foo]
ERROR tests/console/commands/self/test_remove_plugins.py::test_remove_installed_package
ERROR tests/console/commands/test_sync.py::test_all_extras_populates_installer
ERROR tests/console/commands/test_version.py::test_version_update - Attribute...
ERROR tests/console/commands/test_install.py::test_install_missing_directory_dependency_with_no_directory[--no-directory]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---with foo-groups11]
ERROR tests/console/commands/source/test_show.py::test_source_show_given_priority[source_supplemental]
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options9-valid_groups9-False]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_version_no_installation
ERROR tests/console/commands/test_sync.py::test_extras_are_parsed_and_populate_installer
ERROR tests/console/commands/env/test_remove.py::test_remove_all[self] - Attr...
ERROR tests/console/commands/test_add.py::test_add_to_new_group_keeps_existing_group
ERROR tests/console/commands/test_install.py::test_only_root_conflicts_with_without_only_all_groups[--with foo,bar --without baz]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---without bam-groups12]
ERROR tests/console/commands/test_install.py::test_non_package_mode_does_not_try_to_install_root
ERROR tests/console/commands/source/test_show.py::test_source_show_given_priority[source_explicit]
ERROR tests/console/commands/test_show.py::test_show_entire_description_truncate[True]
ERROR tests/console/commands/test_add.py::test_add_to_existing_group[False]
ERROR tests/console/commands/test_show.py::test_show_errors_without_lock_file
ERROR tests/console/commands/test_build.py::test_build_output_option[absolute]
ERROR tests/console/commands/env/test_remove.py::test_remove_all[other] - Att...
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---with bam --without bam-groups13]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_version
ERROR tests/console/commands/self/test_remove_plugins.py::test_remove_installed_package_dry_run
ERROR tests/console/commands/test_install.py::test_only_root_conflicts_with_without_only_all_groups[--only foo]
ERROR tests/console/commands/test_lock.py::test_lock_does_not_update_if_not_necessary
ERROR tests/console/commands/test_add.py::test_add_to_existing_group[True] - ...
ERROR tests/console/commands/test_show.py::test_show_tree_why_package - Attri...
ERROR tests/console/commands/env/test_remove.py::test_remove_all[self_and_other]
ERROR tests/console/commands/test_sync.py::test_install_missing_directory_dependency_with_no_directory[]
ERROR tests/console/commands/test_show.py::test_show_dependency_installed_from_git_in_dev[]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---with foo --without foo-groups14]
ERROR tests/console/commands/test_add.py::test_add_to_group_with_latest_overwrite_existing
ERROR tests/console/commands/test_install.py::test_only_root_conflicts_with_without_only_all_groups[--all-groups]
ERROR tests/console/commands/test_show.py::test_show_tree_why - AttributeErro...
ERROR tests/console/commands/test_sync.py::test_install_missing_directory_dependency_with_no_directory[--no-directory]
ERROR tests/console/commands/env/test_remove.py::test_remove_all_and_version
ERROR tests/console/commands/test_version.py::test_short_version_update - Att...
ERROR tests/console/commands/test_show.py::test_show_why[] - AttributeError: ...
ERROR tests/console/commands/test_install.py::test_all_groups_conflicts_with_only_with_without[--with foo]
ERROR tests/console/commands/test_sync.py::test_dry_run_populates_installer
ERROR tests/console/commands/test_version.py::test_version_show - AttributeEr...
ERROR tests/console/commands/test_sync.py::test_non_package_mode_does_not_try_to_install_root
ERROR tests/console/commands/test_sync.py::test_install_ensures_project_plugins[--no-plugins-0]
ERROR tests/console/commands/test_version.py::test_phase_version_update - Att...
ERROR tests/console/commands/test_show.py::test_show_why[--format json] - Att...
ERROR tests/console/commands/test_sync.py::test_dry_run_does_not_build - Attr...
ERROR tests/console/commands/test_sync.py::test_sync_option_not_available - A...
ERROR tests/console/commands/test_version.py::test_dry_run - AttributeError: ...
ERROR tests/console/commands/test_sync.py::test_install_ensures_project_plugins[-1]
ERROR tests/console/commands/test_show.py::test_show_required_by_deps[] - Att...
ERROR tests/console/commands/test_sync.py::test_install_logs_output - Attribu...
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_option[dist]
ERROR tests/console/commands/test_show.py::test_show_required_by_deps[--format json]
ERROR tests/console/commands/test_sync.py::test_synced_installer - AttributeE...
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False--groups0]
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens0-result0]
ERROR tests/console/commands/test_sync.py::test_install_logs_output_decorated
ERROR tests/console/commands/test_sync.py::test_extras_conflicts_all_extras
ERROR tests/console/commands/test_update.py::test_update_with_dry_run_keep_files_intact[--dry-run]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---only-root-groups1]
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens1-result1]
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[module-True]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_version_implementation[cpython]
ERROR tests/console/commands/test_sync.py::test_only_root_conflicts_with_without_only_all_groups[--with foo]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_option[other_dist/dist]
ERROR tests/console/commands/test_install.py::test_all_groups_conflicts_with_only_with_without[--without foo]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---only main-groups2]
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[module-False]
ERROR tests/console/commands/env/test_remove.py::test_remove_multiple - Attri...
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens2-result2]
ERROR tests/console/commands/test_sync.py::test_only_root_conflicts_with_without_only_all_groups[--without foo]
ERROR tests/console/commands/test_install.py::test_all_groups_conflicts_with_only_with_without[--with foo,bar --without baz]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---only foo-groups3]
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens3-result3]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_option[absolute]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_version_implementation[pypy]
ERROR tests/console/commands/test_sync.py::test_only_root_conflicts_with_without_only_all_groups[--with foo,bar --without baz]
ERROR tests/console/commands/env/test_remove.py::test_remove_in_project - Att...
ERROR tests/console/commands/test_show.py::test_show_dependency_installed_from_git_in_dev[--format json]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---only foo,bar-groups4]
ERROR tests/console/commands/test_install.py::test_all_groups_conflicts_with_only_with_without[--only foo]
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens4-result4]
ERROR tests/console/commands/env/test_remove.py::test_remove_in_project_all
ERROR tests/console/commands/test_update.py::test_update_with_dry_run_keep_files_intact[docker --dry-run]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_and_build_options[../dist]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---only bam-groups5]
ERROR tests/console/commands/python/test_python_remove.py::test_remove_multiple_versions
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens5-result5]
ERROR tests/console/commands/env/test_use.py::test_activate_activates_non_existing_virtualenv_no_envs_file
ERROR tests/console/commands/test_update.py::test_update_prints_operations[-True]
ERROR tests/console/test_application.py::test_application_input_configuration_and_sorting[tokens6-result6]
ERROR tests/console/commands/env/test_use.py::test_get_prefers_explicitly_activated_virtualenvs_over_env_var
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[readme-True]
ERROR tests/console/commands/test_update.py::test_update_prints_operations[--dry-run-True]
ERROR tests/console/commands/test_show.py::test_url_dependency_is_not_outdated_by_repository_package[]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_and_build_options[tmp/dist]
ERROR tests/console/commands/test_update.py::test_update_prints_operations[--lock-False]
ERROR tests/console/commands/env/test_use.py::test_get_prefers_explicitly_activated_non_existing_virtualenvs_over_env_var
ERROR tests/console/commands/test_sync.py::test_only_root_conflicts_with_without_only_all_groups[--only foo]
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[readme-False]
ERROR tests/console/commands/self/test_show.py::test_show_format[] - Attribut...
ERROR tests/console/commands/test_update.py::test_update_sync_option_is_passed_to_the_installer
ERROR tests/console/commands/test_sync.py::test_only_root_conflicts_with_without_only_all_groups[--all-groups]
ERROR tests/console/commands/python/test_python_install.py::test_install_invalid_version
ERROR tests/console/commands/test_show.py::test_url_dependency_is_not_outdated_by_repository_package[--format json]
ERROR tests/console/commands/test_publish.py::test_publish_dist_dir_and_build_options[absolute]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---with bam-groups6]
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[-True]
ERROR tests/console/commands/self/test_add_plugins.py::test_add_no_constraint
ERROR tests/console/commands/test_sync.py::test_all_groups_conflicts_with_only_with_without[--with foo]
ERROR tests/console/commands/test_show.py::test_show_top_level[] - AttributeE...
ERROR tests/console/commands/test_remove.py::test_remove_from_project_and_poetry
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---without foo,bar-groups7]
ERROR tests/console/commands/test_sync.py::test_install_warning_corrupt_root[-False]
ERROR tests/console/commands/test_show.py::test_show_top_level[--format json]
ERROR tests/console/commands/test_sync.py::test_all_groups_conflicts_with_only_with_without[--without foo]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---without main-groups8]
ERROR tests/console/commands/test_show.py::test_show_top_level_with_explicitly_defined_dependency[]
ERROR tests/console/commands/test_sync.py::test_all_groups_conflicts_with_only_with_without[--with foo,bar --without baz]
ERROR tests/console/commands/test_sync.py::test_install_path_dependency_does_not_exist[missing_directory_dependency-]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---with foo,bar --without baz --without bim --only bam-groups9]
ERROR tests/console/commands/test_show.py::test_show_top_level_with_explicitly_defined_dependency[--format json]
ERROR tests/console/commands/test_sync.py::test_all_groups_conflicts_with_only_with_without[--only foo]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---all-groups-groups10]
ERROR tests/console/commands/test_sync.py::test_install_path_dependency_does_not_exist[missing_directory_dependency---without dev]
ERROR tests/console/commands/python/test_python_install.py::test_install_free_threaded_not_supported
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---with foo-groups11]
ERROR tests/console/commands/test_remove.py::test_remove_from_pep735_group_and_poetry_group
ERROR tests/console/commands/test_remove.py::test_remove_without_specific_group_removes_from_all_groups[True]
ERROR tests/console/commands/self/test_show.py::test_show_format[--format json]
ERROR tests/console/commands/python/test_python_install.py::test_install_exists
ERROR tests/console/commands/test_remove.py::test_remove_without_specific_group_removes_from_all_groups[False]
ERROR tests/console/commands/test_show.py::test_show_top_level_with_extras[]
ERROR tests/console/commands/python/test_python_install.py::test_install_no_download
ERROR tests/console/commands/test_sync.py::test_invalid_groups_with_without_only[options0-valid_groups0-False]
ERROR tests/console/commands/test_remove.py::test_remove_with_specific_group_removes_from_specific_groups[True]
ERROR tests/console/commands/test_show.py::test_show_top_level_with_extras[--format json]
ERROR tests/console/commands/test_remove.py::test_remove_with_specific_group_removes_from_specific_groups[False]
ERROR tests/console/commands/self/test_show.py::test_show_format[--format text]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[False---without bam-groups12]
ERROR tests/console/commands/test_sync.py::test_install_path_dependency_does_not_exist[missing_file_dependency-]
ERROR tests/console/commands/test_show.py::test_show_error_top_level_with_tree
ERROR tests/console/commands/test_show.py::test_show_error_top_level_with_single_package
ERROR tests/console/commands/test_show.py::test_show_outdated_missing_directory_dependency[deleted_directory_dependency-required_fixtures0]
ERROR tests/console/commands/test_show.py::test_show_error_invalid_output_format
ERROR tests/console/commands/self/test_show_plugins.py::test_show_displays_installed_plugins[entry_point_values_by_group0-poetry-plugin]
ERROR tests/console/commands/test_show.py::test_show_error_invalid_output_format_with_tree_option
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True--groups0]
ERROR tests/console/commands/self/test_show_plugins.py::test_show_displays_installed_plugins[entry_point_values_by_group0-not-package-name]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---only-root-groups1]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---only main-groups2]
ERROR tests/console/commands/self/test_show_plugins.py::test_show_displays_installed_plugins_with_multiple_plugins[entry_point_values_by_group0]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---only foo-groups3]
ERROR tests/console/commands/test_sync.py::test_group_options_are_passed_to_the_installer[True---only foo,bar-groups4]
ERROR tests/console/commands/self/test_show_plugins.py::test_show_displays_installed_plugins_with_dependencies[entry_point_values_by_group0-plugin_package_requires_dist0]
ERROR tests/console/commands/self/test_sync.py::test_self_install[None] - Att...
ERROR tests/console/commands/self/test_sync.py::test_self_install[[tool.poetry]\nname = "poetry-instance"\nversion = "1.2"\ndescription = ""\nauthors = []\nlicense = ""\n# no package-mode -> defaults to true\n\n[tool.poetry.dependencies]\npython = "3.9"\npoetry = "1.2"\n]
ERROR tests/console/commands/self/test_sync.py::test_sync_option_not_available
ERROR tests/publishing/test_uploader.py::test_uploader_skips_existing[400-file name has already been taken]
ERROR tests/publishing/test_uploader.py::test_uploader_skip_existing_bubbles_unskippable_errors
ERROR tests/console/commands/self/test_sync.py::test_synced_installer - Attri...
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_file_not_existing
ERROR tests/console/commands/self/test_update.py::test_self_update_can_update_from_recommended_installation
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[307-Temporary Redirect]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[304-Not Modified]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[303-See Other]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[302-Found]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_400_errors
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[301-Moved Permanently]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_403_errors
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_nonstandard_errors
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[308-Permanent Redirect]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_redirects[300-Multiple Choices]
ERROR tests/publishing/test_uploader.py::test_uploader_properly_handles_301_redirects
ERROR tests/publishing/test_uploader.py::test_uploader_registers_for_appropriate_400_errors
ERROR tests/publishing/test_uploader.py::test_uploader_skips_existing[409-]
ERROR tests/publishing/test_uploader.py::test_uploader_skips_existing[400-File already exists]
ERROR tests/publishing/test_uploader.py::test_uploader_skips_existing[400-Repository does not allow updating assets]
ERROR tests/publishing/test_uploader.py::test_uploader_skips_existing[403-Not enough permissions to overwrite artifact]
ERROR tests/repositories/test_installed_repository.py::test_system_site_packages[False]
ERROR tests/repositories/test_installed_repository.py::test_system_site_packages[True]
ERROR tests/repositories/test_installed_repository.py::test_system_site_packages_source_type
ERROR tests/repositories/test_installed_repository.py::test_pipx_shared_lib_site_packages
ERROR tests/utils/env/test_env.py::test_env_system_packages_are_relative_to_lib[True]
ERROR tests/utils/env/test_env.py::test_env_system_packages_are_relative_to_lib[False]
ERROR tests/utils/env/test_env.py::test_env_no_pip[flags2-packages2] - Attrib...
ERROR tests/utils/env/test_env.py::test_env_no_pip[flags0-packages0] - Attrib...
ERROR tests/utils/env/test_env.py::test_env_system_packages[True] - Attribute...
ERROR tests/utils/env/test_env.py::test_env_no_pip[flags1-packages1] - Attrib...
ERROR tests/utils/env/test_env.py::test_marker_env_is_equal_for_all_envs - At...
ERROR tests/utils/env/test_env.py::test_build_environment_not_called_without_build_script_specified
ERROR tests/utils/env/test_env_manager.py::test_activate_activates_different_virtualenv_with_envs_file
ERROR tests/utils/env/test_env.py::test_env_system_packages[False] - Attribut...
ERROR tests/utils/env/test_env.py::test_command_from_bin_preserves_relative_path
ERROR tests/utils/env/test_env_manager.py::test_deactivate_non_activated_but_existing
ERROR tests/utils/env/test_env.py::test_generic_env_system_packages - Attribu...
ERROR tests/utils/env/test_env_manager.py::test_activate_in_project_venv_no_explicit_config
ERROR tests/utils/env/test_env_manager.py::test_activate_activates_recreates_for_different_patch
ERROR tests/utils/env/test_env_manager.py::test_remove_by_name - AttributeErr...
ERROR tests/utils/env/test_env_manager.py::test_create_venv_tries_to_find_a_compatible_python_executable_using_generic_ones_first
ERROR tests/utils/env/test_env_manager.py::test_get_venv_with_venv_folder_present[None]
ERROR tests/utils/env/test_env_manager.py::test_remove_raises_if_acting_on_different_project_by_name
ERROR tests/utils/env/test_env_manager.py::test_remove_by_string_with_python_and_version
ERROR tests/utils/env/test_env_manager.py::test_activate_does_not_recreate_when_switching_minor
ERROR tests/utils/env/test_env.py::test_env_finds_the_correct_executables - A...
ERROR tests/utils/env/test_env_manager.py::test_create_venv_finds_no_python_executable
ERROR tests/utils/env/test_env_manager.py::test_build_venv_does_not_change_loglevel
ERROR tests/utils/env/test_env_manager.py::test_remove_by_full_path_to_python
ERROR tests/utils/env/test_env_manager.py::test_activate_with_in_project_setting_does_not_fail_if_no_venvs_dir
ERROR tests/utils/env/test_env_manager.py::test_get_prefers_explicitly_activated_virtualenvs_over_env_var
ERROR tests/utils/env/test_env_manager.py::test_raises_when_passing_old_env_after_dir_rename
ERROR tests/utils/env/test_env.py::test_env_finds_the_correct_executables_for_generic_env
ERROR tests/utils/env/test_env_manager.py::test_activate_activates_non_existing_virtualenv_no_envs_file
ERROR tests/utils/env/test_env_manager.py::test_remove_raises_if_acting_on_different_project_by_full_path
ERROR tests/utils/env/test_env_manager.py::test_create_venv_tries_to_find_a_compatible_python_executable_using_specific_ones
ERROR tests/utils/env/test_env.py::test_env_finds_fallback_executables_for_generic_env
ERROR tests/utils/env/test_env_manager.py::test_generate_env_name_ignores_case_for_case_insensitive_fs
ERROR tests/utils/env/test_env_manager.py::test_remove_also_deactivates - Att...
ERROR tests/utils/env/test_env_manager.py::test_deactivate_activated - Attrib...
ERROR tests/utils/env/test_env_manager.py::test_list - AttributeError: 'NoneT...
ERROR tests/utils/env/test_env_manager.py::test_activate_fails_when_python_cannot_be_found
ERROR tests/utils/env/test_env_manager.py::test_create_venv_does_not_try_to_find_compatible_versions_with_executable
ERROR tests/utils/env/test_env_manager.py::test_get_venv_with_venv_folder_present[True]
ERROR tests/utils/env/test_env_manager.py::test_create_venv_uses_patch_version_to_detect_compatibility
ERROR tests/utils/env/test_env_manager.py::test_activate_activates_existing_virtualenv_no_envs_file
ERROR tests/utils/env/test_env_manager.py::test_create_venv_accepts_fallback_version_w_nonzero_patchlevel
ERROR tests/utils/env/test_env_manager.py::test_remove_keeps_dir_if_not_deleteable
ERROR tests/utils/env/test_env_manager.py::test_remove_by_python_version - At...
ERROR tests/utils/env/test_env_manager.py::test_create_venv_uses_patch_version_to_detect_compatibility_with_executable
ERROR tests/utils/env/test_env_manager.py::test_activate_activates_same_virtualenv_with_envs_file
ERROR tests/utils/env/test_env_manager.py::test_get_venv_with_venv_folder_present[False]
ERROR tests/utils/env/test_env_manager.py::test_create_venv_does_not_keep_inconsistent_envs_entry[False]
ERROR tests/utils/env/test_env_manager.py::test_create_venv_fails_if_current_python_version_is_not_supported
ERROR tests/utils/env/test_env_manager.py::test_create_venv_fails_if_no_compatible_python_version_could_be_found
ERROR tests/utils/env/test_env.py::test_virtualenvs_with_spaces_in_their_path_work_as_expected
ERROR tests/utils/env/test_env.py::test_env_commands_with_spaces_in_their_arg_work_as_expected
ERROR tests/utils/env/test_env.py::test_env_get_supported_tags_matches_inside_virtualenv[True]
ERROR tests/utils/env/test_env_manager.py::test_create_venv_does_not_keep_inconsistent_envs_entry[True]
ERROR tests/utils/env/test_env.py::test_env_get_supported_tags_matches_inside_virtualenv[False]
FAILED tests/console/commands/test_build.py::test_build_handler_build_isolated
FAILED tests/console/commands/test_init.py::test_interactive_with_directory_dependency_and_other_name
FAILED tests/console/commands/test_init.py::test_interactive_with_file_dependency
FAILED tests/console/commands/test_init.py::test_interactive_with_wrong_dependency_inputs
FAILED tests/console/commands/test_init.py::test_predefined_dependency - Attr...
FAILED tests/console/commands/test_init.py::test_predefined_and_interactive_dependencies
FAILED tests/console/commands/test_init.py::test_predefined_dev_dependency - ...
FAILED tests/console/commands/test_init.py::test_predefined_and_interactive_dev_dependencies
FAILED tests/console/commands/test_init.py::test_predefined_all_options - Att...
FAILED tests/console/commands/test_init.py::test_add_package_with_extras_and_whitespace
FAILED tests/console/commands/test_init.py::test_init_non_interactive_existing_pyproject_add_dependency
FAILED tests/console/commands/test_init.py::test_interactive_with_dependencies
FAILED tests/console/commands/test_init.py::test_interactive_with_dependencies_and_no_selection
FAILED tests/console/commands/test_init.py::test_interactive_with_git_dependencies
FAILED tests/console/test_application.py::test_application_verify_source_cache_flag[True]
FAILED tests/console/test_application.py::test_application_verify_source_cache_flag[False]
FAILED tests/console/commands/test_init.py::test_interactive_with_git_dependencies_with_reference
FAILED tests/console/test_application.py::test_application_verify_cache_flag_at_install[True]
FAILED tests/console/test_application.py::test_application_verify_cache_flag_at_install[False]
FAILED tests/console/commands/test_build.py::test_build_relative_directory_src_layout
FAILED tests/console/commands/test_init.py::test_interactive_with_git_dependencies_and_other_name
FAILED tests/console/commands/test_init.py::test_interactive_with_directory_dependency
FAILED tests/inspection/test_info.py::test_info_setup_simple - AttributeError...
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[core_in_range-False]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[core_not_in_range-True]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[has_build_script-True]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[multiple_build_deps-True]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[no_core-True]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[core_from_git-True]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[no_build_system-False]
FAILED tests/console/commands/test_build.py::test_requires_isolated_build[no_build_backend-False]
FAILED tests/inspection/test_info.py::test_info_setup_complex - AttributeErro...
FAILED tests/inspection/test_info.py::test_info_setup_complex_pep517_legacy
FAILED tests/inspection/test_info.py::test_info_setup_complex_calls_script - ...
FAILED tests/inspection/test_info.py::test_info_from_sdist_no_pkg_info - Attr...
FAILED tests/inspection/test_info.py::test_info_setup_missing_mandatory_should_trigger_pep517[version]
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_generates_proper_metadata_when_multiple_readme_files
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_should_execute_build_scripts
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_catches_bad_scripts_no_colon
FAILED tests/inspection/test_info.py::test_info_setup_missing_mandatory_should_trigger_pep517[name]
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_catches_bad_scripts_too_many_colon
FAILED tests/publishing/test_publisher.py::test_publish_can_publish_to_given_repository[sample_project]
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_installs_proper_files_for_standard_packages[simple_project]
FAILED tests/publishing/test_publisher.py::test_publish_can_publish_to_given_repository[with_source]
FAILED tests/publishing/test_publisher.py::test_publish_raises_error_for_undefined_repository
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_installs_proper_files_for_standard_packages[simple_project_legacy]
FAILED tests/publishing/test_publisher.py::test_publish_uses_token_if_it_exists
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_install_missing_plugins
FAILED tests/publishing/test_publisher.py::test_publish_uses_env_token_if_it_exists
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_install_only_missing_plugins
FAILED tests/publishing/test_publisher.py::test_publish_uses_cert - Attribute...
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_install_overwrite_wrong_version_plugins[False]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_install_overwrite_wrong_version_plugins[True]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_pins_other_installed_packages
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_falls_back_on_setup_and_pip_for_packages_with_build_scripts
FAILED tests/masonry/builders/test_editable_builder.py::test_builder_installs_proper_files_when_packages_configured
FAILED tests/plugins/test_plugin_manager.py::test_project_plugins_are_installed_in_project_folder[False]
FAILED tests/publishing/test_publisher.py::test_publish_uses_client_cert - At...
FAILED tests/publishing/test_publisher.py::test_publish_read_from_environment_variable
FAILED tests/plugins/test_plugin_manager.py::test_project_plugins_are_installed_in_project_folder[True]
FAILED tests/publishing/test_publisher.py::test_publish_publishes_to_pypi_by_default
FAILED tests/puzzle/test_provider.py::test_search_for_directory_setup_with_base[non-canonical-name]
FAILED tests/plugins/test_plugin_manager.py::test_load_plugins_and_activate
FAILED tests/puzzle/test_solver.py::test_solver_can_resolve_directory_dependencies_nested_editable
FAILED tests/plugins/test_plugin_manager.py::test_add_project_plugin_path - A...
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_no_plugins_no_output
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_no_plugins_existing_cache_is_removed
FAILED tests/puzzle/test_provider.py::test_search_for_directory_setup_read_setup_with_no_dependencies
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_no_output_if_fresh[False]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_no_output_if_fresh[True]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_ignore_irrelevant_markers[False]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_ignore_irrelevant_markers[True]
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_remove_outdated
FAILED tests/plugins/test_plugin_manager.py::test_ensure_plugins_ignore_already_installed_in_system_env
FAILED tests/puzzle/test_provider.py::test_search_for_directory_setup_egg_info[non-canonical-name]
FAILED tests/test_factory.py::test_create_poetry_with_packages_and_includes
FAILED tests/test_factory.py::test_poetry_with_primary_source[with_primary_source_implicit]
FAILED tests/test_factory.py::test_create_poetry_with_multi_constraints_dependency
FAILED tests/test_factory.py::test_create_poetry_with_local_config - Attribut...
FAILED tests/test_factory.py::test_create_poetry_with_plugins - AttributeErro...
FAILED tests/test_factory.py::test_create_poetry_non_package_mode - Attribute...
FAILED tests/test_factory.py::test_poetry_with_primary_source[with_primary_source_explicit]
FAILED tests/test_factory.py::test_poetry_with_pypi_explicit_only[with_explicit_pypi_and_other_explicit]
FAILED tests/test_factory.py::test_poetry_with_no_default_source - AttributeE...
FAILED tests/test_factory.py::test_create_poetry - AttributeError: 'Poetry' o...
FAILED tests/repositories/test_legacy_repository.py::test_get_package_information_fallback_read_setup
FAILED tests/test_factory.py::test_poetry_with_multiple_supplemental_sources
FAILED tests/test_factory.py::test_poetry_with_supplemental_source - Attribut...
FAILED tests/test_factory.py::test_create_pyproject_from_package[simple_project_legacy]
FAILED tests/test_factory.py::test_poetry_with_explicit_source - AttributeErr...
FAILED tests/test_factory.py::test_poetry_with_multiple_sources - AttributeEr...
FAILED tests/test_factory.py::test_poetry_with_explicit_pypi_and_other - Attr...
FAILED tests/test_factory.py::test_create_pyproject_from_package[project_with_extras]
FAILED tests/test_factory.py::test_poetry_with_multiple_sources_pypi - Attrib...
FAILED tests/test_factory.py::test_poetry_with_pypi_explicit_only[with_explicit_pypi_no_other]
FAILED tests/test_factory.py::test_create_poetry_version_not_ok - Failed: DID...
FAILED tests/repositories/test_legacy_repository.py::test_get_package_retrieves_packages_with_no_hashes
FAILED tests/repositories/test_legacy_repository.py::test_package_partial_yank
FAILED tests/puzzle/test_solver.py::test_solver_does_not_choose_from_supplemental_repository_by_default
FAILED tests/utils/env/test_env.py::test_build_environment_called_build_script_specified
FAILED tests/test_factory.py::test_create_poetry_fails_on_invalid_configuration
FAILED tests/test_factory.py::test_create_poetry_fails_on_nameless_project - ...
FAILED tests/utils/env/test_env_manager.py::test_create_venv_project_name_empty_sets_correct_prompt
FAILED tests/installation/test_installer.py::test_run_installs_with_local_setuptools_directory[False]
FAILED tests/utils/test_python_manager.py::test_python_find_compatible - Attr...
FAILED tests/utils/test_isolated_build.py::test_isolated_builder_outside_poetry_project_context
FAILED tests/puzzle/test_solver.py::test_solver_chooses_from_supplemental_if_explicit
FAILED tests/installation/test_installer.py::test_run_installs_with_local_setuptools_directory[True]
FAILED tests/puzzle/test_solver.py::test_solver_ignores_explicit_repo_for_transitive_dependencies
109 failed, 1823 passed, 9 skipped, 744 errors in 27.04s
